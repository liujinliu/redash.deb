webpackJsonp([0,2],[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function i(){(0,O.each)(I,function(e){e(X)})}function s(){(0,O.each)(Q,function(e){e(X)})}function o(){(0,O.each)(T,function(e){var t=e(X);X.config(["$routeProvider",function(e){(0,O.each)(t,function(t,n){J("Route: ",n),t.template="<app-header></app-header><route-status></route-status>"+t.template+"<footer></footer>",t.authenticated=!0,e.when(n,t)})}])})}function l(){(0,O.each)(U,function(e,t){X.filter(t,function(){return e})})}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n(1),n(6),n(13),n(14),n(15),n(16),n(17),n(18);var c=n(19),d=a(c),p=n(22),f=a(p),g=n(24),h=a(g),m=n(26),v=a(m),b=n(28),y=a(b),w=n(30),_=a(w),x=n(32),q=a(x),$=n(34),A=a($),k=n(36),z=a(k),P=n(38),S=a(P),C=n(40),j=a(C);n(41),n(149),n(152),n(153);var M=n(154),E=a(M),O=n(155);n(156),n(165),n(182),n(183);var R=n(184),T=r(R),D=n(278),I=r(D),N=n(315),U=r(N),V=n(317),Q=r(V),F=n(339),L=a(F),B=n(340),G=a(B),Y=n(625),H=a(Y),W=n(627),Z=a(W),J=(0,d.default)("redash"),K=[v.default,y.default,h.default,_.default,A.default,q.default,"angularMoment",z.default,"ui.ace",S.default,"angularResizable",j.default,"ui.sortable",E.default.name],X=f.default.module("app",K);(0,L.default)(X),s(),l(),(0,H.default)(X),(0,Z.default)(X),i(),o(),(0,G.default)(X),X.config(["$routeProvider","$locationProvider","$compileProvider","uiSelectConfig","toastrConfig",function(e,t,n,r,a){n.aHrefSanitizationWhitelist(/^\s*(https?|http|data):/),t.html5Mode(!0),r.theme="bootstrap",u(a,{positionClass:"toast-bottom-right",timeOut:2e3})}]),X.run(["$templateCache","OfflineListener",function(e,t){var n="bootstrap/match.tpl.html",r=e.get(n);r=r.replace("glyphicon glyphicon-remove","fa fa-remove"),e.put(n,r)}]),t.default=X},function(e,t){},,,,,1,,,,,,,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){return n(a(e))}function a(e){return i[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var i={"./af":45,"./af.js":45,"./ar":46,"./ar-ly":47,"./ar-ly.js":47,"./ar-ma":48,"./ar-ma.js":48,"./ar-sa":49,"./ar-sa.js":49,"./ar-tn":50,"./ar-tn.js":50,"./ar.js":46,"./az":51,"./az.js":51,"./be":52,"./be.js":52,"./bg":53,"./bg.js":53,"./bn":54,"./bn.js":54,"./bo":55,"./bo.js":55,"./br":56,"./br.js":56,"./bs":57,"./bs.js":57,"./ca":58,"./ca.js":58,"./cs":59,"./cs.js":59,"./cv":60,"./cv.js":60,"./cy":61,"./cy.js":61,"./da":62,"./da.js":62,"./de":63,"./de-at":64,"./de-at.js":64,"./de.js":63,"./dv":65,"./dv.js":65,"./el":66,"./el.js":66,"./en-au":67,"./en-au.js":67,"./en-ca":68,"./en-ca.js":68,"./en-gb":69,"./en-gb.js":69,"./en-ie":70,"./en-ie.js":70,"./en-nz":71,"./en-nz.js":71,"./eo":72,"./eo.js":72,"./es":73,"./es-do":74,"./es-do.js":74,"./es.js":73,"./et":75,"./et.js":75,"./eu":76,"./eu.js":76,"./fa":77,"./fa.js":77,"./fi":78,"./fi.js":78,"./fo":79,"./fo.js":79,"./fr":80,"./fr-ca":81,"./fr-ca.js":81,"./fr-ch":82,"./fr-ch.js":82,"./fr.js":80,"./fy":83,"./fy.js":83,"./gd":84,"./gd.js":84,"./gl":85,"./gl.js":85,"./he":86,"./he.js":86,"./hi":87,"./hi.js":87,"./hr":88,"./hr.js":88,"./hu":89,"./hu.js":89,"./hy-am":90,"./hy-am.js":90,"./id":91,"./id.js":91,"./is":92,"./is.js":92,"./it":93,"./it.js":93,"./ja":94,"./ja.js":94,"./jv":95,"./jv.js":95,"./ka":96,"./ka.js":96,"./kk":97,"./kk.js":97,"./km":98,"./km.js":98,"./ko":99,"./ko.js":99,"./ky":100,"./ky.js":100,"./lb":101,"./lb.js":101,"./lo":102,"./lo.js":102,"./lt":103,"./lt.js":103,"./lv":104,"./lv.js":104,"./me":105,"./me.js":105,"./mi":106,"./mi.js":106,"./mk":107,"./mk.js":107,"./ml":108,"./ml.js":108,"./mr":109,"./mr.js":109,"./ms":110,"./ms-my":111,"./ms-my.js":111,"./ms.js":110,"./my":112,"./my.js":112,"./nb":113,"./nb.js":113,"./ne":114,"./ne.js":114,"./nl":115,"./nl.js":115,"./nn":116,"./nn.js":116,"./pa-in":117,"./pa-in.js":117,"./pl":118,"./pl.js":118,"./pt":119,"./pt-br":120,"./pt-br.js":120,"./pt.js":119,"./ro":121,"./ro.js":121,"./ru":122,"./ru.js":122,"./se":123,"./se.js":123,"./si":124,"./si.js":124,"./sk":125,"./sk.js":125,"./sl":126,"./sl.js":126,"./sq":127,"./sq.js":127,"./sr":128,"./sr-cyrl":129,"./sr-cyrl.js":129,"./sr.js":128,"./ss":130,"./ss.js":130,"./sv":131,"./sv.js":131,"./sw":132,"./sw.js":132,"./ta":133,"./ta.js":133,"./te":134,"./te.js":134,"./th":135,"./th.js":135,"./tl-ph":136,"./tl-ph.js":136,"./tlh":137,"./tlh.js":137,"./tr":138,"./tr.js":138,"./tzl":139,"./tzl.js":139,"./tzm":140,"./tzm-latn":141,"./tzm-latn.js":141,"./tzm.js":140,"./uk":142,"./uk.js":142,"./uz":143,"./uz.js":143,"./vi":144,"./vi.js":144,"./x-pseudo":145,"./x-pseudo.js":145,"./zh-cn":146,"./zh-cn.js":146,"./zh-hk":147,"./zh-hk.js":147,"./zh-tw":148,"./zh-tw.js":148};r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=44},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(22),s=r(i),o=n(157),l=r(o),u=n(158),c=r(u);s.default.module("ui.sortable",[]).value("uiSortableConfig",{items:"> [ng-repeat],> [data-ng-repeat],> [x-ng-repeat]"}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"="},link:function(r,i,o,u){function d(e,t){var n="function"==typeof e,r="function"==typeof t;return n&&r?function(){e.apply(this,arguments),t.apply(this,arguments)}:r?t:e}function p(e){var t=e.data("ui-sortable");return t&&"object"===("undefined"==typeof t?"undefined":a(t))&&"ui-sortable"===t.widgetFullName?t:null}function f(t,n){return S[t]?("stop"===t&&(n=d(n,function(){r.$apply()}),n=d(n,_)),n=d(S[t],n)):C[t]&&(n=C[t](n)),n||"items"!==t&&"ui-model-items"!==t||(n=e.items),n}function g(e,t,n){function r(e,t){t in z||(z[t]=null)}s.default.forEach(S,r);var a=null;if(t){var i=void 0;s.default.forEach(t,function(t,n){if(!(e&&n in e)){if(n in P)return void("ui-floating"===n?z[n]="auto":z[n]=f(n,void 0));i||(i=(0,c.default)().options);var r=i[n];r=f(n,r),a||(a={}),a[n]=r,z[n]=r}})}return s.default.forEach(e,function(e,t){return t in P?("ui-floating"!==t||e!==!1&&e!==!0||!n||(n.floating=e),void(z[t]=f(t,e))):(e=f(t,e),a||(a={}),a[t]=e,void(z[t]=e))}),a}function h(e){var t=e.sortable("option","placeholder");if(t&&t.element&&"function"==typeof t.element){var n=t.element();return n=(0,l.default)(n)}return null}function m(e,t){var n=z["ui-model-items"].replace(/[^,]*>/g,""),r=e.find('[class="'+t.attr("class")+'"]:not('+n+")");return r}function v(e,t){var n=e.sortable("option","helper");return"clone"===n||"function"==typeof n&&t.item.sortable.isCustomHelperUsed()}function b(e,t,n){var r=null;return v(e,t)&&"parent"===e.sortable("option","appendTo")&&(r=n.last()),r}function y(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}function w(e,t){for(var n=null,r=0;r<e.length;r++){var a=e[r];if(a.element[0]===t[0]){n=a.scope;break}}return n}function _(e,t){t.item.sortable._destroy()}function x(e){return e.parent().find(z["ui-model-items"]).index(e)}function q(){r.$watchCollection("ngModel",function(){t(function(){p(i)&&i.sortable("refresh")},0,!1)}),S.start=function(e,t){if("auto"===z["ui-floating"]){var n=t.item.siblings(),r=p((0,l.default)(e.target));r.floating=y(n)}var a=x(t.item);t.item.sortable={model:u.$modelValue[a],index:a,source:t.item.parent(),sourceModel:u.$modelValue,cancel:function(){t.item.sortable._isCanceled=!0},isCanceled:function(){return t.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!t.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:t.item.sortable._isCustomHelperUsed,_destroy:function(){s.default.forEach(t.item.sortable,function(e,n){t.item.sortable[n]=void 0})}}},S.activate=function(e,t){k=i.contents();var n=h(i);if(n&&n.length){var a=m(i,n);k=k.not(a)}var s=t.item.sortable._connectedSortables||[];s.push({element:i,scope:r}),t.item.sortable._connectedSortables=s},S.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=x(t.item);var n=t.item.parent();t.item.sortable.droptarget=n;var a=w(t.item.sortable._connectedSortables,n);t.item.sortable.droptargetModel=a.ngModel,i.sortable("cancel")}var s=!t.item.sortable.received&&b(i,t,k);s&&s.length&&(k=k.not(s)),k.appendTo(i),t.item.sortable.received&&(k=null),t.item.sortable.received&&!t.item.sortable.isCanceled()&&r.$apply(function(){u.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})},S.stop=function(e,t){if(!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled())r.$apply(function(){u.$modelValue.splice(t.item.sortable.dropindex,0,u.$modelValue.splice(t.item.sortable.index,1)[0])});else if((!("dropindex"in t.item.sortable)||t.item.sortable.isCanceled())&&!s.default.equals(i.contents(),k)){var n=b(i,t,k);n&&n.length&&(k=k.not(n)),k.appendTo(i)}k=null},S.receive=function(e,t){t.item.sortable.received=!0},S.remove=function(e,t){"dropindex"in t.item.sortable||(i.sortable("cancel"),t.item.sortable.cancel()),t.item.sortable.isCanceled()||r.$apply(function(){t.item.sortable.moved=u.$modelValue.splice(t.item.sortable.index,1)[0]})},C.helper=function(e){return e&&"function"==typeof e?function(t,n){var r=n.sortable,a=x(n);n.sortable={model:u.$modelValue[a],index:a,source:n.parent(),sourceModel:u.$modelValue,_restore:function(){s.default.forEach(n.sortable,function(e,t){n.sortable[t]=void 0}),n.sortable=r}};var i=e.apply(this,arguments);return n.sortable._restore(),n.sortable._isCustomHelperUsed=n!==i,i}:e},r.$watchCollection("uiSortable",function(e,t){var n=p(i);if(n){var r=g(e,t,n);r&&i.sortable("option",r)}},!0),g(z)}function $(){u?q():n.info("ui.sortable: ngModel not provided!",i),i.sortable(z)}function A(){return(!r.uiSortable||!r.uiSortable.disabled)&&($(),A.cancelWatcher(),A.cancelWatcher=s.default.noop,!0)}var k=void 0;i=(0,l.default)(i);var z={},P={"ui-floating":void 0,"ui-model-items":e.items},S={receive:null,remove:null,start:null,stop:null,update:null},C={helper:null};s.default.extend(z,P,e,r.uiSortable),A.cancelWatcher=s.default.noop,A()||(A.cancelWatcher=r.$watch("uiSortable.disabled",A))}}}])},,,,,,,,,1,,,,,,,,,,,,,,,,,1,1,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(185);Object.defineProperty(t,"home",{enumerable:!0,get:function(){return r(a).default}});var i=n(187);Object.defineProperty(t,"queriesList",{enumerable:!0,get:function(){return r(i).default}});var s=n(192);Object.defineProperty(t,"alertsList",{enumerable:!0,get:function(){return r(s).default}});var o=n(194);Object.defineProperty(t,"alert",{enumerable:!0,get:function(){return r(o).default}});var l=n(198);Object.defineProperty(t,"admin",{enumerable:!0,get:function(){return r(l).default}});var u=n(206);Object.defineProperty(t,"dashboards",{enumerable:!0,get:function(){return r(u).default}});var c=n(223);Object.defineProperty(t,"querySnippets",{enumerable:!0,get:function(){return r(c).default}});var d=n(229);Object.defineProperty(t,"users",{enumerable:!0,get:function(){return r(d).default}});var p=n(236);Object.defineProperty(t,"groups",{enumerable:!0,get:function(){return r(p).default}});var f=n(246);Object.defineProperty(t,"destinations",{enumerable:!0,get:function(){return r(f).default}});var g=n(251);Object.defineProperty(t,"dataSources",{enumerable:!0,get:function(){return r(g).default}});var h=n(256);Object.defineProperty(t,"queries",{enumerable:!0,get:function(){return r(h).default}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i){r.record("view","page","personal_homepage"),this.canCreateQuery=n.hasPermission("create_query"),this.canCreateDashboard=n.hasPermission("create_dashboard"),this.recentQueries=i.recent(),this.recentDashboards=a.recent(),this.newDashboard=function(){t.open({component:"editDashboardDialog",resolve:{dashboard:function(){return{name:null,layout:null}}}})}}a.$inject=["$scope","$uibModal","currentUser","Events","Dashboard","Query"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("homePage",{template:s.default,controller:a}),{"/":{template:"<home-page></home-page>",title:"Redash"}}};var i=n(186),s=r(i)},function(e,t){e.exports='<div class="container">\n  <div class="tile m-t-10 m-b-5">\n    <div class="t-body p-5">\n      <a href="queries/new" ng-show="$ctrl.canCreateQuery" class="btn btn-default">New Query</a>\n      <button ng-show="$ctrl.canCreateDashboard" class="btn btn-default" ng-click="$ctrl.newDashboard()">New Dashboard\n      </button>\n      <a href="alerts/new" class="btn btn-default">New Alert</a>\n    </div>\n  </div>\n\n  <div class="tile">\n    <div class="t-body tb-padding">\n      <div class="row">\n          <div class="col-md-6">\n            <p class="f-500 m-b-20 c-black">Recent Dashboards</p>\n            <div class="list-group">\n              <a ng-href="dashboard/{{dashboard.slug}}" class="list-group-item" ng-repeat="dashboard in $ctrl.recentDashboards">\n                {{dashboard.name}} <span class="label label-default" ng-if="dashboard.is_draft">Unpublished</span>\n              </a>\n            </div>\n          </div>\n\n          <div class="col-md-6">\n            <p class="f-500 m-b-20 c-black">Recent Queries</p>\n            <div class="list-group">\n              <a ng-href="queries/{{query.id}}" class="list-group-item"\n                 ng-repeat="query in $ctrl.recentQueries">{{query.name}} <span class="label label-default" ng-if="query.is_draft">Unpublished</span></a>\n            </div>\n          </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.component("pageQueriesList",{template:c.default,controller:d});var t={template:"<page-queries-list></page-queries-list>",reloadOnSearch:!1};return{"/queries":t,"/queries/my":t}};var s=n(42),o=r(s),l=n(188),u=n(191),c=r(u),d=function e(t,n,r){function s(e,n,r){t.search("page",e);var a=i({},c.defaultOptions,{page:e,page_size:n});return c.resource(a).$promise.then(function(e){var t=e.results.map(function(e){return e.created_at=(0,o.default)(e.created_at),e.retrieved_at=(0,o.default)(e.retrieved_at),e});r.updateRows(t,e.count)})}a(this,e);var u=parseInt(t.search().page||1,10);this.defaultOptions={};var c=this;switch(t.path()){case"/queries":n.set("Queries"),this.resource=r.query;break;case"/queries/my":n.set("My Queries"),this.resource=r.myQueries}this.paginator=new l.LivePaginator(s,{page:u}),this.tabs=[{name:"My Queries",path:"queries/my"},{path:"queries",name:"All Queries",isActive:function(e){return"/queries"===e}}]};d.$inject=["$location","Title","Query"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(189);Object.defineProperty(t,"Paginator",{enumerable:!0,get:function(){return r(a).default}});var i=n(190);Object.defineProperty(t,"LivePaginator",{enumerable:!0,get:function(){return r(i).default}})},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.page,i=void 0===a?1:a,s=r.itemsPerPage,o=void 0===s?20:s,l=r.totalCount,u=void 0===l?void 0:l;n(this,e),this.page=i,this.itemsPerPage=o,this.updateRows(t,u)}return r(e,[{key:"setPage",value:function(e){this.page=e}},{key:"getPageRows",value:function(){var e=this.itemsPerPage*(this.page-1),t=this.itemsPerPage*this.page;return this.rows.slice(e,t)}},{key:"updateRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.rows=e,this.rows?this.totalCount=t||e.length:this.totalCount=0}}]),e}();t.default=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.page,i=void 0===a?1:a,s=r.itemsPerPage,o=void 0===s?20:s;n(this,e),this.page=i,this.itemsPerPage=o,this.rowsFetcher=t,this.rowsFetcher(this.page,this.itemsPerPage,this)}return r(e,[{key:"setPage",value:function(e){this.page=e,this.rowsFetcher(e,this.itemsPerPage,this)}},{key:"getPageRows",value:function(){return this.rows}},{key:"updateRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.rows=e,this.rows?this.totalCount=t||e.length:this.totalCount=0}}]),e}();t.default=a},function(e,t){e.exports='<div class="container">\n  <page-header title="Queries"></page-header>\n  <tab-nav tabs="$ctrl.tabs"></tab-nav>\n\n  <div class="bg-white">\n    <table class="table table-condensed table-hover">\n      <thead>\n      <tr>\n        <th>Name</th>\n        <th>Created By</th>\n        <th>Created At</th>\n        <th>Runtime</th>\n        <th>Last Executed At</th>\n        <th>Update Schedule</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="query in $ctrl.paginator.getPageRows()">\n        <td><a href="queries/{{query.id}}">{{query.name}}</a> <span class="label label-default" ng-if="query.is_draft">Unpublished</span></td>\n        <td>{{query.user.name}}</td>\n        <td>{{query.created_at | dateTime}}</td>\n        <td>{{query.runtime | durationHumanize}}</td>\n        <td>{{query.retrieved_at | dateTime}}</td>\n        <td>{{query.schedule | scheduleHumanize}}</td>\n      </tr>\n      </tbody>\n    </table>\n    <paginator paginator="$ctrl.paginator"></paginator>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("alertsListPage",{template:o.default,controller:l}),{"/alerts":{template:"<alerts-list-page></alerts-list-page>",title:"Alerts"}}};var i=n(188),s=n(193),o=r(s),l=function e(t,n){var r=this;a(this,e),t.record("view","page","alerts"),this.alerts=new i.Paginator([],{itemsPerPage:20}),n.query(function(e){var t={ok:"label label-success",triggered:"label label-danger",unknown:"label label-warning"};e.forEach(function(e){e.class=t[e.state]}),r.alerts.updateRows(e)})};l.$inject=["Events","Alert"]},function(e,t){e.exports='<div>\n  <page-header title="Alerts">\n    <a href="alerts/new" class="btn btn-default"><i class="fa fa-plus"></i> New Alert</a>\n  </page-header>\n\n  <div class="container">\n    <div class="container bg-white">\n      <table class="table table-condensed table-hover">\n        <thead>\n        <tr>\n          <th>Name</th>\n          <th>Created By</th>\n          <th>State</th>\n          <th>Created At</th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="row in $ctrl.alerts.getPageRows()">\n          <td><a href="alerts/{{row.id}}">{{row.name}}</a></td>\n          <td>{{row.user.name}}</td>\n          <td><span ng-class="row.class">{{row.state | uppercase}}</span> since <span am-time-ago="row.updated_at"></span></td>\n          <td><span am-time-ago="row.created_at"></span></td>\n        </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.alerts"></paginator>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,s,o,l){var u=this;this.alertId=e.alertId,"new"===this.alertId?o.record("view","page","alerts/new"):o.record("view","alert",this.alertId),this.trustAsHtml=function(e){return n.trustAsHtml(e)},this.onQuerySelected=function(e){u.selectedQuery=e,e.getQueryResultPromise().then(function(e){u.queryResult=e,u.alert.options.column=u.alert.options.column||e.getColumnNames()[0]})},"new"===this.alertId?(this.alert=new l({options:{}}),this.canEdit=!0):this.alert=l.get({id:this.alertId},function(e){u.onQuerySelected(new s(e.query)),u.canEdit=a.canEdit(u.alert)}),this.ops=["greater than","less than","equals"],this.selectedQuery=null;var c=(0,i.template)("<%= query.name %>: <%= options.column %> <%= options.op %> <%= options.value %>");this.getDefaultName=function(){if(u.alert.query)return c(u.alert)},this.searchQueries=function(e){!e||e.length<3||s.search({q:e},function(e){u.queries=e})},this.saveChanges=function(){void 0!==u.alert.name&&""!==u.alert.name||(u.alert.name=u.getDefaultName()),""!==u.alert.rearm&&0!==u.alert.rearm||(u.alert.rearm=null),u.alert.$save(function(e){r.success("Saved."),"new"===u.alertId&&t.path("/alerts/"+e.id).replace()},function(){r.error("Failed saving alert.")})},this.delete=function(){u.alert.$delete(function(){t.path("/alerts"),r.success("Alert deleted.")},function(){r.error("Failed deleting alert.")})}}a.$inject=["$routeParams","$location","$sce","toastr","currentUser","Query","Events","Alert"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("alertPage",{template:o.default,controller:a}),e.directive("alertSubscriptions",u.default),{"/alerts/:alertId":{template:"<alert-page></alert-page>",title:"Alerts"}}};var i=n(155),s=n(195),o=r(s),l=n(196),u=r(l)},function(e,t){e.exports='<page-header title=\'{{$ctrl.alert.name || $ctrl.getDefaultName() || "New" }}\'>\n</page-header>\n\n<div class="container">\n  <email-settings-warning function="\'alert emails\'"></email-settings-warning>\n\n  <div class="container">\n    <div class="row bg-white p-10">\n      <div class="col-md-8">\n        <form name="alertForm" class="form">\n          <div class="form-group">\n            <label>Query</label>\n            <ui-select ng-model="$ctrl.alert.query" reset-search-input="false" on-select="$ctrl.onQuerySelected($item)" ng-disabled="!$ctrl.canEdit">\n              <ui-select-match placeholder="Search a query by name">{{$select.selected.name}}</ui-select-match>\n              <ui-select-choices repeat="q in $ctrl.queries"\n                                 refresh="$ctrl.searchQueries($select.search)"\n                                 refresh-delay="0">\n                <div ng-bind-html="$ctrl.trustAsHtml(q.name | highlight: $select.search)"></div>\n              </ui-select-choices>\n            </ui-select>\n          </div>\n\n          <div class="form-group" ng-show="$ctrl.selectedQuery">\n            <label>Name</label>\n            <input type="string" placeholder="{{$ctrl.getDefaultName()}}" class="form-control" ng-model="$ctrl.alert.name" ng-disabled="!$ctrl.canEdit">\n          </div>\n\n          <div ng-show="$ctrl.queryResult" class="form-horizontal">\n            <div class="form-group">\n              <label class="control-label col-md-2">Value column</label>\n              <div class="col-md-4">\n                <select ng-options="name for name in $ctrl.queryResult.getColumnNames()" ng-model="$ctrl.alert.options.column"\n                        class="form-control" ng-disabled="!$ctrl.canEdit"></select>\n              </div>\n              <label class="control-label col-md-2">Value</label>\n              <div class="col-md-4">\n                <p class="form-control-static">{{$ctrl.queryResult.getData()[0][$ctrl.alert.options.column]}}</p>\n              </div>\n            </div>\n            <div class="form-group">\n              <label class="control-label col-md-2">Op</label>\n              <div class="col-md-4">\n                <select ng-options="name for name in $ctrl.ops" ng-model="$ctrl.alert.options.op" class="form-control" ng-disabled="!$ctrl.canEdit"></select>\n              </div>\n              <label class="control-label col-md-2">Reference</label>\n              <div class="col-md-4">\n                <input type="number" step="any" class="form-control" ng-model="$ctrl.alert.options.value" placeholder="reference value" ng-disabled="!$ctrl.canEdit"\n                       required/>\n              </div>\n            </div>\n            <div class="form-group">\n              <label class="control-label col-md-2">Rearm seconds</label>\n              <div class="col-md-4">\n                <input type="number" class="form-control" ng-model="$ctrl.alert.rearm" ng-disabled="!$ctrl.canEdit"/>\n              </div>\n            </div>\n          </div>\n\n          <div class="form-group" ng-if="$ctrl.canEdit">\n            <button class="btn btn-primary" ng-disabled="!alertForm.$valid" ng-click="$ctrl.saveChanges()">Save</button>\n            <button class="btn btn-danger" ng-if="$ctrl.alert.id" ng-click="$ctrl.delete()">Delete</button>\n          </div>\n        </form>\n      </div>\n      <div class="col-md-4" ng-if="$ctrl.alert.id">\n        <alert-subscriptions alert-id="$ctrl.alert.id"></alert-subscriptions>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,s,o){"ngInject";e.newSubscription={},e.subscribers=[],e.destinations=[],e.currentUser=r,t.all([s.query().$promise,a.query({alertId:e.alertId}).$promise]).then(function(t){var n=t[0],a=t[1],s=(0,i.compact)(a.map(function(e){return e.destination&&e.destination.id})),o=(0,i.compact)(a.map(function(e){return!e.destination&&e.user.id}));e.destinations=n.filter(function(e){return!(0,i.contains)(s,e.id)}),(0,i.contains)(o,r.id)||e.destinations.unshift({user:{name:r.name}}),e.newSubscription.destination=e.destinations[0],e.subscribers=a}),e.destinationsDisplay=function(e){if(!e)return"";var t=e;return e.destination?t=t.destination:t.user&&(t={name:e.user.name+" (Email)",icon:"fa-envelope",type:"user"}),n.trustAsHtml('<i class="fa '+t.icon+'"></i>&nbsp;'+t.name)},e.saveSubscriber=function(){var t=new a({alert_id:e.alertId});e.newSubscription.destination.id&&(t.destination_id=e.newSubscription.destination.id),t.$save(function(){o.success("Subscribed."),e.subscribers.push(t),e.destinations=(0,i.without)(e.destinations,e.newSubscription.destination),e.destinations.length>0?e.newSubscription.destination=e.destinations[0]:e.newSubscription.destination=void 0},function(){o.error("Failed saving subscription.")})},e.unsubscribe=function(t){var n=t.destination,a=t.user;t.$delete(function(){o.success("Unsubscribed"),e.subscribers=(0,i.without)(e.subscribers,t),n?e.destinations.push(n):a.id===r.id&&e.destinations.push({user:{name:r.name}}),1===e.destinations.length&&(e.newSubscription.destination=e.destinations[0])},function(){o.error("Failed unsubscribing.")})}}a.$inject=["$scope","$q","$sce","currentUser","AlertSubscription","Destination","toastr"],Object.defineProperty(t,"__esModule",{value:!0});var i=n(155),s=n(197),o=r(s);t.default=function(){return{restrict:"E",replace:!0,scope:{alertId:"="},template:o.default,controller:a}}},function(e,t){e.exports='<div class="p-5">\n  <h4>Notifications</h4>\n\n  <div>\n    <ui-select ng-model="newSubscription.destination" ng-disabled="destinations.length == 0">\n      <ui-select-match><span ng-bind-html="destinationsDisplay($select.selected)"></span></ui-select-match>\n      <ui-select-choices repeat="d in destinations">\n        <span ng-bind-html="destinationsDisplay(d)"></span>\n      </ui-select-choices>\n    </ui-select>\n  </div>\n  <div class="m-t-5">\n    <button class="btn btn-default" ng-click="saveSubscriber()" ng-disabled="destinations.length == 0" style="width:50%;">Add</button>\n    <span class="pull-right m-t-5">\n      <a href="destinations/new" ng-if="currentUser.isAdmin">Create New Destination</a>\n    </span>\n  </div>\n\n  <hr/>\n\n  <div>\n    <div class="list-group-item" ng-repeat="subscriber in subscribers">\n      <span ng-bind-html="destinationsDisplay(subscriber)"></span>\n      <button class="btn btn-xs btn-danger pull-right" ng-click="unsubscribe(subscriber)" ng-if="currentUser.isAdmin || currentUser.id == subscriber.user.id">Remove</button>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){var t=a({},(0,s.default)(e),(0,l.default)(e),(0,c.default)(e));return t};var i=n(199),s=r(i),o=n(201),l=r(o),u=n(203),c=r(u)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a){a.record("view","page","admin/status");var i=function r(){t.get("/status.json").success(function(t){e.workers=t.workers,delete t.workers,e.manager=t.manager,delete t.manager,e.status=t});var a=n(r,59e3);e.$on("$destroy",function(){a&&n.cancel(a)})};i()}a.$inject=["$scope","$http","$timeout","currentUser","Events"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("statusPage",{template:s.default,controller:a}),{"/admin/status":{template:"<status-page></status-page>",title:"System Status"}}};var i=n(200),s=r(i)},function(e,t){e.exports='<page-header title="Admin">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li class="active"><a href="admin/status">System Status</a></li>\n      <li><a href="admin/queries/tasks">Queries Queue</a></li>\n      <li><a href="admin/queries/outdated">Outdated Queries</a></li>\n    </ul>\n\n    <div>\n\n      <ul class="list-group col-lg-4">\n        <li class="list-group-item active">General</li>\n        <li class="list-group-item" ng-repeat="(name, value) in status">\n          <span class="badge">{{value}}</span>\n          {{name | toHuman}}\n        </li>\n      </ul>\n\n      <ul class="list-group col-lg-4">\n        <li class="list-group-item active">Manager</li>\n        <li class="list-group-item">\n          <span class="badge" am-time-ago="manager.last_refresh_at*1000.0"></span>\n          Last Refresh\n        </li>\n        <li class="list-group-item">\n          <span class="badge" am-time-ago="manager.started_at*1000.0"></span>\n          Started\n        </li>\n        <li class="list-group-item">\n          <span class="badge">{{manager.outdated_queries_count}}</span>\n          Outdated Queries Count\n        </li>\n      </ul>\n\n      <ul class="list-group col-lg-4">\n        <li class="list-group-item active">Queues</li>\n        <li class="list-group-item" ng-repeat="(name, value) in manager.queues">\n          <span class="badge">{{value.size}}</span>\n          {{name}} <span uib-popover="{{value.data_sources}}" popover-trigger="\'mouseenter\'"><i class="fa fa-question-circle"></i></span>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n';
},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r){var a=this;t.record("view","page","admin/outdated_queries"),e.autoUpdate=!0,this.queries=new o.Paginator([],{itemsPerPage:50});var i=function t(){e.autoUpdate&&(e.refresh_time=(0,s.default)().add(1,"minutes"),n.get("/api/admin/queries/outdated").success(function(t){a.queries.updateRows(t.queries),e.updatedAt=1e3*t.updated_at}));var i=r(t,59e3);e.$on("$destroy",function(){i&&r.cancel(i)})};i()}a.$inject=["$scope","Events","$http","$timeout"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("outdatedQueriesPage",{template:u.default,controller:a}),{"/admin/queries/outdated":{template:"<outdated-queries-page></outdated-queries-page>",title:"Outdated Queries"}}};var i=n(42),s=r(i),o=n(188),l=n(202),u=r(l)},function(e,t){e.exports='<page-header title="Admin">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li><a href="admin/status">System Status</a></li>\n      <li><a href="admin/queries/tasks">Queries Queue</a></li>\n      <li class="active"><a href="admin/queries/outdated">Outdated Queries</a></li>\n    </ul>\n\n    <table class="table table-condensed table-hover">\n      <thead>\n      <tr>\n        <th>Name</th>\n        <th>Created By</th>\n        <th>Runtime</th>\n        <th>Last Executed At</th>\n        <th>Created At</th>\n        <th>Update Schedule</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="row in $ctrl.queries.getPageRows()">\n        <td>\n          {{row.data_source_id}}\n        </td>\n        <td>\n          <a ng-href="queries/{{row.id}}">{{row.name}}</a>\n        </td>\n        <td>{{row.user.name}}</td>\n        <td>{{row.runtime | durationHumanize}}</td>\n        <td>{{row.retrieved_at | dateTime}}</td>\n        <td>{{row.created_at | dateTime }}</td>\n        <td>{{row.schedule | scheduleHumanize}}</td>\n      </tr>\n      </tbody>\n    </table>\n    <paginator paginator="$ctrl.queries"></paginator>\n\n    <div class="badge">\n      Last update: <span am-time-ago="updatedAt"></span>\n    </div>\n    (<label><input type="checkbox" ng-model="autoUpdate"> Auto Update</label>)\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a){var i=this;a.record("view","page","admin/tasks"),e.autoUpdate=!0,e.selectedTab="in_progress",e.tasks={waiting:[],in_progress:[],done:[]},this.tasksPaginator=new o.Paginator([],{itemsPerPage:50}),e.setTab=function(t){e.selectedTab=t,i.tasksPaginator.updateRows(e.tasks[t])},e.setTab(t.hash()||"in_progress");var l=function t(){e.autoUpdate&&(e.refresh_time=(0,s.default)().add(1,"minutes"),n.get("/api/admin/queries/tasks").success(function(t){e.tasks=t,i.tasksPaginator.updateRows(e.tasks[e.selectedTab])}));var a=r(t,5e3);e.$on("$destroy",function(){a&&r.cancel(a)})};l()}a.$inject=["$scope","$location","$http","$timeout","Events"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("tasksPage",{template:u.default,controller:a}),(0,d.default)(e),{"/admin/queries/tasks":{template:"<tasks-page></tasks-page>",title:"Running Queries"}}};var i=n(42),s=r(i),o=n(188),l=n(204),u=r(l),c=n(205),d=r(c)},function(e,t){e.exports='<page-header title="Admin">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li><a href="admin/status">System Status</a></li>\n      <li class="active"><a href="admin/queries/tasks">Queries Queue</a></li>\n      <li><a href="admin/queries/outdated">Outdated Queries</a></li>\n    </ul>\n\n    <ul class="tab-nav">\n      <rd-tab tab-id="in_progress" name="In Progress ({{tasks.in_progress.length}})" ng-click="setTab(\'in_progress\')"></rd-tab>\n      <rd-tab tab-id="waiting" name="Waiting ({{tasks.waiting.length}})" ng-click="setTab(\'waiting\')"></rd-tab>\n      <rd-tab tab-id="done" name="Done" ng-click="setTab(\'done\')"></rd-tab>\n    </ul>\n\n    <table class="table table-condensed table-hover">\n      <thead>\n      <tr>\n        <th>Data Source ID</th>\n        <th>Username</th>\n        <th>State</th>\n        <th>Query ID</th>\n        <th>Query Hash</th>\n        <th>Runtime</th>\n        <th>Created At</th>\n        <th>Started At</th>\n        <th>Updated At</th>\n        <th ng-if="selectedTab === \'in_progress\'"></th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="row in $ctrl.tasksPaginator.getPageRows()">\n        <td>{{row.data_source_id}}</td>\n        <td>{{row.username}}</td>\n        <td>{{row.state}} <span ng-if="row.state === \'failed\'" uib-popover="{{row.error}}" popover-trigger="mouseenter" class="zmdi zmdi-help"></span></td>\n        <td>{{row.query_id}}</td>\n        <td>{{row.query_hash}}</td>\n        <td>{{row.run_time | durationHumanize}}</td>\n        <td>{{row.created_at | toMilliseconds | dateTime }}</td>\n        <td>{{row.started_at | toMilliseconds | dateTime }}</td>\n        <td>{{row.updated_at | toMilliseconds | dateTime }}</td>\n        <td ng-if="selectedTab === \'in_progress\'">\n          <cancel-query-button query-id="dataRow.query_id" task-id="dataRow.task_id"></cancel-query-button>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n    <paginator paginator="$ctrl.tasksPaginator"></paginator>\n\n    <label><input type="checkbox" ng-model="autoUpdate"> Auto Update</label>\n  </div>\n</div>\n'},function(e,t){"use strict";function n(){return{restrict:"E",scope:{queryId:"=",taskId:"="},transclude:!0,template:'<button class="btn btn-default" ng-disabled="inProgress" ng-click="cancelExecution()"><i class="zmdi zmdi-spinner zmdi-hc-spin" ng-if="inProgress"></i> Cancel</button>',replace:!0,controller:["$scope","$http","currentUser","Events",function(e,t,n,r){e.inProgress=!1,e.cancelExecution=function(){t.delete("api/jobs/"+e.taskId).success(function(){});var n=e.queryId;"adhoc"===e.queryId&&(n=null),r.record("cancel_execute","query",n,{admin:!0}),e.inProgress=!0}}]}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("cancelQueryButton",n)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){return(0,p.default)(e),(0,c.default)(e),(0,m.default)(e),(0,g.default)(e),a({},(0,s.default)(e),(0,l.default)(e))};var i=n(207),s=r(i),o=n(210),l=r(o),u=n(213),c=r(u),d=n(216),p=r(d),f=n(218),g=r(f),h=n(220),m=r(h)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n,r,a,i,s,l,u,c,d,p){var f=this;this.isFullscreen=!1,this.refreshRate=null,this.showPermissionsControl=d.showPermissionsControl,this.currentUser=c,this.globalParameters=[],this.refreshRates=[{name:"10 seconds",rate:10},{name:"30 seconds",rate:30},{name:"1 minute",rate:60},{name:"5 minutes",rate:300},{name:"10 minutes",rate:600},{name:"30 minutes",rate:1800},{name:"1 hour",rate:3600}],this.setRefreshRate=function(e){f.refreshRate=e,null!==e&&(f.loadDashboard(!0),f.autoRefresh())},this.extractGlobalParameters=function(){var e={};f.dashboard.widgets.forEach(function(t){return t.forEach(function(t){t.getQuery()&&t.getQuery().getParametersDefs().filter(function(e){return e.global}).forEach(function(t){var n={};n[t.name]=o.create(Object.getPrototypeOf(t),t),n[t.name].locals=[],e=o.defaults(e,n),e[t.name].locals.push(t)})})}),f.globalParameters=o.values(e)},this.onGlobalParametersChange=function(){f.globalParameters.forEach(function(e){e.locals.forEach(function(t){t.value=e.value})})};var g=function(e,t){s.set(e.name);var r=[];f.dashboard.widgets.forEach(function(e){return e.forEach(function(e){if(e.visualization){var n=t?0:void 0,a=e.getQuery().getQueryResult(n);o.isUndefined(a)||r.push(a.toPromise())}})}),f.extractGlobalParameters(),a.all(r).then(function(t){var r={};t.forEach(function(t){var a=t.getFilters();a.forEach(function(t){var a=o.has(n.search(),t.name);if(a||e.dashboard_filters_enabled){if(a&&(t.current=n.search()[t.name]),!o.has(r,t.name)){var i=o.extend({},t);r[i.name]=i,r[i.name].originFilters=[]}r[t.name].originFilters.push(t)}})}),f.filters=o.values(r),f.filtersOnChange=function(e){o.each(e.originFilters,function(t){t.current=e.current})}})};this.loadDashboard=o.throttle(function(e){f.dashboard=u.get({slug:t.dashboardSlug},function(t){p.record("view","dashboard",t.id),g(t,e)},function(){f.loadDashboard()})},1e3),this.loadDashboard(),this.autoRefresh=function(){r(function(){f.loadDashboard(!0)},1e3*f.refreshRate.rate).then(function(){return f.autoRefresh()})},this.archiveDashboard=function(){var t=function(){p.record("archive","dashboard",f.dashboard.id),f.dashboard.$delete(function(){e.$broadcast("reloadDashboards")})},n="Archive Dashboard",r='Are you sure you want to archive the "'+f.dashboard.name+'" dashboard?',a={class:"btn-warning",title:"Archive"};l.open(n,r,a).then(t)},this.showManagePermissionsModal=function(){i.open({component:"permissionsEditor",resolve:{aclUrl:{url:"api/dashboards/"+f.dashboard.id+"/acl"}}})},this.editDashboard=function(){i.open({component:"editDashboardDialog",resolve:{dashboard:function(){return f.dashboard}}}).result.then(function(e){f.dashboard=e})},this.addWidget=function(){i.open({component:"addWidgetDialog",resolve:{dashboard:function(){return f.dashboard}}}).result.then(function(){return f.extractGlobalParameters()})},this.toggleFullscreen=function(){f.isFullscreen=!f.isFullscreen,document.querySelector("body").classList.toggle("headless"),f.isFullscreen?n.search("fullscreen",!0):n.search("fullscreen",null)},this.togglePublished=function(){p.record("toggle_published","dashboard",f.dashboard.id),f.dashboard.is_draft=!f.dashboard.is_draft,f.saveInProgress=!0,u.save({slug:f.dashboard.id,name:f.dashboard.name,layout:JSON.stringify(f.dashboard.layout),is_draft:f.dashboard.is_draft},function(t){f.saveInProgress=!1,f.dashboard.version=t.version,e.$broadcast("reloadDashboards")})},o.has(n.search(),"fullscreen")&&this.toggleFullscreen(),this.openShareForm=function(){i.open({component:"shareDashboard",resolve:{dashboard:f.dashboard}})}}i.$inject=["$rootScope","$routeParams","$location","$timeout","$q","$uibModal","Title","AlertDialog","Dashboard","currentUser","clientConfig","Events"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("shareDashboard",p),e.component("dashboardPage",{template:u.default,controller:i}),{"/dashboard/:dashboardSlug":{template:"<dashboard-page></dashboard-page>",reloadOnSearch:!1}}};var s=n(155),o=a(s),l=n(208),u=r(l),c=n(209),d=r(c),p={template:d.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$http",function(e){"ngInject";var t=this;this.dashboard=this.resolve.dashboard,this.toggleSharing=function(){var n="api/dashboards/"+t.dashboard.id+"/share";t.dashboard.publicAccessEnabled?e.post(n).success(function(e){t.dashboard.publicAccessEnabled=!0,t.dashboard.public_url=e.public_url}).error(function(){t.dashboard.publicAccessEnabled=!1}):e.delete(n).success(function(){t.dashboard.publicAccessEnabled=!1,delete t.dashboard.public_url}).error(function(){t.dashboard.publicAccessEnabled=!0})}}]}},function(e,t){e.exports='<div class="container">\n  <div class="row bg-white p-t-10 p-b-10 m-b-10">\n    <div class="col-sm-9">\n      <h3>{{$ctrl.dashboard.name}}\n        <span class="label label-default" ng-if="$ctrl.dashboard.is_draft && !$ctrl.dashboard.is_archived">Unpublished</span>\n        <span class="label label-warning" ng-if="$ctrl.dashboard.is_archived" uib-popover="This dashboard is archived and and won\'t appear in the dashboards list or search results." popover-placement="right" popover-trigger="\'mouseenter\'">Archived</span>\n      </h3>\n    </div>\n    <div class="col-sm-3 text-right">\n      <h3>\n        <span ng-if="!$ctrl.dashboard.is_archived && !public" class="hidden-print">\n            <div class="btn-group" uib-dropdown>\n              <button id="split-button" type="button"\n                      ng-class="{\'btn-default\': $ctrl.refreshRate === null,\'btn-primary\':$ctrl.refreshRate !== null}"\n                      class="btn" ng-click="$ctrl.loadDashboard(true)">\n                <i class="zmdi zmdi-refresh"></i> {{$ctrl.refreshRate === null ? \'Refresh\' : $ctrl.refreshRate.name}}\n              </button>\n              <button type="button" class="btn" uib-dropdown-toggle\n                      ng-class="{\'btn-default\': $ctrl.refreshRate === null,\'btn-primary\':$ctrl.refreshRate !== null}">\n                <span class="caret"></span>\n                <span class="sr-only">Split button!</span>\n              </button>\n              <ul class="dropdown-menu" ng-model="$ctrl.refreshRate" uib-dropdown-menu role="menu" aria-labelledby="split-button">\n                <li role="menuitem" ng-repeat="refreshRate in $ctrl.refreshRates">\n                  <a href="#" ng-click="$ctrl.setRefreshRate(refreshRate)">{{refreshRate.name}}</a>\n                </li>\n                <li role="menuitem" ng-if="$ctrl.refreshRate !== null">\n                  <a href="#" ng-click="$ctrl.setRefreshRate(null)">Stop auto refresh</a>\n                </li>\n              </ul>\n            </div>\n            <button type="button" class="btn btn-sm" ng-class="{\'btn-default\': !$ctrl.isFullscreen, \'btn-primary\': $ctrl.isFullscreen}" tooltip="Enable/Disable Fullscreen display" ng-click="$ctrl.toggleFullscreen()">\n              <span class="zmdi zmdi-fullscreen"></span>\n            </button>\n            <button type="button" class="btn btn-sm" ng-class="{\'btn-default\': !$ctrl.dashboard.publicAccessEnabled, \'btn-primary\': $ctrl.dashboard.publicAccessEnabled}" tooltip="Enable/Disable Share URL" ng-click="$ctrl.openShareForm()" ng-if="$ctrl.dashboard.canEdit() || $ctrl.dashboard.publicAccessEnabled">\n              <span class="zmdi zmdi-share"></span>\n            </button>\n        </span>\n            <div class="btn-group hidden-print" role="group" ng-show="$ctrl.dashboard.canEdit()" uib-dropdown ng-if="!$ctrl.dashboard.is_archived">\n              <button class="btn btn-default btn-sm dropdown-toggle" uib-dropdown-toggle>\n                <span class="zmdi zmdi-more"></span>\n              </button>\n              <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n                <li ng-if="!$ctrl.dashboard.is_archived"><a ng-click="$ctrl.editDashboard()">Edit Dashboard</a></li>\n                <li ng-if="!$ctrl.dashboard.is_archived"><a ng-click="$ctrl.addWidget()">Add Widget</a></li>\n                <li ng-if="$ctrl.showPermissionsControl"><a ng-click="$ctrl.showManagePermissionsModal()">Manage Permissions</a></li>\n                <li ng-if="!$ctrl.dashboard.is_draft"><a ng-click="$ctrl.togglePublished()">Unpublish Dashboard</a></li>\n                <li ng-if="$ctrl.dashboard.is_draft"><a ng-click="$ctrl.togglePublished()">Publish Dashboard</a></li>\n                <li ng-if="!$ctrl.dashboard.is_archived"><a ng-click="$ctrl.archiveDashboard()">Archive Dashboard</a></li>\n              </ul>\n            </div>\n      </h3>\n    </div>\n  </div>\n\n  <div class="m-b-5">\n    <parameters parameters="$ctrl.globalParameters" on-change="$ctrl.onGlobalParametersChange()"></parameters>\n  </div>\n\n  <div class="m-b-5">\n    <filters ng-if="$ctrl.dashboard.dashboard_filters_enabled" filters="$ctrl.filters" on-change="$ctrl.filtersOnChange(filter, $modal)"></filters>\n  </div>\n\n  <div ng-repeat="row in $ctrl.dashboard.widgets" class="row">\n    <dashboard-widget ng-repeat="widget in row" widget="widget" dashboard="$ctrl.dashboard" on-delete="$ctrl.extractGlobalParameters()"></dashboard-widget>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span>\n  </button>\n  <h4 class="modal-title"><i class="fa fa-share-alt"></i> Share</h4>\n</div>\n<div class="modal-body">\n  <div class="checkbox">\n    <label>\n      <input type="checkbox" ng-model="$ctrl.dashboard.publicAccessEnabled" ng-click="$ctrl.toggleSharing()" ng-disabled="!$ctrl.dashboard.canEdit()">\n      Allow public access (using a secret URL).\n    </label>\n  </div>\n\n  <div ng-if="$ctrl.dashboard.publicAccessEnabled">\n    <input type="text" class="form-control" value="{{$ctrl.dashboard.public_url}}">\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){var r=this,a=/(^[\w\s]+):|(#[\w-]+)/gi;this.logoUrl=n.logoUrl;var i=parseInt(t.search().page||1,10);this.defaultOptions={},this.dashboards=e.query({}),this.selectedTags=[],this.searchText="",this.tagIsSelected=function(e){return r.selectedTags.indexOf(e)>-1},this.toggleTag=function(e,t){r.tagIsSelected(t)?e.shiftKey?r.selectedTags=r.selectedTags.filter(function(e){return e!==t}):r.selectedTags=[]:e.shiftKey?r.selectedTags.push(t):r.selectedTags=[t],r.update()},this.allTags=[],this.dashboards.$promise.then(function(e){var t=e.map(function(e){return e.name.match(a)});r.allTags=s.default.unique(s.default.flatten(t)).filter(function(e){return e}).map(function(e){return e.replace(/:$/,"")}),r.allTags.sort()}),this.paginator=new o.Paginator([],{page:i}),this.update=function(){r.dashboards.$promise.then(function(e){var t=e.map(function(e){return e.tags=(e.name.match(a)||[]).map(function(e){return e.replace(/:$/,"")}),e.untagged_name=e.name.replace(a,"").trim(),e}).filter(function(e){if(r.selectedTags.length){var t=new Set(e.tags),n=r.selectedTags,a=n.filter(function(e){return t.has(e)});if(n.length!==a.length)return!1}return!(r.searchText&&r.searchText.length&&!e.untagged_name.toLowerCase().includes(r.searchText.toLowerCase()))});r.paginator.updateRows(t,e.count)})},this.update()}a.$inject=["Dashboard","$location","clientConfig"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("pageDashboardList",{template:u.default,controller:a});var t={template:"<page-dashboard-list></page-dashboard-list>",reloadOnSearch:!1,title:"Dashboards"};return{"/dashboards":t}};var i=n(155),s=r(i),o=n(188),l=n(211),u=r(l);n(212)},function(e,t){e.exports='<div class=\'container row\'>\n  <page-header title="Dashboards"></page-header>\n  <div class="col-lg-3">\n    <input type=\'text\' class=\'form-control\' placeholder="Search Dashboards..." \n      ng-change="$ctrl.update()" ng-model="$ctrl.searchText"/>\n    <div class=\'list-group m-t-20 tags-list\'>\n      <a ng-repeat=\'tag in $ctrl.allTags\' ng-class=\'{"active": $ctrl.tagIsSelected(tag)}\'\n      class=\'list-group-item\' ng-click=\'$ctrl.toggleTag($event, tag)\'>\n        {{ tag }}\n      </a>\n    </div>\n  </div>\n  <div class="col-lg-9">\n    <div class="bg-white">\n      <table class="table table-condensed table-hover">\n        <thead>\n        <tr>\n          <th>Name</th>\n          <th>Created At</th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="dashboard in $ctrl.paginator.getPageRows()">\n          <td>\n            <a href="dashboard/{{ dashboard.slug }}">\n              <span class="label label-primary m-2" ng-bind="tag" ng-repeat="tag in dashboard.tags"></span> {{ dashboard.untagged_name }}\n              <span class="label label-default" ng-if="dashboard.is_draft">Unpublished</span>\n            </a>\n          </td>\n          <td>{{ dashboard.created_at | dateTime }}</td>\n        </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.paginator"></paginator>\n    </div>\n  </div>\n</div>'},1,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a){var i=this;this.canViewQuery=a.hasPermission("view_query"),this.editTextBox=function(){t.open({component:"editTextBox",resolve:{widget:i.widget}})},this.localParametersDefs=function(){return i.localParameters||(i.localParameters=i.widget.query.getParametersDefs().filter(function(e){return!e.global})),i.localParameters},this.deleteWidget=function(){n.confirm('Are you sure you want to remove "'+i.widget.getName()+'" from the dashboard?')&&(r.record("delete","widget",i.widget.id),i.widget.$delete(function(e){i.dashboard.widgets=i.dashboard.widgets.map(function(e){return e.filter(function(e){return void 0!==e.id})}),i.dashboard.widgets=i.dashboard.widgets.filter(function(e){return e.length>0}),i.dashboard.layout=e.layout,i.dashboard.version=e.version,i.deleted&&i.deleted({})}))},r.record("view","widget",this.widget.id),this.reload=function(t){var n=e.search().maxAge;t&&(n=0),i.queryResult=i.query.getQueryResult(n)},this.widget.visualization?(r.record("view","query",this.widget.visualization.query.id),r.record("view","visualization",this.widget.visualization.id),this.query=this.widget.getQuery(),this.reload(!1),this.type="visualization"):this.widget.restricted?this.type="restricted":this.type="textbox"}a.$inject=["$location","$uibModal","$window","Events","currentUser"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("editTextBox",u),e.component("dashboardWidget",{template:s.default,controller:a,bindings:{widget:"<",public:"<",dashboard:"<",deleted:"&onDelete"}})};var i=n(214),s=r(i),o=n(215),l=r(o),u={template:l.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["toastr",function(e){"ngInject";var t=this;this.saveInProgress=!1,this.widget=this.resolve.widget,this.saveWidget=function(){t.saveInProgress=!0,t.widget.$save().then(function(){t.close()}).catch(function(){e.error("Widget can not be updated")}).finally(function(){t.saveInProgress=!1})}}]}},function(e,t){e.exports='<div class="col-lg-{{$ctrl.widget.width | colWidth}}">\n    <div class="tile" ng-if="$ctrl.type==\'visualization\'">\n        <div class="t-header widget">\n            <div class="th-title">\n                <p class="hidden-print">\n                    <span ng-hide="$ctrl.canViewQuery">{{$ctrl.query.name}}</span>\n                    <query-link query="$ctrl.query" visualization="$ctrl.widget.visualization" ng-show="$ctrl.canViewQuery"></query-link>\n                    <small><visualization-name visualization="$ctrl.widget.visualization"/></small>\n                </p>\n                <p class="visible-print">\n                  {{$ctrl.query.name}}\n                  <visualization-name visualization="$ctrl.widget.visualization"/>\n                </p>\n                <div class="text-muted" ng-bind-html="$ctrl.query.description | markdown"></div>\n            </div>\n          <div class="actions dropdown" uib-dropdown ng-if="!$ctrl.public">\n            <a data-toggle="dropdown" uib-dropdown-toggle><i class="zmdi zmdi-more"></i></a>\n\n            <ul class="dropdown-menu pull-right" uib-dropdown-menu style="z-index:1000000">\n              <li ng-class="{\'disabled\': $ctrl.queryResult.isEmpty()}"><a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'csv\')}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'csv\')}}" target="_self">Download as CSV File</a></li>\n              <li ng-class="{\'disabled\': $ctrl.queryResult.isEmpty()}"><a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'xlsx\')}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'xlsx\')}}" target="_self">Download as Excel File</a></li>\n              <li><a ng-href="queries/{{$ctrl.query.id}}#{{$ctrl.widget.visualization.id}}" ng-show="$ctrl.canViewQuery">View Query</a></li>\n              <li><a ng-show="$ctrl.dashboard.canEdit()" ng-click="$ctrl.deleteWidget()">Remove From Dashboard</a></li>\n            </ul>\n          </div>\n        </div>\n\n        <parameters parameters="$ctrl.localParametersDefs()"></parameters>\n\n        <div ng-switch="$ctrl.queryResult.getStatus()">\n          <div ng-switch-when="failed">\n            <div class="alert alert-danger m-5" ng-show="$ctrl.queryResult.getError()">Error running query: <strong>{{$ctrl.queryResult.getError()}}</strong></div>\n          </div>\n          <div ng-switch-when="done">\n              <visualization-renderer visualization="$ctrl.widget.visualization" query-result="$ctrl.queryResult" class="t-body"></visualization-renderer>\n          </div>\n          <div ng-switch-default class="text-center">\n            <i class="zmdi zmdi-refresh zmdi-hc-spin zmdi-hc-5x"></i>\n          </div>\n        </div>\n\n        <div class="p-5 clearfix" style="line-height:28px;">\n            <span class="small hidden-print">Updated: <span am-time-ago="$ctrl.queryResult.getUpdatedAt()"></span></span>\n            <span class="visible-print">\n              Updated: {{$ctrl.queryResult.getUpdatedAt() | dateTime}}\n            </span>\n            <button class="btn btn-sm btn-default pull-right hidden-print" ng-click="$ctrl.reload(true)" ng-if="!$ctrl.public"><i class="zmdi zmdi-refresh"></i></button>\n        </div>\n    </div>\n\n  <div class="tile" ng-if="$ctrl.type==\'restricted\'">\n    <div class="t-body">\n      <div class="text-center">\n        <h1><span class="zmdi zmdi-lock"></span></h1>\n        <p class="text-muted">\n          This widget requires access to a data source you don\'t have access to.\n        </p>\n      </div>\n    </div>\n  </div>\n\n  <div class="tile" ng-hide="$ctrl.widget.width === 0" ng-if="$ctrl.type==\'textbox\'">\n    <div class="t-body">\n      <div class="dropdown" uib-dropdown ng-if="!$ctrl.public && $ctrl.dashboard.canEdit()">\n        <div class="dropdown-header">\n          <a data-toggle="dropdown" uib-dropdown-toggle class="actions"><i class="zmdi zmdi-more"></i></a>\n        </div>\n\n        <ul class="dropdown-menu pull-right" uib-dropdown-menu style="z-index:1000000">\n          <li><a ng-show="$ctrl.dashboard.canEdit()" ng-click="$ctrl.editTextBox()">Edit</a></li>\n          <li><a ng-show="$ctrl.dashboard.canEdit()" ng-click="$ctrl.deleteWidget()">Remove From Dashboard</a></li>\n        </ul>\n      </div>\n      <p ng-bind-html="$ctrl.widget.text | markdown" class="p-5"></p>\n    </div>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n  <h4 class="modal-title">Edit TextBox</h4>\n</div>\n<div class="modal-body">\n  <div class="form-group">\n    <textarea class="form-control" ng-model="$ctrl.widget.text" rows="3"></textarea>\n  </div>\n  <div ng-show="$ctrl.widget.text">\n    <strong>Preview:</strong>\n    <p ng-bind-html="$ctrl.widget.text | markdown"></p>\n  </div>\n</div>\n\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.close()">Close</button>\n  <button type="button" class="btn btn-primary" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.saveWidget()">Save</button>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("addWidgetDialog",s)};var a=n(217),i=r(a),s={template:i.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$sce","toastr","Query","Widget",function(e,t,n,r){"ngInject";var a=this;this.dashboard=this.resolve.dashboard,this.saveInProgress=!1,this.widgetSize=1,this.selectedVis=null,this.query={},this.selected_query=void 0,this.text="",this.widgetSizes=[{name:"Regular",value:1},{name:"Double",value:2}],this.type="visualization",this.trustAsHtml=function(t){return e.trustAsHtml(t)},this.isVisualization=function(){return"visualization"===a.type},this.isTextBox=function(){return"textbox"===a.type},this.setType=function(e){a.type=e,"textbox"===e?a.widgetSizes.push({name:"Hidden",value:0}):a.widgetSizes.length>2&&a.widgetSizes.pop()},this.onQuerySelect=function(){a.query.selected&&n.get({id:a.query.selected.id},function(e){e&&(a.selected_query=e,e.visualizations.length&&(a.selectedVis=e.visualizations[0]))})},this.searchQueries=function(e){!e||e.length<3||n.search({q:e},function(e){a.queries=e})},this.saveWidget=function(){a.saveInProgress=!0;var e=new r({visualization_id:a.selectedVis&&a.selectedVis.id,dashboard_id:a.dashboard.id,options:{},width:a.widgetSize,text:a.text});e.$save().then(function(e){a.dashboard.layout=e.layout,a.dashboard.version=e.version;var t=new r(e.widget);e.new_row?a.dashboard.widgets.push([t]):a.dashboard.widgets[a.dashboard.widgets.length-1].push(t),a.close()}).catch(function(){t.error("Widget can not be added")}).finally(function(){a.saveInProgress=!1})}}]}},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-disabled="$ctrl.saveInProgress" aria-hidden="true" ng-click="$ctrl.dismiss()">&times;</button>\n  <h4 class="modal-title">Add Widget</h4>\n</div>\n<div class="modal-body">\n  <p class="btn-group">\n      <button type="button" class="btn btn-default" ng-class="{active: $ctrl.isVisualization()}" ng-click="$ctrl.setType(\'visualization\')">Visualization</button>\n      <button type="button" class="btn btn-default" ng-class="{active: $ctrl.isTextBox()}" ng-click="$ctrl.setType(\'textbox\')">Text Box</button>\n  </p>\n\n  <div ng-show="$ctrl.isTextBox()">\n      <div class="form-group">\n          <textarea class="form-control" ng-model="$ctrl.text" rows="3"></textarea>\n      </div>\n      <div ng-show="$ctrl.text">\n          <strong>Preview:</strong>\n          <p ng-bind-html="$ctrl.text | markdown"></p>\n      </div>\n  </div>\n\n  <div ng-show="$ctrl.isVisualization()">\n      <div class="form-group">\n          <ui-select ng-model="$ctrl.query.selected" theme="bootstrap" reset-search-input="false" on-select="$ctrl.onQuerySelect($item, $model)">\n              <ui-select-match placeholder="Search a query by name">{{$select.selected.name}}</ui-select-match>\n              <ui-select-choices repeat="q in $ctrl.queries"\n                                 refresh="$ctrl.searchQueries($select.search)"\n                                 refresh-delay="0">\n                  <div ng-bind-html="$ctrl.trustAsHtml(q.name | highlight: $select.search)"></div>\n              </ui-select-choices>\n          </ui-select>\n      </div>\n\n      <div ng-show="$ctrl.selected_query">\n          <div class="form-group">\n              <label for="">Choose Visualization</label>\n              <select ng-model="$ctrl.selectedVis" ng-options="vis as vis.name group by vis.type for vis in $ctrl.selected_query.visualizations" class="form-control"></select>\n          </div>\n      </div>\n  </div>\n\n  <div class="form-group">\n      <label for="">Widget Size</label>\n      <select class="form-control" ng-model="$ctrl.widgetSize"\n              ng-options="c.value as c.name for c in $ctrl.widgetSizes"></select>\n  </div>\n</div>\n\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.dismiss()">Close</button>\n  <button type="button" class="btn btn-primary" ng-disabled="$ctrl.saveInProgress || !($ctrl.selectedVis || $ctrl.isTextBox())" ng-click="$ctrl.saveWidget()">Add to Dashboard</button>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("editDashboardDialog",o)};var a=n(155),i=n(219),s=r(i),o={bindings:{resolve:"<",close:"&",dismiss:"&"},template:s.default,controller:["$rootScope","$location","$http","toastr","Events","Dashboard",function(e,t,n,r,i,s){"ngInject";var o=this;this.dashboard=this.resolve.dashboard,this.gridsterOptions={margins:[5,5],
rowHeight:100,colWidth:260,columns:2,mobileModeEnabled:!1,swapping:!0,minRows:1,draggable:{enabled:!0},resizable:{enabled:!1}},this.items=[],this.dashboard.widgets&&this.dashboard.widgets.forEach(function(e,t){e.forEach(function(e,n){o.items.push({id:e.id,col:n,row:t,sizeY:1,sizeX:e.width,name:e.getName()})})}),this.saveDashboard=function(){if(o.saveInProgress=!0,o.dashboard.id){var l=[],u=(0,a.sortBy)(o.items,function(e){return 10*e.row+e.col});u.forEach(function(e){l[e.row]=l[e.row]||[],e.col>0&&void 0===l[e.row][e.col-1]?l[e.row][e.col-1]=e.id:l[e.row][e.col]=e.id});var c={slug:o.dashboard.id,name:o.dashboard.name,version:o.dashboard.version,layout:JSON.stringify(l)};s.save(c,function(t){o.dashboard=t,o.saveInProgress=!1,o.close({$value:o.dashboard}),e.$broadcast("reloadDashboards")},function(e){o.saveInProgress=!1,403===e.status?r.error("Unable to save dashboard: Permission denied."):409===e.status&&r.error("It seems like the dashboard has been modified by another user. Please copy/backup your changes and reload this page.",{autoDismiss:!1})}),i.record("edit","dashboard",o.dashboard.id)}else n.post("api/dashboards",{name:o.dashboard.name}).success(function(e){o.close(),t.path("/dashboard/"+e.slug).replace()}),i.record("create","dashboard")}}]}},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-click="$ctrl.dismiss()" ng-disabled="$ctrl.saveInProgress" aria-hidden="true">&times;</button>\n  <h4 class="modal-title">Edit: {{$ctrl.dashboard.name}}</h4>\n</div>\n<div class="modal-body">\n  <p>\n    <input type="text" class="form-control" placeholder="Dashboard Name" ng-model="$ctrl.dashboard.name">\n  </p>\n\n  <div gridster="$ctrl.gridsterOptions" ng-if="$ctrl.items | notEmpty">\n    <ul>\n      <li gridster-item="item" ng-repeat="item in $ctrl.items" class="widget panel panel-default gs-w">\n        <div class="heading">{{item.name}}</div>\n      </li>\n    </ul>\n  </div>\n</div>\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.dismiss()">Close</button>\n  <button type="button" class="btn btn-primary" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.saveDashboard()">Save</button>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(e,t){"ngInject";var n=t.current.params.token;return e.get("/api/dashboards/public/"+n).then(function(e){return e.data})}function n(e,t,n){var r=t.current.params.token;return n.setApiKey(r),n.loadConfig()}t.$inject=["$http","$route"],n.$inject=["$http","$route","Auth"],e.component("publicDashboardPage",l),e.config(["$routeProvider",function(e){e.when("/public/dashboards/:token",{template:'<public-dashboard-page dashboard="$resolve.dashboard"></public-dashboard-page>',reloadOnSearch:!1,resolve:{dashboard:t,session:n}})}])};var a=n(221),i=r(a),s=n(222),o=r(s),l={template:i.default,bindings:{dashboard:"<"},controller:["$routeParams","Widget",function(e,t){"ngInject";this.logoUrl=o.default,this.headless=e.embed,this.headless&&document.querySelector("body").classList.add("headless"),this.public=!0,this.dashboard.widgets=this.dashboard.widgets.map(function(e){return e.map(function(e){return new t(e)})})}]}},function(e,t){e.exports='<!-- simple nav bar -->\n<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation" ng-if="!$ctrl.headless">\n  <div class="container">\n    <div class="navbar-header">\n      <a class="navbar-brand" href="/" target="_self"><img ng-src="{{$ctrl.logoUrl}}"/></a>\n    </div>\n  </div>\n</nav>\n\n<div class="container">\n  <page-header title="{{$ctrl.dashboard.name}}">\n  </page-header>\n\n  <div class="m-b-5">\n    <filters ng-if="$ctrl.dashboard.dashboard_filters_enabled"></filters>\n  </div>\n\n    <div ng-repeat="row in $ctrl.dashboard.widgets" class="row">\n      <dashboard-widget ng-repeat="widget in row" widget="widget" dashboard="$ctrl.dashboard" public="true"></dashboard-widget>\n    </div>\n</div>\n'},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABl9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+NTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTAwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjEwMDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOkEzNjMxNjc5RUZGQTExRTRCODg4OThENzNBNThGM0VDPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOkEzNjMxNjdBRUZGQTExRTRCODg4OThENzNBNThGM0VDPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOkEzNjMxNjc3RUZGQTExRTRCODg4OThENzNBNThGM0VDPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOkEzNjMxNjc4RUZGQTExRTRCODg4OThENzNBNThGM0VDPC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8ZGM6c3ViamVjdD4KICAgICAgICAgICAgPHJkZjpTZXEvPgogICAgICAgICA8L2RjOnN1YmplY3Q+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE1OjA1OjEyIDEwOjA1OjU4PC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5QaXhlbG1hdG9yIDMuMy4yPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpLVWDGAAARGUlEQVR4Ae1dCYwcxRX91T3XXt7DYAsbYyfhEAEMOECCgCBEzJmgWML4CFeMYwjYHAkJNkhoOQIOuZB314mcBUUCedfaYCScgAIRCIIgCGESxBFuFtkGg70G2ztHX5X3e7bt2dnZmXYfc7Efeqenu7rq13/1f/3/q3pMNEETEpiQwIQEJiQwIYEJCdSFBESt9kLefFkTxeLNJGSCNDNGQlFIIZ2USIpMSlLDtD2is9Oqtf7VBCDytqtmQrCzyaITicQ3cX4YjqlEshXf4zhXcXBfTBw6jj04dpCkLaSIN3HrNTLlfymZeE90dWVwr2qpKgGR8+erdGQHhG9dQJY8h4Q4FoJtJSgBhIwDf5yjkGi5VwJ/nIPLGlYG2vQukfIsWebfKBF/XnSu3Vvo8UpeqypA5M3XTKG4eTFJcSkkfjJF1AgAAS6wPCxUP8TgKHwAVNOu7x0A9lfSrYfFfb1v+ak6yGerAhB52+XTSSSuxui/klRlhg2CydYnRGJgVByGuRdzz0Yy5BqxuveVEFt0VXVFAZGd1zaTZvwUw/9GaMM0e+SyNpSTWHMimIJMM41mH4JZu1fc3fthOVnIbatigMhfLp1LUWU1RukcCANmyadJyu2Vl/P9wGzHwLib3t/9RzEwELKajmW07IDIzmWNpMnbYb9/hiNqgzGWr8pdYVPGc40lN5Fp3ChWP/hBOZkpKyBy5VWHY1LthYk4E7bb/0QdpqSiEXYmPibduEb8+sEnwmwqt+6yASJvWXI6gHiYVHUmOpnLQ/We86QvKUPS+rm4p7enHIyixfBJrlpyEUUimxBN1w4YLJasexyHVnfLW5feGb6kstFtqO3IlT+ZR6p4CI002fFEqK2FVDlP+Co8MV3/tVj9wMqQWrGrDdVkYVTNhVY8gpZaahaMXOmze6ybtyNeuSv3cpDnoQECMGYDjKeQYZpiq36QXFeqLtYUISQ8w2XQlN4w2AgFELnquskkMk9DzWfb3lQYnFeqTnaJiYbhFp8v7u39V9BsBD6pI7wDx5k1mMTrDwyWPgewQmmCpjxg594CRiRwQGjVUuSj1MU149p6EShnFiLqERQ1f+vl8WLPBGqy7HULqbyE0TO1LibxYpLje4oi0c+LYbo2lirq9n6wGmLRXRg5Xw0wWMKC/xOrZeeVbW4FXqpcYIDI25adToq6qK5NVb40OXBk05WJLs+/5fV7ICZLdnYqlNnydzB3Xs15VfbiV6GUP0TDiUZ2dYuRnYikz1DuBHHPuk+KFXVzDxm0ACiz5TQwP7fmwDCRU2vtIJpUwOLwxL1zO5GGJXgFAeF4xF5XNDKFNG0ZitwxXjG310vA764auXJpP8UiC2rKXBkAY86pRBcuIGpuQUdZFM6aDM5Zc7Z+RNS/jmjo8+KgsCZZ1iDFjRNE51++cCe1wqV8zyFy5ZKvQ10vqCntkBB28ySiCy5BUoc3royYJvtz5JxzV4d9g+jMC7JJxsLyy15l8CLIYqci3y9WzM0934DAVM2jqNriexOCG26DKsMbJpqaiRpxlKLJB2fX3kuV4/uqWOymWLEyvgCxJ3NJ8yq+/Fqsh+PeAyhudrK4KcNtZFP1p8uV18wat0kXN3wBQsOfQKfFnHoOAt3iYYMbibSQMM5yIfdxi/gDJGqdBtvZ4GqkjctCHd1gv0DQ9/z0yB8gRGfYzokfDurpWdts0UnypvkNXrvlOQ6xt3tKeUKo8wfHAhwrFCJ7204UI5KHZZUQe2+SZlK05TBw9LYXrjwDQrOa4H6g8bA2tjEQ02cRHXUcAq9YXt8wIQ/tIHrtZazgIXBjd7UaiMOYiBKHCT8SZ2UGJBqbht0Y7aHMHwzGzCOIfnwjUUPj+KI+8ths4DZ+ifLf4SBRl2DeG3kfWqY5HbsOvT9fjF/Wum+dVhwMfv64k4imTINZg2mrKpKzvLLjWaC6ZU0Nz35jXojzax8liOePGJdjW1ElZLOC9SCP5BkQzdDbPbbp6jHpPgBwVV/5CmEPhGUWyFa648DzpG6aVhHj7q7x4EtheGYj5rFVszZxfqoMZJhmwmszngExTAsv08DWVwuxy8lp8ukzYMZYHnlmLImXpT7DckXYbjKPCdP0jLxnQBSSuj0aeYEmr+9lx4jNG4Mw/yqio48vrAm6RvTvZ4geHwiZXyyzm9Y4wVNpyXieQywhk7JavBsd73kefwrRsXMKg8Fy4FjmjHPhTh8+frBZWl6lS2DBSrfsl39Kly1QwjMgJJUh2EqEIpVWj5FedXCc6oJa4Yu4dhhc1JdbBMYC6sEauCv38oGcezZZgpRPNbzjoUQszJUHYDKz6YWxPLJt92HfJeYzlkdFCWNTwqkQQmCy8kbeAVHMrbpFhmqaeFcWgJRSFHYAWOC8UseTr1OepcgjNjmcTYPgxdtwyWk4+FbYVTf4RSRBH3mt3XPv1Ziy1UzLIdMwp0iY56Kjk8HgpdIfXko0C1mFMbknCIlzU5v6iD56x2tfKvscBKDjRSQNaR/FFJ474XkOaWk5akgK+lDYo6KEU8GT/9kXER2DSbcJGwoam/IOLKUeOoto3uWI0Au4rJUVtbvWMaZYO3TTSkpZAUDs3xGRtFmF26uxl1OMIlDEQ2YUK5G9135Q1qRVU3xTmmu7RNbBsc3yh61T9S0uHxtTzLOGZGuSz7FF1jEyEAyNqXz0BTe2202Z0bVWy7eMpiPzzjtL6SXROYCgxxv5AkSQ+mJaN/bw/JEGQ/6pNgHhwahjnxf7JggDnvIjB1+AtPWs/xgT9EsxuL3MEKvtV5HSmma/2p62zCFTiOf8yMAXINAMDAr5iJM9SWW0fd6sH6Zq6VkeiGyy4xyLSfnMwd392/zw7wsQbhg68VjasHZGYDxZQzSMljE+sK3LbswRIHYmdLcZAKc8B5xuyCnvtv4ivHPcwYOQyeRyJB+2v/j44xuQ7IiQG+MIDnkuYQbt4CiXKfjm+hv/yb1S8Nz44B2yvhhC4KiQ8Vbp8ubWQTK3Y0BGo2S8/Tqi5OIm09r9JRmD79t5LWvXDpy/V5CP3IvGm6/uHyS5N3CeymTgzFj4yRZs/jet/6W0tifzihzwV5ahb9q1YuGJgONFjNE4jxpe2W1ubOAUQrZuXBvGpK989zyKHj07mwAcpTBY1PlkC2n/eJSa9RSJSJRSyRRZJ59B8TnfySYG88pbOz+nzJOPUuPuXaTGYpROJslAnBM/9Sz80hN24Ywqj697vqT00/jdsm2DFE0kyIKrPpzArwSei9fop04Dnzmi4FOYIu2NzSSf/yc1JeJjZJTB88k0fhMNdxrh1id186b2nr77xxQ8wAs5XBzgk3nFh5Yv7AdjC1LsbeBeDEw2Nexfp2FbO7x7N3KSsLUOUPvqwBMY3Q0NDZTAwcSey16Ut7jsmMjeLoBV3hhiTASZIAsmaO+e3VgRQF2FlvqR9IuCp+YW3umepVQqRWkc2YWrPFFgEAmYt+ZJLXh/dXRCg03zXgwYJtYOLGcPKilzTusDA1BvfzS6JR914fXtexGl/kARotFCZzQAoEClG0bWxlkYLW1tI+Zs9PDlb6xVXMYhTli2tLbaE+aY4Y5CSl55BZ5F86RJtrdn+59ORSOfAqBGOeeWQzwAIjB3JgSfBwdKCQChjtnHYaFsMsU/rZWlCPgwyfpNEGBwjWP5GGnIy8fO5Yvub4mqNwzn/LhMAqOYj30mxG6xQLMAsSCFXZ4bHaOxfBH85LHEA20YmmGMAMieVcY0N6e04TOmrduU5Kf8ku9JPZeBmDB+ldSND1mNHUpjks+wJ+JgwJ1k4ecfzgP5n2GX5/byebG/j2aE2WDNcMDg+REA6YjNfxEUGNzifsmNbt/Tt5augc9R4Y14GPHR/iqSACSVzrqH+6/W1lkqnbbNp9OtBpgzzB3dbd19TwfZk0ABYcYmdfc/lrHMbvY8HOJOcDQ7jBHmfnuP83TlP20thxl2BlkCYMB5ebnNMm8PmrvAAWEGO7TWWzGPPJsPioZOsXfCvvs+ExZ0jwKuj91bHkyOZox4VTssXS4RawcC/93fUAAR69Yl4d9ekTGN9+yUwoiQeISxR8Og2PNKwMILujp21VOINRxSbRWRGUPSko4/bXjduR7kZyiAMIPtPesHETdfgknw0xj/VF4OIf+FoEqjPeyxlIiucx4r6ynzxYGfQ4wFPGtpSLmio6tvk3M96M/Rkgq49vau/lcNaV6MWG17PA8UW1tGAqwkJszS6ykBM1ekOjvWAE/OfMfmynZxLXlnW1f/n4s86vuWYxp9V1Ssgi+vW/htBH4bVFXMTPMmgDxil5IZ4cAwjkCNAzL7At8oMzEI9jwH0+oQz4Up0+xtXdO3DAMpVK5C1RCnQ609/S+lZeY8w5KvNPLPr+aRMyo4ut+LVMYe5KXYs+H5ptzE2optsvuaZX7hUT3RGjGuDxsMbtSRxT4GwjzZtmzRQU0x6opFlIVIs4ykrAu3yLEZmzVOqUQQEXMqRYXZQ2oG10fYtj/whwsHQDxnsFc1Ujuxe5sxEIkL87xDEGMF0ETJKpy2SxYMqgDLedeKBddFSb0zqor2VAETlt+WAw5ftwEBSA4w3AHOUeUnAPPrKPWdNTKV496yI4JE5WBaiLlT1qx/t9TzQd0vOyAO40PLf3ScStbqiIqf5QBpOWbCKVPs09YJ/JFYmGpAerwBKXVPmgIJaFgayPWoeLMCxs0XmmFdOHlt/wvF+Aj6XsUA4Y5g5IvdNyxeoEi5Kqoqs3nV7YCBwTOcvPQKSDaVztnbrNljzUO8oenSXNTetWFj0AIvVV9ZJvXxmEDfZeua9f0p0zhNk3Ip3ONXOBLmPBELJmzijAGncxwwuEVeisbu9ZsrAQb3N/xecysu6d0V58enUhv/E0eXwRSdDd8fP2aFfV/wtnjhKTuGR1fGbqoXDeFUOru3HHM41AD3Nmno93V0b7jFuVbuz6oCJLfzO69dOCOq0tnYlnkurp+Cf2jlMACEAQy1gjDZvOF/pMCxph2LAhT3c4gda3AqHYGpIwB2b5F/W9++3by8Ev9uiNN3hx/ne1V+ymvnNydV9QhD0LEA4Rg4vl+zSB6K35huh+I0JuLRgzCHNLmd1NlMcczjdJ5NZNq0nsFG6YumhJAwPBChOjwdyDNVU1auWBHf0TAYa6fJv1cT8aVYsCjJG+8U4V2WTscTiG90ab2eseS5fvdUlWzcRQGHLxdFq7eIccuSbjUeu64oIOhpJqPbW3ecnrADAfO1TbPonMk9fW841yv5WVEvK7COw30uVZemIZUO7XCIYw3MQnsNU1xaLWAwb/UBiCPlcT558uYlWIfsKJ+EqVvy6va1659xrlfDZ90Dwm6tvXQ8Im1WJTZVmiVv7ejuX18NIOTyUNeA2Nt24FHxp0Mca2Als6uju+8+51o1fdYtIAyBnUqHhjgTzEgqfeO27dbN1QRCLi91C4i9bUffH/jZsYZhvCAjiauOGfD+hlOu8MI4H7taFEYrZa4zf9sOL78iafmuZSmL27v8/fJ02F2pO0AKbdsxpLUDk/vC9p4Ng2EL1G/99WOyOEtbcNsOVmAt6/K2ng2b/QqrHM/XDyBYecxdZOIkJMd+2Ax9PbK3T5RDmEG0UReADCMCN7A5grO4TOxVJbAEi8Dvjsk9G3rtizXypy4AMfHKXH6sgUWv3rauvjtrBId9bNYFIPt6gxOONbD36/G9EQvbdpCgrzGqK0DsXem6sVnE6YoZfxjIvnM2AUhlJGDnp0xrUFiRBZN+14efFqpNqgsNwQpiXLPMYcMyFrWufbj0u85VjFVdAAL36s2kZiyd3DPwYhXLeoK1CQlMSGBCAhMSmJBAqBL4P3iH6XSOsIpGAAAAAElFTkSuQmCC"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){var t=a({},(0,s.default)(e),(0,l.default)(e));return t};var i=n(224),s=r(i),o=n(226),l=r(o)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r){var a=this;n.record("view","page","query_snippets"),this.snippets=new i.Paginator([],{itemsPerPage:20}),r.query(function(e){a.snippets.updateRows(e)})}a.$inject=["$location","currentUser","Events","QuerySnippet"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("snippetsListPage",{template:o.default,controller:a}),{"/query_snippets":{template:"<snippets-list-page></snippets-list-page>",title:"Query Snippets"}}};var i=n(188),s=n(225),o=r(s)},function(e,t){e.exports='<settings-screen>\n    <div class="row voffset1">\n        <div class="col-md-12">\n          <p>\n            <a href="query_snippets/new" class="btn btn-default"><i class="fa fa-plus"></i> New Snippet</a>\n          </p>\n\n          <table class="table table-condensed table-hover">\n            <thead>\n              <tr>\n                <th>Trigger</th>\n                <th>Description</th>\n                <th>Snippet</th>\n                <th>Created By</th>\n                <th>Updated At</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="row in $ctrl.snippets.getPageRows()">\n                <td>\n                  <a href="query_snippets/{{row.id}}">{{row.trigger}}</a>\n                </td>\n                <td>\n                  {{row.description}}\n                </td>\n                <td>\n                  {{row.snippet}}\n                </td>\n                <td>\n                  {{row.user.name}}\n                </td>\n                <td>\n                  <span am-time-ago="row.created_at"></span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <paginator paginator="$ctrl.snippets"></paginator>\n        </div>\n    </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i,s){var o=this;this.snippetId=e.snippetId,i.record("view","query_snippet",this.snippetId),this.editorOptions={mode:"snippets",advanced:{behavioursEnabled:!0,enableSnippets:!1,autoScrollEditorIntoView:!0},onLoad:function(e){e.$blockScrolling=1/0,e.getSession().setUseWrapMode(!0),e.setShowPrintMargin(!1)}},this.saveChanges=function(){o.snippet.$save(function(e){r.success("Saved."),"new"===o.snippetId&&n.path("/query_snippets/"+e.id).replace()},function(){r.error("Failed saving snippet.")})},this.delete=function(){o.snippet.$delete(function(){n.path("/query_snippets"),r.sucess("Query snippet deleted.")},function(){r.error("Failed deleting query snippet.")})},"new"===this.snippetId?(this.snippet=new s({description:""}),this.canEdit=!0):this.snippet=s.get({id:this.snippetId},function(e){o.canEdit=a.canEdit(e)})}a.$inject=["$routeParams","$http","$location","toastr","currentUser","Events","QuerySnippet"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("snippetPage",{template:s.default,controller:a}),{"/query_snippets/:snippetId":{template:"<snippet-page></snippet-page>",title:"Query Snippets"}}},n(227);var i=n(228),s=r(i)},,function(e,t){e.exports='<settings-screen>\n  <div class="">\n    <form name="snippetForm" class="form">\n      <div class="form-group">\n        <label>Trigger</label>\n        <input type="string" class="form-control" ng-model="$ctrl.snippet.trigger" ng-disabled="!$ctrl.canEdit" required>\n      </div>\n\n      <div class="form-group">\n        <label>Description</label>\n        <input type="string" class="form-control" ng-model="$ctrl.snippet.description" ng-disabled="!$ctrl.canEdit">\n      </div>\n\n      <div class="form-group">\n        <label>Snippet</label>\n        <pre ng-if="!$ctrl.canEdit">{{$ctrl.snippet.snippet}}</pre>\n        <div ui-ace="$ctrl.editorOptions" ng-model="$ctrl.snippet.snippet" style="height:300px" ng-if="$ctrl.canEdit"></div>\n      </div>\n\n      <div class="form-group" ng-if="$ctrl.canEdit">\n        <button class="btn btn-primary" ng-disabled="!snippetForm.$valid" ng-click="$ctrl.saveChanges()">Save</button>\n        <button class="btn btn-danger" ng-if="$ctrl.snippet.id" ng-click="$ctrl.delete()">Delete</button>\n      </div>\n      <small ng-if="$ctrl.snippet.user">\n        Created by: {{$ctrl.snippet.user.name}}\n      </small>\n    </form>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){var t=a({},(0,s.default)(e),(0,c.default)(e),(0,l.default)(e));return t};var i=n(230),s=r(i),o=n(232),l=r(o),u=n(234),c=r(u)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){var r=this;t.record("view","page","users"),this.currentUser=e,this.users=new i.Paginator([],{itemsPerPage:20}),n.query(function(e){r.users.updateRows(e)})}a.$inject=["currentUser","Events","User"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("usersListPage",{controller:a,template:o.default}),{"/users":{template:"<users-list-page></users-list-page>",title:"Users"}}};var i=n(188),s=n(231),o=r(s)},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-12">\n      <p ng-if="$ctrl.currentUser.hasPermission(\'admin\')">\n        <a href="users/new" class="btn btn-default"><i class="fa fa-plus"></i> New User</a>\n      </p>\n\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Joined</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="row in $ctrl.users.getPageRows()">\n            <td>\n              <img ng-src="{{row.gravatar_url}}" height="40px"/> <a href="users/{{row.id}}">{{row.name}}</a>\n            </td>\n            <td>\n              <span am-time-ago="row.created_at"></span>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.users"></paginator>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,s,o,l,u){e.userId=t.userId,e.currentUser=o,e.clientConfig=s,"me"===e.userId&&(e.userId=o.id),l.record("view","user",e.userId),e.canEdit=o.hasPermission("admin")||o.id===parseInt(e.userId,10),e.showSettings=!1,e.showPasswordSettings=!1,e.selectTab=function(t){e.selectedTab=t,(0,i.each)(e.tabs,function(n,r){e.tabs[r]=r===t})},e.setTab=function(t){e.selectedTab=t,r.hash(t)},e.tabs={profile:!1,apiKey:!1,settings:!1,password:!1},e.selectTab(r.hash()||"profile"),e.user=u.get({id:e.userId},function(t){"password"===t.auth_type&&(e.showSettings=e.canEdit,e.showPasswordSettings=e.canEdit)}),e.password={current:"",new:"",newRepeat:""},e.savePassword=function(t){if(t.$valid){var n={id:e.user.id,password:e.password.new,old_password:e.password.current};u.save(n,function(){a.success("Password Saved."),e.password={current:"",new:"",newRepeat:""}},function(e){var t=e.data.message||"Failed saving password.";a.error(t)})}},e.updateUser=function(t){if(t.$valid){var n={id:e.user.id,name:e.user.name,email:e.user.email};u.save(n,function(t){a.success("Saved."),e.user=t},function(e){var t=e.data.message||"Failed saving.";a.error(t)})}},e.sendPasswordReset=function(){e.disablePasswordResetButton=!0,n.post("api/users/"+e.user.id+"/reset_password").success(function(t){e.disablePasswordResetButton=!1,e.passwordResetLink=t.reset_link})}}a.$inject=["$scope","$routeParams","$http","$location","toastr","clientConfig","currentUser","Events","User"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("UserCtrl",a),{"/users/:userId":{template:o.default,reloadOnSearch:!1,controller:"UserCtrl",title:"Users"}}};var i=n(155),s=n(233),o=r(s)},function(e,t){e.exports='<settings-screen>\n  <email-settings-warning function="\'invite emails\'"></email-settings-warning>\n\n  <h3 class="p-l-5">{{user.name}}</h3>\n\n  <ul class="tab-nav">\n    <rd-tab tab-id="profile" name="Profile" ng-click="selectTab(\'profile\')"></rd-tab>\n    <rd-tab tab-id="apiKey" name="API Key" ng-click="selectTab(\'apiKey\')" ng-if="user.api_key"></rd-tab>\n    <rd-tab tab-id="settings" name="Settings" ng-click="selectTab(\'settings\')" ng-if="showSettings"></rd-tab>\n    <rd-tab tab-id="password" name="Password" ng-click="selectTab(\'password\')" ng-if="showPasswordSettings"></rd-tab>\n  </ul>\n\n  <div ng-show="selectedTab == \'profile\'" class="p-10">\n    <p>\n      <img ng-src="{{user.gravatar_url}}"/>\n    </p>\n\n    <p>\n      <strong>{{user.name}}</strong>\n    </p>\n\n    <p>\n      {{user.email}}\n    </p>\n    <div ng-if="currentUser.isAdmin">\n      <hr/>\n      <div class="form-group">\n        <button class="btn btn-default" ng-click="sendPasswordReset()" ng-disabled="disablePasswordResetButton">Send\n          Password Reset Email\n        </button>\n      </div>\n\n      <div ng-if="passwordResetLink" class="alert alert-success">\n        <p ng-if="!clientConfig.mailSettingMissing">\n          <strong>The user should receive a link to reset his password by email soon.</strong>\n        </p>\n        <p ng-if="clientConfig.mailSettingsMissing">\n          You don\'t have mail server configured, please send the following link\n          to {{user.name}} to reset their password:<br/>\n          <a ng-href="passwordResetLink">{{passwordResetLink}}</a>\n        </p>\n      </div>\n    </div>\n  </div>\n  <div ng-show="selectedTab == \'apiKey\'" class="p-10">\n    API Key:\n    <input type="text" value="{{user.api_key}}" size="44" readonly/>\n  </div>\n  <div ng-show="selectedTab == \'settings\'" class="p-10">\n    <div class="col-md-6">\n      <form class="form" name="userSettingsForm" ng-submit="updateUser(userSettingsForm)" novalidate>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userSettingsForm.name | showError:userSettingsForm )}">\n          <label class="control-label">Name</label>\n          <input name="name" type="text" class="form-control" ng-model="user.name" required/>\n          <error-messages input="userSettingsForm.name" form="userSettingsForm"></error-messages>\n        </div>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userSettingsForm.email | showError:userSettingsForm )}">\n          <label class="control-label">Email</label>\n          <input name="email" type="email" class="form-control" ng-model="user.email" required/>\n          <error-messages input="userSettingsForm.email" form="userSettingsForm"></error-messages>\n        </div>\n        <div class="form-group">\n          <button class="btn btn-primary">Save</button>\n        </div>\n      </form>\n    </div>\n  </div>\n  <div ng-show="selectedTab == \'password\'" class="p-10">\n    <div class="col-md-6">\n      <form class="form" name="userPasswordForm" ng-submit="savePassword(userPasswordForm)" novalidate>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userPasswordForm.currentPassword | showError:userPasswordForm )}">\n          <label class="control-label">Current Password</label>\n          <input name="currentPassword" class="form-control" type="password" ng-model="password.current" required/>\n          <error-messages input="userPasswordForm.currentPassword" form="userPasswordForm"></error-messages>\n        </div>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userPasswordForm.newPassword | showError:userPasswordForm )}">\n          <label class="control-label">New Password</label>\n          <input name="newPassword" class="form-control" type="password" ng-model="password.new" ng-minlength="6"\n                 required/>\n          <error-messages input="userPasswordForm.newPassword" form="userPasswordForm"></error-messages>\n        </div>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userPasswordForm.passwordRepeat | showError:userPasswordForm )}">\n          <label class="control-label">Repeat New Password</label>\n          <input name="passwordRepeat" class="form-control" type="password" ng-model="password.newRepeat"\n                 compare-to="password.new"/>\n          <span class="help-block error"\n                ng-if="userPasswordForm.passwordRepeat.$error.compareTo">Passwords don\'t match.</span>\n        </div>\n        <div class="form-group">\n          <button class="btn btn-primary">Save</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i){var s=this;a.record("view","page","users/new"),e.user=new i({}),e.saveUser=function(){s.userForm.$valid&&e.user.$save(function(t){e.user=t,e.user.created=!0,n.success("Saved.")},function(e){var t=e.data.message||"Failed saving.";n.error(t)})}}a.$inject=["$scope","$location","toastr","currentUser","Events","User"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("NewUserCtrl",a),{"/users/new":{template:s.default,controller:"NewUserCtrl",controllerAs:"$ctrl",bindToController:"true"}}};var i=n(235),s=r(i)},function(e,t){e.exports='<settings-screen>\n  <email-settings-warning function="\'invite emails\'"></email-settings-warning>\n  <form class="form" name="$ctrl.userForm" ng-submit="saveUser()" novalidate>\n    <div class="form-group required" ng-class="{ \'has-error\':  ($ctrl.userForm.email | showError:$ctrl.userForm )}">\n      <label class="control-label">Name</label>\n      <input type="text" name="name" class="form-control" ng-model="user.name" ng-disabled="user.created" required/>\n\n      <error-messages input="$ctrl.userForm.name" form="$ctrl.userForm"></error-messages>\n    </div>\n\n    <div class="form-group required" ng-class="{ \'has-error\': ($ctrl.userForm.email | showError:$ctrl.userForm ) }">\n      <label class="control-label">Email</label>\n      <input name="email" type="email" class="form-control" ng-model="user.email" ng-disabled="user.created" required/>\n\n      <error-messages input="$ctrl.userForm.email" form="$ctrl.userForm"></error-messages>\n    </div>\n\n    <div class="form-group" ng-if="!user.created">\n      <button class="btn btn-primary">Create</button>\n    </div>\n\n\n    <div ng-if="user.created" class="alert alert-success">\n      <p>\n        <strong>The user has been created and should receive an invite email soon.</strong>\n      </p>\n      <p>\n        You can use the following link to invite them yourself:<br/>\n        {{user.invite_link}}\n      </p>\n    </div>\n  </form>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){return(0,p.default)(e),(0,g.default)(e),a({},(0,s.default)(e),(0,l.default)(e),(0,c.default)(e))};var i=n(237),s=r(i),o=n(239),l=r(o),u=n(241),c=r(u),d=n(243),p=r(d),f=n(245),g=r(f)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a){r.record("view","page","groups"),e.currentUser=n,e.groups=new i.Paginator([],{itemsPerPage:20}),a.query(function(t){e.groups.updateRows(t)}),e.newGroup=function(){t.open({component:"editGroupDialog",size:"sm",resolve:{group:function(){return new a({})}}})}}a.$inject=["$scope","$uibModal","currentUser","Events","Group"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("GroupsCtrl",a),{"/groups":{template:o.default,controller:"GroupsCtrl",title:"Groups"}}};var i=n(188),s=n(238),o=r(s)},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-12">\n      <p ng-if="currentUser.hasPermission(\'admin\')">\n        <a ng-click="newGroup()" class="btn btn-default"><i class="fa fa-plus"></i> New Group</a>\n      </p>\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Name</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="row in groups.getPageRows()">\n            <td>\n              <a href="groups/{{row.id}}">{{row.name}}</a>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <paginator paginator="groups"></paginator>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,s,o){a.record("view","group",e.groupId),e.currentUser=r,e.group=s.get({id:t.groupId}),e.members=s.members({id:t.groupId}),e.newMember={},e.findUser=function(t){""!==t&&void 0===e.foundUsers&&o.query(function(t){var n=e.members.map(function(e){return e.id});t.forEach(function(e){e.alreadyMember=(0,i.contains)(n,e.id)}),e.foundUsers=t})},e.addMember=function(r){e.newMember.selected=void 0,n.post("api/groups/"+t.groupId+"/members",{user_id:r.id}).success(function(){e.members.unshift(r),r.alreadyMember=!0})},e.removeMember=function(r){n.delete("api/groups/"+t.groupId+"/members/"+r.id).success(function(){e.members=e.members.filter(function(e){return e!==r}),e.foundUsers&&e.foundUsers.forEach(function(e){e.id===r.id&&(e.alreadyMember=!1)})})}}a.$inject=["$scope","$routeParams","$http","currentUser","Events","Group","User"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("GroupCtrl",a),{"/groups/:groupId":{template:o.default,controller:"GroupCtrl"}}};var i=n(155),s=n(240),o=r(s)},function(e,t){e.exports='<settings-screen>\n  <group-name group="group"></group-name>\n\n  <div class="row">\n    <div class="col-lg-4">\n      <ul class="tab-nav">\n        <li role="presentation" class="active"><a href="groups/{{group.id}}">Members</a></li>\n        <li role="presentation" ng-if="currentUser.isAdmin"><a href="groups/{{group.id}}/data_sources">Data Sources</a></li>\n      </ul>\n    </div>\n\n    <div class="col-lg-8" ng-if="currentUser.isAdmin">\n      <ui-select ng-model="newMember.selected" on-select="addMember($item)">\n        <ui-select-match placeholder="Add New Member"></ui-select-match>\n        <ui-select-choices repeat="user in foundUsers | filter:$select.search"\n                           refresh="findUser($select.search)"\n                           refresh-delay="0"\n                           ui-disable-choice="user.alreadyMember">\n          <div>\n            <img ng-src="{{user.gravatar_url}}" height="24px">&nbsp;{{user.name}}\n            <small ng-if="user.alreadyMember">(already member in this group)</small>\n          </div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n  <div class="row voffset1">\n    <div class="col-lg-12">\n      <table class="table table-condensed table-hover" ng-show="members">\n        <tbody>\n        <tr ng-repeat="member in members">\n          <td width="50px"><img ng-src="{{member.gravatar_url}}" height="40px"/></td>\n          <td>{{member.name}} <button class="pull-right btn btn-sm btn-danger" ng-click="removeMember(member)" ng-if="currentUser.isAdmin">Remove</button></td>\n        </tr>\n        </tbody>\n      </table>\n\n      <div ng-hide="members.length">\n        No members.\n      </div>\n    </div>\n  </div>\n</settings-screen>\n';
},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,s){r.record("view","group_data_sources",e.groupId),e.group=a.get({id:t.groupId}),e.dataSources=a.dataSources({id:t.groupId}),e.newDataSource={},e.findDataSource=function(){void 0===e.foundDataSources&&s.query(function(t){var n=e.dataSources.map(function(e){return e.id});e.foundDataSources=t.filter(function(e){return!(0,i.contains)(n,e.id)})})},e.addDataSource=function(r){e.newDataSource.selected=void 0,n.post("api/groups/"+t.groupId+"/data_sources",{data_source_id:r.id}).success(function(){r.view_only=!1,e.dataSources.unshift(r),e.foundDataSources&&(e.foundDataSources=e.foundDataSources.filter(function(e){return e!==r}))})},e.changePermission=function(e,r){n.post("api/groups/"+t.groupId+"/data_sources/"+e.id,{view_only:r}).success(function(){e.view_only=r})},e.removeDataSource=function(r){n.delete("api/groups/"+t.groupId+"/data_sources/"+r.id).success(function(){e.dataSources=e.dataSources.filter(function(e){return r!==e})})}}a.$inject=["$scope","$routeParams","$http","Events","Group","DataSource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("GroupDataSourcesCtrl",a),{"/groups/:groupId/data_sources":{template:o.default,controller:"GroupDataSourcesCtrl"}}};var i=n(155),s=n(242),o=r(s)},function(e,t){e.exports='<settings-screen>\n  <group-name group="group"></group-name>\n\n  <div class="row">\n    <div class="col-lg-4">\n      <ul class="tab-nav">\n        <li role="presentation"><a href="groups/{{group.id}}">Members</a></li>\n        <li role="presentation" class="active"><a href="groups/{{group.id}}/data_sources">Data Sources</a></li>\n      </ul>\n    </div>\n    <div class="col-lg-8">\n      <ui-select ng-model="newDataSource.selected" on-select="addDataSource($item)">\n        <ui-select-match placeholder="Add Data Source"></ui-select-match>\n        <ui-select-choices repeat="dataSource in foundDataSources | filter:$select.search"\n                           refresh="findDataSource($select.search)"\n                           refresh-delay="0">\n          <div>\n            {{dataSource.name}}\n          </div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n  <div class="row voffset1">\n    <div class="col-lg-12">\n      <table class="table table-condensed table-hover">\n        <thead>\n        </thead>\n        <tbody>\n        <tr ng-repeat="dataSource in dataSources">\n          <td> {{dataSource.name}}</td>\n          <td width="280px" class="text-right">\n            <div class="btn-group" uib-dropdown>\n              <button type="button" class="btn btn-sm btn-default dropdown-toggle" uib-dropdown-toggle ng-if="dataSource.view_only">\n                View Only <span class="caret"></span>\n              </button>\n\n              <button type="button" class="btn btn-sm btn-success dropdown-toggle" uib-dropdown-toggle ng-if="!dataSource.view_only">\n                Full Access <span class="caret"></span>\n              </button>\n\n              <ul class="dropdown-menu" role="menu" uib-dropdown-menu>\n                <li><a ng-click="changePermission(dataSource, false)"><small ng-if="!dataSource.view_only"><span class="fa fa-check"/></small> Full Access<br/></a></li>\n                <li><a ng-click="changePermission(dataSource, true)"><small ng-if="dataSource.view_only"><span class="fa fa-check"/></small> View Only</a></li>\n              </ul>\n            </div>\n\n            <button class="pull-right btn btn-sm btn-danger" ng-click="removeDataSource(dataSource)">Remove</button>\n          </td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("editGroupDialog",s)};var a=n(244),i=r(a),s={template:i.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$location",function(e){"ngInject";var t=this;this.group=this.resolve.group;var n=void 0===this.group.id;n?(this.saveButtonText="Create",this.title="Create a New Group"):(this.saveButtonText="Save",this.title="Edit Group"),this.ok=function(){t.group.$save(function(r){n?(e.path("/groups/"+r.id).replace(),t.close()):t.close()})}}]}},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title">{{$ctrl.title}}</h3>\n</div>\n<div class="modal-body">\n    <form class="form">\n        <input type="text" ng-model="$ctrl.group.name" placeholder="Group Name" class="form-control"/>\n    </form>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-default" ng-click="$ctrl.close()">Cancel</button>\n    <button class="btn btn-primary" ng-click="$ctrl.ok()">{{$ctrl.saveButtonText}}</button>\n</div>\n'},function(e,t){"use strict";function n(e,t,n,r){var a=this;this.canEdit=function(){return r.isAdmin&&"builtin"!==a.group.type},this.saveName=function(){a.group.$save()},this.deleteGroup=function(){e.confirm("Are you sure you want to delete this group?")&&a.group.$delete(function(){t.path("/groups").replace(),n.success("Group deleted successfully.")})}}n.$inject=["$window","$location","toastr","currentUser"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("groupName",{bindings:{group:"<"},transclude:!0,template:'\n      <h2 class="p-l-5">\n        <edit-in-place editable="$ctrl.canEdit()" done="$ctrl.saveName" ignore-blanks=\'true\' value="$ctrl.group.name"></edit-in-place>&nbsp;\n        <button class="btn btn-xs btn-danger" ng-if="$ctrl.canEdit()" ng-click="$ctrl.deleteGroup()">Delete this group</button>\n      </h2>\n    ',replace:!0,controller:n})}},[628,247,249],function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i){a.record("view","page","admin/destinations"),e.destinations=i.query()}a.$inject=["$scope","$location","toastr","currentUser","Events","Destination"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("DestinationsCtrl",a),{"/destinations":{template:s.default,controller:"DestinationsCtrl",title:"Destinations"}}};var i=n(248),s=r(i)},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-4">\n      <p>\n        <a href="destinations/new" class="btn btn-default"><i class="fa fa-plus"></i> New Alert Destination</a>\n      </p>\n      <div class="list-group">\n        <a ng-href="destinations/{{destination.id}}" class="list-group-item" ng-repeat="destination in destinations"><i class="fa {{destination.icon}}"></i> {{destination.name}}</a>\n      </div>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i,s,o){s.record("view","page","admin/destination"),e.destinationId=t.destinationId,"new"===e.destinationId?e.destination=new o({options:{}}):e.destination=o.get({id:t.destinationId}),e.$watch("destination.id",function(t){t!==e.destinationId&&void 0!==t&&r.path("/destinations/"+t).replace()}),e.delete=function(){s.record("delete","destination",e.destination.id),e.destination.$delete(function(){a.success("Destination deleted successfully."),r.path("/destinations/")},function(e){u("Failed to delete destination: ",e.status,e.statusText,e.data),a.error("Failed to delete destination.")})}}a.$inject=["$scope","$routeParams","$http","$location","toastr","currentUser","Events","Destination"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("DestinationCtrl",a),{"/destinations/:destinationId":{template:l.default,controller:"DestinationCtrl",title:"Destinations"}}};var i=n(19),s=r(i),o=n(250),l=r(o),u=(0,s.default)("redash:http")},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-6">\n      <dynamic-form target="destination" type="destinations">\n        <button class="btn btn-danger" ng-if="destination.id" ng-click="delete()">Delete</button>\n      </dynamic-form>\n    </div>\n  </div>\n</settings-screen>\n'},[628,252,254],function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a){r.record("view","page","admin/data_sources"),e.dataSources=a.query()}a.$inject=["$scope","$location","currentUser","Events","DataSource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("DataSourcesCtrl",a),{"/data_sources":{template:s.default,controller:"DataSourcesCtrl",title:"Data Sources"}}};var i=n(253),s=r(i)},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-4">\n      <p>\n        <a href="data_sources/new" class="btn btn-default"><i class="fa fa-plus"></i> New Data Source</a>\n      </p>\n      <div class="list-group">\n        <a ng-href="data_sources/{{dataSource.id}}" class="list-group-item" ng-repeat="dataSource in dataSources"><i class="fa fa-database"></i> {{dataSource.name}}</a>\n      </div>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i,s,o){function l(){s.record("delete","datasource",e.dataSource.id),e.dataSource.$delete(function(){a.success("Data source deleted successfully."),r.path("/data_sources/")},function(e){u("Failed to delete data source: ",e.status,e.statusText,e.data),a.error("Failed to delete data source.")})}function c(t){s.record("test","datasource",e.dataSource.id),o.test({id:e.dataSource.id},function(e){e.ok?a.success("Success"):a.error(e.message,"Connection Test Failed:",{timeOut:1e4}),t()},function(e){u("Failed to test data source: ",e.status,e.statusText,e),a.error("Unknown error occurred while performing connection test. Please try again later.","Connection Test Failed:",{timeOut:1e4}),t()})}s.record("view","page","admin/data_source"),e.dataSourceId=t.dataSourceId,"new"===e.dataSourceId?e.dataSource=new o({options:{}}):e.dataSource=o.get({id:t.dataSourceId}),e.$watch("dataSource.id",function(t){t!==e.dataSourceId&&void 0!==t&&r.path("/data_sources/"+t).replace()}),e.actions=[{name:"Delete",class:"btn-danger",callback:l},{name:"Test Connection",class:"btn-default",callback:c,disableWhenDirty:!0}]}a.$inject=["$scope","$routeParams","$http","$location","toastr","currentUser","Events","DataSource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("DataSourceCtrl",a),{"/data_sources/:dataSourceId":{template:l.default,controller:"DataSourceCtrl",title:"Datasources"}}};var i=n(19),s=r(i),o=n(255),l=r(o),u=(0,s.default)("redash:http")},function(e,t){e.exports='<settings-screen>\n  <div class="row">\n    <div class="col-md-8">\n      <dynamic-form target="dataSource" type="data_sources" actions="actions">\n      </dynamic-form>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){return(0,c.default)(e),(0,p.default)(e),(0,g.default)(e),(0,m.default)(e),(0,b.default)(e),(0,w.default)(e),(0,$.default)(e),a({},(0,x.default)(e),(0,s.default)(e),(0,l.default)(e))};var i=n(257),s=r(i),o=n(259),l=r(o),u=n(260),c=r(u),d=n(261),p=r(d),f=n(267),g=r(f),h=n(269),m=r(h),v=n(271),b=r(v),y=n(273),w=r(y),_=n(274),x=r(_),q=n(276),$=r(q)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i,s,o,l,u,c,d){n("QueryViewCtrl",{$scope:r});var p="table";e.record("view_source","query",r.query.id);var f=!r.query.id,g=r.query.query,h=r.saveQuery;r.sourceMode=!0,r.canEdit=l.canEdit(r.query)||r.query.can_edit,r.isDirty=!1,r.base_url=a.protocol()+"://"+a.host()+":"+a.port(),r.newVisualization=void 0,Object.defineProperty(r,"showDataset",{get:function(){return r.queryResult&&"done"===r.queryResult.getStatus()}});var m={"mod+s":function(){r.canEdit&&r.saveQuery()}};d.bind(m),r.$on("$destroy",function(){d.unbind(m)}),r.saveQuery=function(e,t){var n=h(e,t);return n.then(function(e){g=e.query,r.isDirty=r.query.query!==g,r.query.version=e.version,f&&a.path(e.getSourceLink())}),n},r.formatQuery=function(){u.format(r.dataSource.syntax,r.query.query).then(function(e){r.query.query=e}).catch(function(e){return t.error(e)})},r.duplicateQuery=function(){e.record("fork","query",r.query.id),u.fork({id:r.query.id},function(e){a.url(e.getSourceLink()).replace()})},r.deleteVisualization=function(n,i){n.preventDefault();var s=void 0,l="Are you sure you want to delete "+i.name+" ?",u={class:"btn-danger",title:"Delete"};o.open(s,l,u).then(function(){e.record("delete","visualization",i.id),c.delete({id:i.id},function(){r.selectedTab===String(i.id)&&(r.selectedTab=p,a.hash(r.selectedTab)),r.query.visualizations=r.query.visualizations.filter(function(e){return i.id!==e.id})},function(){t.error("Error deleting visualization. Maybe it's used in a dashboard?")})})},r.$watch("query.query",function(e){r.isDirty=e!==g})}a.$inject=["Events","toastr","$controller","$scope","$location","$http","$q","AlertDialog","currentUser","Query","Visualization","KeyboardShortcuts"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.controller("QuerySourceCtrl",a),{"/queries/new":{template:s.default,controller:"QuerySourceCtrl",reloadOnSearch:!1,resolve:{query:["Query",function(e){"ngInject";return e.newQuery()}],dataSources:["DataSource",function(e){"ngInject";return e.query().$promise}]}},"/queries/:queryId/source":{template:s.default,controller:"QuerySourceCtrl",reloadOnSearch:!1,resolve:{query:["Query","$route",function(e,t){"ngInject";return e.get({id:t.current.params.queryId}).$promise}]}}}};var i=n(258),s=r(i)},function(e,t){e.exports='<div class="container">\n  <overlay ng-if="canCreateQuery === false && query.isNew()">\n    You don\'t have permission to create new queries on any of the data sources available to you. You can either <a\n    href="queries">browse existing queries</a>, or ask for additional permissions from your Redash admin.\n  </overlay>\n  <overlay ng-if="noDataSources && currentUser.isAdmin">\n    Looks like no data sources were created yet (or none of them available to the group(s) you\'re member of). Please\n    create one first, and then start querying.\n    <br/>\n    <a href="data_sources/new" class="btn btn-primary">Create Data Source</a> <a href="groups" class="btn btn-default">Manage\n    Group Permissions</a>\n  </overlay>\n  <overlay ng-if="noDataSources && !currentUser.isAdmin">\n    Looks like no data sources were created yet (or none of them available to the group(s) you\'re member of). Please ask\n    your Redash admin to create one first.\n  </overlay>\n\n  <alert-unsaved-changes ng-if="canEdit" is-dirty="isDirty"></alert-unsaved-changes>\n\n  <div class="row bg-white p-10 m-b-10">\n    <div class="col-sm-9">\n      <h3>\n        <edit-in-place editable="canEdit" done="saveName" ignore-blanks="true" value="query.name"></edit-in-place>\n        <span class="label label-default" ng-if="query.is_draft && !query.is_archived">Unpublished</span>\n        <span class="label label-warning" ng-if="query.is_archived" uib-popover="This query is archived and can\'t be used in dashboards, and won\'t appear in search results." popover-placement="right" popover-trigger="\'mouseenter\'">Archived</span>\n      </h3>\n      <p>\n        <em>\n          <edit-in-place editable="canEdit"\n                         done="saveDescription"\n                         editor="textarea"\n                         placeholder="No description"\n                         ignore-blanks=\'false\'\n                         value="query.description"\n                         markdown="true">\n          </edit-in-place>\n        </em>\n\n      <ul class="list-inline m-t-20">\n        <li>\n          <span class="zmdi zmdi-account"></span>\n          <span class="text-muted">Created By </span>\n          <strong>{{query.user.name}}</strong>\n        </li>\n        <li ng-if="query.last_modified_by && query.user.id != query.last_modified_by.id">\n          <span class="zmdi zmdi-account"></span>\n          <span class="text-muted">Last Modified By </span>\n          <strong>{{query.last_modified_by.name}}</strong>\n        </li>\n        <li>\n          <span class="zmdi zmdi-time"></span>\n          <span class="text-muted">Updated at </span>\n          <strong>\n            <rd-time-ago value="query.updated_at"></rd-time-ago>\n          </strong>\n        </li>\n        <li>\n          <span class="zmdi zmdi-time"></span>\n          <span class="text-muted">Created at </span>\n          <strong>\n            <rd-time-ago value="query.created_at"></rd-time-ago>\n          </strong>\n        </li>\n      </ul>\n      </p>\n    </div>\n    <div class="col-sm-3 text-right">\n      <h3>\n        <span ng-show="query.id && canViewSource">\n            <a ng-show="!sourceMode"\n              ng-href="{{query.getUrl(true, selectedTab)}}" class="btn btn-default">Show Source\n            </a>\n            <a ng-show="sourceMode"\n              ng-href="{{query.getUrl(false, selectedTab)}}" class="btn btn-default">Hide Source\n            </a>\n        </span>\n      </h3>\n    </div>\n  </div>\n\n  <!-- editor -->\n  <div class="container">\n      <div class="row bg-white p-b-5" ng-if="sourceMode" resizable r-directions="[\'bottom\']" r-height="300" style="min-height:100px;">\n        <schema-browser class="col-md-3 hidden-sm hidden-xs schema-container"\n                        schema="schema"\n                        on-refresh="refreshSchema()"\n                        ng-show="hasSchema">\n        </schema-browser>\n\n        <div ng-class="editorSize" style="height:100%;">\n            <div class="p-5">\n              <button type="button" class="btn btn-primary btn-s" ng-disabled="queryExecuting || !canExecuteQuery()"\n                      ng-click="executeQuery()">\n                <span class="zmdi zmdi-play"></span> Execute\n              </button>\n\n              <button type="button" class="btn btn-default btn-s" ng-click="formatQuery()">\n                <span class="zmdi zmdi-format-indent-increase"></span> Format Query\n              </button>\n\n              <i class="fa fa-database"></i>\n              <span class="text-muted">Data Source</span>\n              <select ng-disabled="!isQueryOwner" ng-model="query.data_source_id" ng-change="updateDataSource()"\n                      ng-options="ds.id as ds.name for ds in dataSources"></select>\n\n              <div class="pull-right">\n                <button class="btn btn-s btn-default" ng-click="togglePublished()" ng-if="query.is_draft && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\'))">\n                  <span class="fa fa-paper-plane"></span> Publish\n                </button>\n                <button class="btn btn-s btn-default" ng-click="duplicateQuery()" ng-disabled="query.id === undefined">\n                  <span class="zmdi zmdi-arrow-split"></span> Fork\n                </button>\n                <button class="btn btn-default" ng-show="canEdit" ng-click="saveQuery()">\n                  <span class="fa fa-floppy-o"> </span> Save<span\n                  ng-show="isDirty">&#42;</span>\n                </button>\n                <div class="btn-group" role="group" uib-dropdown>\n                  <button class="btn btn-default btn-sm dropdown-toggle" uib-dropdown-toggle>\n                    <span class="zmdi zmdi-more"></span>\n                  </button>\n                  <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n                    <li ng-if="!query.is_archived && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\'))"><a ng-click="archiveQuery()">Archive Query</a></li>\n                    <li ng-if="!query.is_archived && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\')) && showPermissionsControl"><a ng-click="showManagePermissionsModal()">Manage Permissions</a></li>\n                    <li ng-if="!query.is_draft && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\'))"><a ng-click="togglePublished()">Unpublish Query</a></li>\n                    <li ng-if="query.id != undefined"><a ng-click="showApiKey()">Show API Key</a></li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n            <p style="height:calc(100% - 40px);">\n              <query-editor query="query"\n                            schema="schema"\n                            syntax="dataSource.syntax"></query-editor>\n            </p>\n        </div>\n      </div>\n  </div>\n  <!-- end of editor -->\n\n  <!-- Query Details-->\n  <div class="container m-b-5 p-t-5 bg-ace" ng-if="sourceMode">\n  </div>\n  <!-- End of Query Details-->\n\n  <div class="tile">\n    <div class="t-header bg-ace">\n      <div class="pull-right">\n        <button class="btn btn-sm btn-default" ng-click="executeQuery()"\n                ng-disabled="queryExecuting || !canExecuteQuery()" title="Refresh Dataset"\n                ng-if="!sourceMode"><span\n          class="zmdi zmdi-refresh"></span></button>\n        <div class="btn-group" uib-dropdown>\n          <button type="button" class="btn btn-default btn-sm dropdown-toggle"\n                  ng-disabled="queryExecuting || !queryResult.getData()" aria-haspopup="true"\n                  uib-dropdown-toggle aria-expanded="false">\n            Download Dataset <span class="caret"></span>\n          </button>\n          <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n            <li>\n              <a query-result-link target="_self">\n                <span class="fa fa-file-o"></span> Download as CSV File\n              </a>\n            </li>\n            <li>\n              <a query-result-link file-type="xlsx" target="_self">\n                <span class="fa fa-file-excel-o"></span> Download as Excel File\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n      <ul class="list-inline">\n        <li>\n          <!-- runtime -->\n          <span class="zmdi zmdi-timer"></span>\n          <span class="text-muted">Runtime </span>\n          <strong ng-show="!queryExecuting">{{queryResult.getRuntime() | durationHumanize}}</strong>\n          <span ng-show="queryExecuting">Running&hellip;</span>\n        </li>\n        <li>\n          <!-- rows -->\n          <span class="zmdi zmdi-format-align-justify"></span>\n          <span class="text-muted">Rows </span><strong>{{queryResult.getData().length}}</strong>\n        </li>\n        <li>\n          <!-- refresh schedule -->\n          <span class="zmdi zmdi-refresh"></span>\n          <span class="text-muted">Refresh Schedule</span>\n          <a ng-click="openScheduleForm()" ng-if="!query.isNew()">{{query.schedule | scheduleHumanize}}</a>\n          <span ng-if="query.isNew()">Never</span>\n        </li>\n        <li>\n          <!-- last update -->\n          <span class="zmdi zmdi-time"></span>\n          <span class="text-muted">Last update </span>\n          <strong>\n            <rd-time-ago value="queryResult.query_result.retrieved_at"></rd-time-ago>\n          </strong>\n        </li>\n      </ul>\n\n    </div>\n    <div class="t-body">\n      <div class="row">\n        <div class="col-lg-12">\n          <parameters parameters="query.getParametersDefs()" sync-values="!query.isNew()" editable="sourceMode && canEdit"></parameters>\n          <!-- Query Execution Status -->\n          <div class="alert alert-info" ng-show="queryResult.getStatus() == \'processing\'">\n            Executing query&hellip;\n            <rd-timer timestamp="queryResult.getUpdatedAt()"></rd-timer>\n            <button type="button" class="btn btn-warning btn-xs pull-right" ng-disabled="cancelling"\n                    ng-click="cancelExecution()">Cancel\n            </button>\n          </div>\n          <div class="alert alert-info" ng-show="queryResult.getStatus() == \'waiting\'">\n            Query in queue&hellip;\n            <rd-timer timestamp="queryResult.getUpdatedAt()"></rd-timer>\n            <button type="button" class="btn btn-warning btn-xs pull-right" ng-disabled="cancelling"\n                    ng-click="cancelExecution()">Cancel\n            </button>\n          </div>\n          <div class="alert alert-danger" ng-show="queryResult.getError()">Error running query: <strong>{{queryResult.getError()}}</strong>\n          </div>\n          <!-- End of Query Execution Status -->\n\n          <!-- tabs and data -->\n          <div ng-if="showDataset">\n            <div class="row p-10" ng-show="showLog">\n              <div class="col-lg-12">\n                <p>Log Information:</p>\n                <p ng-repeat="l in queryResult.getLog()">{{l}}</p>\n              </div>\n            </div>\n            <div class="row">\n              <div class="col-lg-12">\n                <ul class="tab-nav">\n                  <rd-tab tab-id="table" name="Table" base-path="query.getUrl(sourceMode)"></rd-tab>\n                  <rd-tab tab-id="{{vis.id}}" name="{{vis.name}}" ng-if="vis.type!=\'TABLE\'" base-path="query.getUrl(sourceMode)"\n                          ng-repeat="vis in query.visualizations">\n                          <span class="remove" ng-click="deleteVisualization($event, vis)"\n                                ng-show="canEdit"> &times;</span>\n                  </rd-tab>\n                  <li class="rd-tab"><a ng-click="openVisualizationEditor()" ng-if="sourceMode && canEdit">&plus; New Visualization</a></li>\n                </ul>\n              </div>\n            </div>\n            <div class="row">\n              <div class="col-lg-12">\n                <div ng-show="selectedTab == \'table\'">\n                  <filters filters="filters"></filters>\n                  <grid-renderer query-result="queryResult" items-per-page="50"></grid-renderer>\n                  <!-- the ng-repeat is a lame hack to find the table visualization... -->\n                  <div class="bg-ace p-5" ng-repeat="vis in query.visualizations" ng-if="vis.type == \'TABLE\'">\n                    <button class="btn btn-default" ng-if="!query.isNew()" ng-click="showEmbedDialog(query, vis)"><i class="zmdi zmdi-code"></i> Embed</button>\n                  </div>\n                </div>\n                <div ng-if="selectedTab == vis.id" ng-repeat="vis in query.visualizations">\n                  <visualization-renderer visualization="vis" query-result="queryResult"></visualization-renderer>\n                  <div class="bg-ace p-5">\n                    <button class="btn btn-default" ng-click="openVisualizationEditor(vis)" ng-if="canEdit">Edit</button>\n                    <button class="btn btn-default" ng-click="showEmbedDialog(query, vis)"><i class="zmdi zmdi-code"></i> Embed</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,o,l,u,c,d,p,f,g,h,m,v,b){function y(t){void 0===t&&(t=a.search().maxAge),void 0===t&&(t=-1),e.showLog=!1,e.queryResult=e.query.getQueryResult(t)}function w(){var t=e.query.data_source_id;void 0===t&&(t=parseInt(localStorage.lastSelectedDataSourceId,10));var n=!isNaN(t)&&(0,s.some)(e.dataSources,function(e){return e.id===t});return n||(t=e.dataSources[0].id),t}function _(t){e.hasSchema=t,e.editorSize=t?"col-md-9":"col-md-12"}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;b.getSchema({id:e.query.data_source_id,refresh:t},function(n){var r=!!t&&(e.schema&&e.schema.length>0),a=n&&n.length>0;a?(e.schema=n,n.forEach(function(e){e.collapsed=!0})):r&&g.error("Schema refresh failed. Please try again later."),_(a||r)})}function q(){_(!1),x()}function $(t){return e.dataSources=t.filter(function(t){return!t.view_only||t.id===e.query.data_source_id}),0===e.dataSources.length?void(e.noDataSources=!0):(e.query.isNew()&&(e.query.data_source_id=w()),e.dataSource=(0,s.find)(t,function(t){return t.id===e.query.data_source_id}),e.canCreateQuery=(0,s.any)(t,function(e){return!e.view_only}),void q())}var A="table";e.refreshSchema=function(){return x(!0)},e.executeQuery=function(){e.canExecuteQuery()&&e.query.query&&(y(0),e.lockButton(!0),e.cancelling=!1,t.record("execute","query",e.query.id),p.getPermissions())},e.currentUser=m,e.dataSource={},e.query=n.current.locals.query,e.showPermissionsControl=f.showPermissionsControl;var k={"mod+enter":e.executeQuery};u.bind(k),e.$on("$destroy",function(){u.unbind(k)}),t.record("view","query",e.query.id),(e.query.hasResult()||e.query.paramsRequired())&&y(),e.queryExecuting=!1,e.isQueryOwner=m.id===e.query.user.id||m.hasPermission("admin"),e.canViewSource=m.hasPermission("view_source"),e.canExecuteQuery=function(){return m.hasPermission("execute_query")&&!e.dataSource.view_only},e.canScheduleQuery=m.hasPermission("schedule_query"),n.current.locals.dataSources?(e.dataSources=n.current.locals.dataSources,$(n.current.locals.dataSources)):e.dataSources=b.query($),e.showDataset=!0,e.showLog=!1,e.lockButton=function(t){e.queryExecuting=t},e.showApiKey=function(){o.alert("API Key for this query:\n"+e.query.api_key)},e.saveQuery=function(t,n){var r=n;if(r){if(e.query.isNew())return l.reject();r.id=e.query.id,r.version=e.query.version}else r=(0,s.pick)(e.query,["schedule","query","id","description","name","data_source_id","options","latest_query_data_id","version","is_draft"]);var a=i({},{successMessage:"Query saved",errorMessage:"Query could not be saved"},t);return v.save(r,function(t){g.success(a.successMessage),e.query.version=t.version},function(e){409===e.status?g.error("It seems like the query has been modified by another user. Please copy/backup your changes and reload this page.",{autoDismiss:!1}):g.error(a.errorMessage)}).$promise},e.togglePublished=function(){t.record("toggle_published","query",e.query.id),e.query.is_draft=!e.query.is_draft,e.saveQuery(void 0,{is_draft:e.query.is_draft})},e.saveDescription=function(){t.record("edit_description","query",e.query.id),e.saveQuery(void 0,{description:e.query.description})},e.saveName=function(){t.record("edit_name","query",e.query.id),e.saveQuery(void 0,{name:e.query.name})},e.cancelExecution=function(){e.cancelling=!0,e.queryResult.cancelExecution(),t.record("cancel_execute","query",e.query.id)},e.archiveQuery=function(){function t(){v.delete({id:e.query.id},function(){e.query.is_archived=!0,e.query.schedule=null},function(){g.error("Query could not be archived.")})}var n="Archive Query",r="Are you sure you want to archive this query?<br/> All alerts and dashboard widgets created with its visualizations will be deleted.",a={class:"btn-warning",title:"Archive"};d.open(n,r,a).then(t)},e.updateDataSource=function(){t.record("update_data_source","query",e.query.id),localStorage.lastSelectedDataSourceId=e.query.data_source_id,e.query.latest_query_data=null,e.query.latest_query_data_id=null,e.query.id&&v.save({id:e.query.id,data_source_id:e.query.data_source_id,latest_query_data_id:null}),q(),e.dataSource=(0,s.find)(e.dataSources,function(t){return t.id===e.query.data_source_id}),e.executeQuery()},e.setVisualizationTab=function(t){e.selectedTab=t.id,a.hash(t.id)},e.$watch("query.name",function(){c.set(e.query.name)}),e.$watch("queryResult && queryResult.getData()",function(t){t&&(e.filters=e.queryResult.getFilters())}),e.$watch("queryResult && queryResult.getStatus()",function(t){t&&("done"===t?(e.query.latest_query_data_id=e.queryResult.getId(),
e.query.queryResult=e.queryResult,p.showNotification("Redash",e.query.name+" updated.")):"failed"===t&&p.showNotification("Redash",e.query.name+" failed to run: "+e.queryResult.getError()),"done"!==t&&"failed"!==t||e.lockButton(!1),null!=e.queryResult.getLog()&&(e.showLog=!0))}),e.openVisualizationEditor=function(t){function n(){h.open({windowClass:"modal-xl",component:"editVisualizationDialog",resolve:{query:e.query,visualization:t,queryResult:e.queryResult,onNewSuccess:function(){return e.setVisualizationTab}}})}e.query.isNew()?e.saveQuery().then(function(e){a.path(e.getSourceLink()).hash("add")}):n()},"add"===a.hash()&&(a.hash(null),e.openVisualizationEditor()),e.openScheduleForm=function(){e.isQueryOwner&&e.canScheduleQuery&&h.open({component:"scheduleDialog",size:"sm",resolve:{query:e.query,saveQuery:function(){return e.saveQuery}}})},e.showEmbedDialog=function(e,t){h.open({component:"embedCodeDialog",resolve:{query:e,visualization:t}})},e.$watch(function(){return a.hash()},function(t){e.selectedTab=t||A}),e.showManagePermissionsModal=function(){h.open({component:"permissionsEditor",resolve:{aclUrl:{url:"api/queries/"+r.queryId+"/acl"}}})}}a.$inject=["$scope","Events","$route","$routeParams","$location","$window","$q","KeyboardShortcuts","Title","AlertDialog","Notifications","clientConfig","toastr","$uibModal","currentUser","Query","DataSource"],Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){return e.controller("QueryViewCtrl",a),{"/queries/:queryId":{template:l.default,controller:"QueryViewCtrl",reloadOnSearch:!1,resolve:{query:["Query","$route",function(e,t){"ngInject";return e.get({id:t.current.params.queryId}).$promise}]}}}};var s=n(155),o=n(258),l=r(o)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"A",link:function(e,t,n){var r=n.fileType?n.fileType:"csv";e.$watch("queryResult && queryResult.getData()",function(n){n&&(null==e.queryResult.getId()?t.attr("href",""):(t.attr("href","api/queries/"+e.query.id+"/results/"+e.queryResult.getId()+"."+r+(e.embed?"?api_key="+e.apiKey:"")),t.attr("download",e.query.name.replace(" ","_")+(0,s.default)(e.queryResult.getUpdatedAt()).format("_YYYY_MM_DD")+"."+r)))})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("queryResultLink",a)};var i=n(42),s=r(i)},function(e,t,n){"use strict";function r(e){window.ace.define("ace/snippets/"+e,["require","exports","module"],function(t,n){n.snippetText="",n.scope=e})}function a(e){return{restrict:"E",scope:{query:"=",schema:"=",syntax:"="},template:'<div ui-ace="editorOptions" ng-model="query.query"></div>',link:{pre:function(t){t.syntax=t.syntax||"sql",t.editorOptions={mode:"json",advanced:{behavioursEnabled:!0,enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,autoScrollEditorIntoView:!0},onLoad:function(n){n.commands.bindKey("Cmd+L",null),n.commands.bindKey("Ctrl+L",null),e.query(function(e){window.ace.acequire(["ace/snippets"],function(t){var n=t.snippetManager,r={snippetText:""};r.snippets=n.parseSnippetFile(r.snippetText),e.forEach(function(e){r.snippets.push(e.getSnippet())}),n.register(r.snippets||[],r.scope)})}),n.$blockScrolling=1/0,n.getSession().setUseWrapMode(!0),n.setShowPrintMargin(!1),t.$watch("syntax",function(e){var t="ace/mode/"+e;n.getSession().setMode(t)}),t.$watch("schema",function(e,t){if(e!==t){var r=e.reduce(function(e,t){return e+t.columns.length},0);r>5e3?n.setOption("enableLiveAutocompletion",!1):n.setOption("enableLiveAutocompletion",!0)}}),t.$parent.$on("angular-resizable.resizing",function(){n.resize()}),n.focus()}};var n={getCompletions:function(e,n,r,a,s){if(0===a.length||!t.schema)return void s(null,[]);if(!t.schema.keywords){var o={};t.schema.forEach(function(e){o[e.name]="Table",e.columns.forEach(function(t){o[t]="Column",o[e.name+"."+t]="Column"})}),t.schema.keywords=(0,i.map)(o,function(e,t){return{name:t,value:t,score:0,meta:e}})}s(null,t.schema.keywords)}};window.ace.acequire(["ace/ext/language_tools"],function(e){e.addCompleter(n)})}}}}a.$inject=["QuerySnippet"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("queryEditor",a)},n(149),n(262),n(263),n(264),n(266);var i=n(155);r("python"),r("sql"),r("json")},,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){"ngInject";this.showTable=function(t){t.collapsed=!t.collapsed,e.$broadcast("vsRepeatTrigger")},this.getSize=function(e){var t=18;return e.collapsed||(t+=18*e.columns.length),t}}a.$inject=["$scope"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("schemaBrowser",o)};var i=n(268),s=r(i),o={bindings:{schema:"<",onRefresh:"&"},controller:a,template:s.default}},function(e,t){e.exports='<div class="schema-container">\n  <div class="schema-control">\n    <input type="text" placeholder="Search schema..." class="form-control" ng-model="$ctrl.schemaFilter">\n    <button class="btn btn-default"\n            title="Refresh Schema"\n            ng-click="$ctrl.onRefresh()">\n      <span class="zmdi zmdi-refresh"></span>\n    </button>\n  </div>\n\n  <div class="schema-browser" vs-repeat vs-size="$ctrl.getSize(table)">\n    <div ng-repeat="table in $ctrl.schema | filter:$ctrl.schemaFilter track by table.name">\n      <div class="table-name" ng-click="$ctrl.showTable(table)">\n        <i class="fa fa-table"></i>\n        <strong>\n          <span title="{{table.name}}">{{table.name}}</span>\n          <span ng-if="table.size !== undefined"> ({{table.size}})</span>\n        </strong>\n      </div>\n      <div uib-collapse="table.collapsed">\n        <div ng-repeat="column in table.columns track by column" style="padding-left:16px;">{{column}}</div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("embedCodeDialog",s)};var a=n(270),i=r(a),s={controller:["clientConfig",function(e){"ngInject";this.query=this.resolve.query,this.visualization=this.resolve.visualization,this.embedUrl=e.basePath+"embed/query/"+this.query.id+"/visualization/"+this.visualization.id+"?api_key="+this.query.api_key,window.snapshotUrlBuilder&&(this.snapshotUrl=window.snapshotUrlBuilder(this.query,this.visualization))}],bindings:{resolve:"<",close:"&",dismiss:"&"},template:i.default}},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">Embed Code</h4>\n</div>\n<div class="modal-body">\n    <h5>IFrame Embed</h5>\n    <div>\n      <code>&lt;iframe src="{{ $ctrl.embedUrl }}" width="720" height="391"&gt;&lt;/iframe&gt;</code>\n    </div>\n    <span class="text-muted">(height should be adjusted)</span>\n    <div ng-if="snapshotUrl">\n      <h5>Image Embed</h5>\n      <div>\n        <code style="overflow-wrap:break-word;">{{snapshotUrl}}</code>\n      </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=String(t);return n.length<e&&(n="0"+n),n}function i(){return{restrict:"E",scope:{refreshType:"=",query:"=",saveQuery:"="},template:'\n      <select ng-disabled="refreshType != \'daily\'" ng-model="hour" ng-change="updateSchedule()" ng-options="c as c for c in hourOptions"></select> :\n      <select ng-disabled="refreshType != \'daily\'" ng-model="minute" ng-change="updateSchedule()" ng-options="c as c for c in minuteOptions"></select>\n    ',link:function(e){if(e.hourOptions=(0,u.map)((0,u.range)(0,24),(0,u.partial)(a,2)),e.minuteOptions=(0,u.map)((0,u.range)(0,60,5),(0,u.partial)(a,2)),e.query.hasDailySchedule()){var t=e.query.scheduleInLocalTime().split(":");e.minute=t[1],e.hour=t[0]}else e.minute="15",e.hour="00";e.updateSchedule=function(){var t=(0,l.default)().hour(e.hour).minute(e.minute).utc().format("HH:mm");t!==e.query.schedule&&(e.query.schedule=t,e.saveQuery())},e.$watch("refreshType",function(){"daily"===e.refreshType&&e.updateSchedule()})}}}function s(){return{restrict:"E",scope:{refreshType:"=",query:"=",saveQuery:"="},template:'<select\n                ng-disabled="refreshType != \'periodic\'"\n                ng-model="query.schedule"\n                ng-change="saveQuery()"\n                ng-options="c.value as c.name for c in refreshOptions">\n                <option value="">No Refresh</option>\n                </select>',link:function(e){e.refreshOptions=[{value:"60",name:"Every minute"}],[5,10,15,30].forEach(function(t){e.refreshOptions.push({value:String(60*t),name:"Every "+t+" minutes"})}),(0,u.range)(1,13).forEach(function(t){e.refreshOptions.push({value:String(3600*t),name:"Every "+t+"h"})}),e.refreshOptions.push({value:String(86400),name:"Every 24h"}),e.refreshOptions.push({value:String(604800),name:"Every 7 days"}),e.refreshOptions.push({value:String(1209600),name:"Every 14 days"}),e.refreshOptions.push({value:String(2592e3),name:"Every 30 days"}),e.$watch("refreshType",function(){"periodic"===e.refreshType&&e.query.hasDailySchedule()&&(e.query.schedule=null,e.saveQuery())})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("queryTimePicker",i),e.directive("queryRefreshSelect",s),e.component("scheduleDialog",p)};var o=n(42),l=r(o),u=n(155),c=n(272),d=r(c),p={controller:function(){this.query=this.resolve.query,this.saveQuery=this.resolve.saveQuery,this.query.hasDailySchedule()?this.refreshType="daily":this.refreshType="periodic"},bindings:{resolve:"<",close:"&",dismiss:"&"},template:d.default}},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">Refresh Schedule</h4>\n</div>\n<div class="modal-body">\n    <div class="radio">\n        <label>\n            <input type="radio" value="periodic" ng-model="$ctrl.refreshType">\n            <query-refresh-select refresh-type="$ctrl.refreshType" query="$ctrl.query" save-query="$ctrl.saveQuery"></query-refresh-select>\n        </label>\n    </div>\n    <div class="radio">\n        <label>\n            <input type="radio" value="daily" ng-model="$ctrl.refreshType">\n            <query-time-picker refresh-type="$ctrl.refreshType" query="$ctrl.query" save-query="$ctrl.saveQuery"></query-time-picker>\n        </label>\n    </div>\n</div>\n'},function(e,t){"use strict";function n(e){return{restrict:"E",replace:!0,scope:{isDirty:"="},link:function(t){var n="You will lose your changes if you leave",r=n+"\n\nAre you sure you want to leave this page?",a=e.onbeforeunload;e.onbeforeunload=function(){return t.isDirty?n:null},t.$on("$locationChangeStart",function(n,a,i){a.split("?")[0]!==i.split("?")[0]&&a.split("#")[0]!==i.split("#")[0]&&t.isDirty&&!e.confirm(r)&&n.preventDefault()}),t.$on("$destroy",function(){e.onbeforeunload=a})}}}n.$inject=["$window"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("alertUnsavedChanges",n)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a){var i=this;this.term=e.search().q,this.paginator=new l.Paginator([],{itemsPerPage:20}),a.search({q:this.term,include_drafts:!0},function(e){var t=e.map(function(e){return e.created_at=(0,s.default)(e.created_at),e});i.paginator.updateRows(t)}),this.search=function(){(0,o.isString)(i.term)&&""!==i.term.trim()?e.search({q:i.term}):i.paginator.updateRows([])},r.record("search","query","",{term:this.term})}a.$inject=["$location","$filter","currentUser","Events","Query"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.component("queriesSearchResultsPage",{template:c.default,controller:a}),{"/queries/search":{template:"<queries-search-results-page></queries-search-results-page>",reloadOnSearch:!0,title:"Queries Search"}}};var i=n(42),s=r(i),o=n(155),l=n(188),u=n(275),c=r(u)},function(e,t){e.exports='<div class="container">\n    <div class="bg-white p-5 m-t-10 m-b-10">\n      <form class="form-inline" role="form" ng-submit="$ctrl.search()">\n          <div class="form-group">\n              <input class="form-control" placeholder="Search..." ng-model="$ctrl.term" autofocus>\n          </div>\n          <button type="submit" class="btn btn-primary">\n              <span class="zmdi zmdi-search"></span>\n          </button>\n      </form>\n    </div>\n    <div class="bg-white">\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Created By</th>\n            <th>Created At</th>\n            <th>Update Schedule</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="query in $ctrl.paginator.getPageRows()">\n            <td><a href="queries/{{query.id}}">{{query.name}}</a> <span class="label label-default" ng-if="query.is_draft">Unpublished</span></td>\n            <td>{{query.user.name}}</td>\n            <td>{{query.created_at | dateTime}}</td>\n            <td>{{query.schedule | scheduleHumanize}}</td>\n          </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.paginator"></paginator>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(e,t,n){"ngInject";var r=t.current.params.api_key;return n.setApiKey(r),n.loadConfig()}function n(e,n,r,a){return t(e,n,a).then(function(){var t=n.current.params.queryId,a=e.get("/api/queries/"+t).then(function(e){return e.data}),i=e.get("/api/queries/"+t+"/results.json").then(function(e){return e.data});return r.all([a,i])})}t.$inject=["$http","$route","Auth"],n.$inject=["$http","$route","$q","Auth"],e.component("visualizationEmbed",u),e.config(["$routeProvider",function(e){e.when("/embed/query/:queryId/visualization/:visualizationId",{template:'<visualization-embed data="$resolve.data"></visualization-embed>',resolve:{data:n}})}])};var a=n(155),i=n(277),s=r(i),o=n(222),l=r(o),u={template:s.default,bindings:{data:"<"},controller:["$routeParams","Query","QueryResult",function(e,t,n){"ngInject";document.querySelector("body").classList.add("headless");var r=parseInt(e.visualizationId,10);this.showQueryDescription=e.showDescription,this.apiKey=e.api_key,this.logoUrl=l.default,this.query=new t(this.data[0]),this.queryResult=new n(this.data[1]),this.visualization=(0,a.find)(this.query.visualizations,function(e){return e.id===r})}]}},function(e,t){e.exports='<div class="tile m-10">\n  <div class="t-heading p-10">\n    <h3 class="th-title">\n      <p>\n        <img src="{{$ctrl.logoUrl}}" style="height: 24px;"/>\n        {{$ctrl.query.name}}\n        <small><visualization-name visualization="$ctrl.visualization"/></small>\n      </p>\n      <small ng-if="$ctrl.showQueryDescription">\n        <div class="text-muted" ng-bind-html="$ctrl.query.description | markdown"></div>\n      </small>\n    </h3>\n  </div>\n\n  <visualization-renderer visualization="$ctrl.visualization" query-result="$ctrl.queryResult" class="t-body">\n  </visualization-renderer>\n\n  <div class="bg-ace clearfix p-10">\n    <div class="col-sm-6">\n      <span class="label label-default hidden-print">Updated: <span am-time-ago="$ctrl.queryResult.getUpdatedAt()"></span></span>\n      <span class="label label-default visible-print">Updated: {{$ctrl.queryResult.getUpdatedAt() | dateTime}}</span>\n    </div>\n    <div class="col-sm-6 text-right hidden-print">\n      <a class="btn btn-default btn-xs" ng-href="queries/{{$ctrl.query.id}}#{{$ctrl.visualization.id}}" target="_blank" tooltip="Open in Redash">\n        <span class="zmdi zmdi-link"></span>\n      </a>\n\n      <div class="btn-group" uib-dropdown>\n        <button type="button" class="btn btn-default btn-xs dropdown-toggle" aria-haspopup="true" uib-dropdown-toggle\n                aria-expanded="false">\n          Download Dataset <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n          <li>\n            <a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'csv\', $ctrl.apiKey)}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'csv\')}}" target="_self">\n              <span class="fa fa-file-o"></span> Download as CSV File\n            </a>\n          </li>\n          <li>\n            <a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'xlsx\', $ctrl.apiKey)}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'xlsx\')}}"  target="_self">\n              <span class="fa fa-file-excel-o"></span> Download as Excel File\n            </a>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(279);Object.defineProperty(t,"appHeader",{enumerable:!0,get:function(){return r(a).default}});var i=n(282);Object.defineProperty(t,"footer",{enumerable:!0,get:function(){return r(i).default}});var s=n(284);Object.defineProperty(t,"pageHeader",{enumerable:!0,get:function(){return r(s).default}});var o=n(286);Object.defineProperty(t,"tabNav",{enumerable:!0,get:function(){return r(o).default}});var l=n(290);Object.defineProperty(t,"emailSettingsWarning",{enumerable:!0,get:function(){return r(l).default}});var u=n(291);Object.defineProperty(t,"rdTab",{enumerable:!0,get:function(){return r(u).default}});var c=n(292);Object.defineProperty(t,"queryLink",{enumerable:!0,get:function(){return r(c).default}});var d=n(293);Object.defineProperty(t,"parameters",{enumerable:!0,get:function(){return r(d).default}});var p=n(296);Object.defineProperty(t,"permissionsEditor",{enumerable:!0,get:function(){return r(p).default}});var f=n(298);Object.defineProperty(t,"dynamicTable",{enumerable:!0,get:function(){return r(f).default}});var g=n(301);Object.defineProperty(t,"paginator",{enumerable:!0,get:function(){return r(g).default}});var h=n(302);Object.defineProperty(t,"settingsScreen",{enumerable:!0,get:function(){return r(h).default}});var m=n(304);Object.defineProperty(t,"errorMessages",{enumerable:!0,get:function(){return r(m).default}});var v=n(305);Object.defineProperty(t,"editInPlace",{enumerable:!0,get:function(){return r(v).default}});var b=n(306);Object.defineProperty(t,"dynamicForm",{enumerable:!0,get:function(){return r(b).default}});var y=n(309);Object.defineProperty(t,"rdTimer",{enumerable:!0,get:function(){return r(y).default}});var w=n(310);Object.defineProperty(t,"rdTimeAgo",{enumerable:!0,get:function(){return r(w).default}});var _=n(311);Object.defineProperty(t,"overlay",{enumerable:!0,get:function(){return r(_).default}});var x=n(312);Object.defineProperty(t,"routeStatus",{enumerable:!0,get:function(){return r(x).default}});var q=n(313);Object.defineProperty(t,"filters",{enumerable:!0,get:function(){return r(q).default}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r,a,i){var s=this;this.logoUrl=c.default,this.currentUser=a,this.showQueriesMenu=a.hasPermission("view_query"),this.showNewQueryMenu=a.hasPermission("create_query"),this.showSettingsMenu=a.hasPermission("list_users"),this.showDashboardsMenu=a.hasPermission("list_dashboards"),this.reloadDashboards=function(){d("Reloading dashboards."),s.dashboards=i.recent()},this.reloadDashboards(),e.$on("reloadDashboards",this.reloadDashboards),this.newDashboard=function(){n.open({component:"editDashboardDialog",resolve:{dashboard:function(){return{name:null,layout:null}}}})},this.searchQueries=function(){t.path("/queries/search").search({q:s.term})},this.logout=function(){r.logout()}}a.$inject=["$rootScope","$location","$uibModal","Auth","currentUser","Dashboard"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("appHeader",{template:l.default,controller:a})};var i=n(19),s=r(i),o=n(280),l=r(o),u=n(222),c=r(u);n(281);var d=(0,s.default)("redash:appHeader")},function(e,t){e.exports='<nav class="navbar navbar-inverse navbar-fixed-top app-header" role="navigation">\n  <div class="container">\n    <div class="navbar-header">\n      <button type="button" class="navbar-toggle" ng-click="isNavOpen = !isNavOpen">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a class="navbar-brand" href="/"><img ng-src="{{$ctrl.logoUrl}}"/></a>\n    </div>\n    <div class="collapse navbar-collapse" uib-collapse="!isNavOpen">\n      <ul class="nav navbar-nav">\n        <li class="dropdown" ng-show="$ctrl.showDashboardsMenu" uib-dropdown>\n          <a href="#" class="dropdown-toggle" uib-dropdown-toggle title="Dashboards">\n            <span class="visible-xs visible-md visible-lg">Dashboards <b class="caret"></b></span>\n            <span class="visible-sm"><i class="zmdi zmdi-view-dashboard"></i> <b class="caret"></b></span>\n          </a>\n          <ul class="dropdown-menu" uib-dropdown-menu>\n            <li><a ng-show="$ctrl.currentUser.hasPermission(\'create_dashboard\')" ng-click="$ctrl.newDashboard()">New Dashboard</a></li>\n            <li><a href="dashboards">Dashboards</a></li>\n            <li class="divider" ng-if="$ctrl.dashboards | notEmpty"></li>\n            <li ng-repeat="dashboard in $ctrl.dashboards">\n              <a href="dashboard/{{dashboard.slug}}" ng-bind="dashboard.name"></a>\n            </li>\n          </ul>\n        </li>\n        <li class="dropdown" ng-show="$ctrl.showQueriesMenu" uib-dropdown>\n          <a href="#" class="dropdown-toggle" uib-dropdown-toggle>Queries <b class="caret"></b></a>\n          <ul class="dropdown-menu" uib-dropdown-menu>\n            <li ng-show="$ctrl.showNewQueryMenu"><a href="queries/new">New Query</a></li>\n            <li><a href="queries">Queries</a></li>\n          </ul>\n        </li>\n        <li>\n          <a href="alerts">Alerts</a>\n        </li>\n      </ul>\n      <form class="navbar-form navbar-left" role="search" ng-submit="$ctrl.searchQueries()">\n        <div class="input-group menu-search">\n          <input type="text" ng-model="$ctrl.term" class="form-control" placeholder="Search queries...">\n          <span class="input-group-btn">\n            <button type="submit" class="btn btn-default"><span class="zmdi zmdi-search"></span></button>\n          </span>\n        </div>\n      </form>\n      <ul class="nav navbar-nav navbar-right">\n        <li ng-show="$ctrl.currentUser.isAdmin">\n          <a href="data_sources" title="Data Sources"><i class="fa fa-database"></i></a>\n        </li>\n        <li ng-show="$ctrl.showSettingsMenu">\n          <a href="users" title="Settings"><i class="fa fa-cog"></i></a>\n        </li>\n        <li class="dropdown" uib-dropdown>\n          <a href="#" class="dropdown-toggle" uib-dropdown-toggle><span ng-bind="$ctrl.currentUser.name"></span> <span\n            class="caret"></span></a>\n          <ul class="dropdown-menu" dropdown-menu>\n            <li style="width:300px">\n              <a ng-href="users/{{$ctrl.currentUser.id}}">\n                <div class="row">\n                  <div class="col-sm-2">\n                    <img ng-src="{{$ctrl.currentUser.gravatar_url}}" size="40px" class="img-circle"/>\n                  </div>\n                  <div class="col-sm-10">\n                    <p><strong>{{$ctrl.currentUser.name}}</strong></p>\n                  </div>\n                </div>\n              </a>\n            </li>\n            <li class="divider" ng-if="$ctrl.currentUser.hasPermission(\'super_admin\')">\n            <li ng-if="$ctrl.currentUser.hasPermission(\'super_admin\')"><a href="admin/status">System Status</a></li>\n            <li class="divider">\n            </li>\n            <li>\n              <a ng-click="$ctrl.logout()">Log out</a>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </div>\n  </div>\n</nav>\n'},1,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){this.version=e.version,this.newVersionAvailable=e.newVersionAvailable&&t.isAdmin}a.$inject=["clientConfig","currentUser"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("footer",{template:s.default,controller:a})};var i=n(283),s=r(i)},function(e,t){e.exports='<div id="footer">\n    <a href="http://redash.io">Redash</a> <span ng-bind="$ctrl.version"></span> <small ng-if="$ctrl.newVersionAvailable" ng-cloak class="ng-cloak"><a href="https://version.redash.io/">(New Redash version available)</a></small>\n\n    <ul class="f-menu">\n        <li><a href="https://redash.io/help/">Documentation</a></li>\n        <li><a href="http://github.com/getredash/redash">Contribute</a></li>\n    </ul>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("pageHeader",{template:s.default,controller:a,transclude:!0,bindings:{title:"@"}})};var i=n(285),s=r(i)},function(e,t){e.exports='<div class="row bg-white p-10 p-l-15 p-r-15 m-b-10">\n  <div class="col-sm-9">\n    <h3>{{$ctrl.title}}</h3>\n  </div>\n  <div class="col-sm-3 text-right">\n    <h3 ng-transclude>\n    </h3>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){this.tabs.forEach(function(t){t.isActive?t.active=t.isActive(e.path()):t.active=(0,s.default)(e.path(),"/"+t.path)})}a.$inject=["$location"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("tabNav",{template:'<ul class="tab-nav bg-white"><li ng-repeat="tab in $ctrl.tabs" ng-class="{\'active\': tab.active }"><a ng-href="{{tab.path}}">{{tab.name}}</a></li></ul>',controller:a,bindings:{tabs:"<"}})};var i=n(287),s=r(i)},,,,function(e,t){"use strict";function n(e,t){this.showMailWarning=e.mailSettingsMissing&&t.isAdmin}n.$inject=["clientConfig","currentUser"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("emailSettingsWarning",{bindings:{function:"<"},template:'<p class="alert alert-danger" ng-if="$ctrl.showMailWarning">It looks like your mail server isn\'t configured. Make sure to configure it for the {{$ctrl.function}} to work.</p>',controller:n})}},function(e,t){"use strict";function n(e){return{restrict:"E",scope:{tabId:"@",name:"@",basePath:"=?"},transclude:!0,template:'<li class="rd-tab" ng-class="{active: tabId==selectedTab}"><a href="{{basePath}}#{{tabId}}">{{name}}<span ng-transclude></span></a></li>',replace:!0,link:function(t){t.basePath=t.basePath||e.path().substring(1),t.$watch(function(){return t.$parent.selectedTab},function(e){t.selectedTab=e})}}}n.$inject=["$location"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("rdTab",n)}},function(e,t){"use strict";function n(){var e=null;this.visualization&&(e="TABLE"===this.visualization.type?"table":this.visualization.id),this.link=this.query.getUrl(!1,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("queryLink",{bindings:{query:"<",visualization:"<"},template:'<a ng-href="{{$ctrl.link}}" class="query-link">{{$ctrl.query.name}}</a>',controller:n})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return{restrict:"E",transclude:!0,scope:{parameters:"=",syncValues:"=?",editable:"=?",changed:"&onChange"},template:s.default,link:function(n){n.syncValues!==!1&&n.$watch("parameters",function(){n.changed&&n.changed({}),n.parameters.forEach(function(t){null===t.value&&""===t.value||e.search("p_"+t.name,t.value)})},!0),n.showParameterSettings=function(e){t.open({component:"parameterSettings",resolve:{parameter:e}})}}}}a.$inject=["$location","$uibModal"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("parameters",a),e.component("parameterSettings",u)};var i=n(294),s=r(i),o=n(295),l=r(o),u={template:l.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:function(){"ngInject";this.parameter=this.resolve.parameter}}},function(e,t){e.exports='<div class="form-inline bg-white p-5" ng-if="parameters | notEmpty" ui-sortable="{ \'ui-floating\': true, \'disabled\': !editable }" ng-model="parameters">\n  <div class="form-group" ng-repeat="param in parameters">\n    <label>{{param.title}}</label>\n    <button class="btn btn-default btn-xs" ng-click="showParameterSettings(param)" ng-if="editable"><i class="zmdi zmdi-settings"></i></button>\n    <span ng-switch="param.type">\n      <input ng-switch-when="datetime-with-seconds" type="datetime-local" step="1" class="form-control" ng-model="param.ngModel">\n      <input ng-switch-when="datetime-local" type="datetime-local" class="form-control" ng-model="param.ngModel">\n      <input ng-switch-when="date" type="date" class="form-control" ng-model="param.ngModel">\n      <input ng-switch-default type="{{param.type}}" class="form-control" ng-model="param.ngModel">\n    </span>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">{{$ctrl.parameter.name}}</h4>\n</div>\n<div class="modal-body">\n    <div class="form">\n      <div class="form-group">\n        <label>Title</label>\n        <input type="text" class="form-control" ng-model="$ctrl.parameter.title">\n      </div>\n      <div class="form-group">\n        <label>Type</label>\n        <select ng-model="$ctrl.parameter.type" class="form-control">\n          <option value="text">Text</option>\n          <option value="number">Number</option>\n          <option value="date">Date</option>\n          <option value="datetime-local">Date and Time</option>\n          <option value="datetime-with-seconds">Date and Time (with seconds)</option>\n        </select>\n      </div>\n      <div class="form-group">\n        <label>Global</label>\n        <input type="checkbox" class="form-inline" ng-model="$ctrl.parameter.global">\n      </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("permissionsEditor",o)};var a=n(155),i=n(297),s=r(i),o={template:s.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$http","User",function(e,t){"ngInject";var n=this;this.grantees=[],this.newGrantees={},this.aclUrl=this.resolve.aclUrl.url;var r=function(){e.get(n.aclUrl).success(function(e){n.grantees=[],(0,a.each)(e,function(e,t){e.forEach(function(e){e.access_type=t,n.grantees.push(e)})})})};r(),this.findUser=function(e){""!==e&&void 0===n.foundUsers&&t.query(function(e){var t=n.grantees.map(function(e){return e.id});e.forEach(function(e){e.alreadyGrantee=(0,a.contains)(t,e.id)}),n.foundUsers=e})},this.addGrantee=function(t){n.newGrantees.selected=void 0;var a={access_type:"modify",user_id:t.id};e.post(n.aclUrl,a).success(function(){t.alreadyGrantee=!0,r()})},this.removeGrantee=function(t){var r={access_type:"modify",user_id:t.id};e({url:n.aclUrl,method:"DELETE",data:r,headers:{"Content-Type":"application/json"}}).success(function(){n.grantees=n.grantees.filter(function(e){return e!==t}),n.foundUsers&&n.foundUsers.forEach(function(e){e.id===t.id&&(e.alreadyGrantee=!1)})})}}]}},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">Manage Permissions</h4>\n</div>\n<div class="modal-body">\n  <div style="overflow: auto; height: 300px">\n    <ui-select ng-model="$ctrl.newGrantee.selected" on-select="$ctrl.addGrantee($item)">\n       <ui-select-match placeholder="Add New User"></ui-select-match>\n       <ui-select-choices repeat="user in $ctrl.foundUsers | filter:$select.search"\n                         refresh="$ctrl.findUser($select.search)"\n                         refresh-delay="0"\n                         ui-disable-choice="user.alreadyGrantee">\n        <div>\n          <img ng-src="{{user.gravatar_url}}" height="24px">&nbsp;{{user.name}}\n          <small ng-if="user.alreadyGrantee">(already has permission)</small>\n        </div>\n       </ui-select-choices>\n    </ui-select>\n      <br/>\n       <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th></th>\n            <th>User</th>\n            <th>Permission</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="grantee in $ctrl.grantees">\n          <td width="50px"><img ng-src="{{grantee.gravatar_url}}" height="40px"/></td>\n          <td>{{grantee.name}} </td>\n          <td>{{grantee.access_type}}</td>\n          <td><button class="pull-right btn btn-sm btn-danger" ng-click="$ctrl.removeGrantee(grantee)">Remove</button></td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n';
},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){"ngInject";var t=this;this.itemsPerPage=this.count=15,this.page=1,this.rowsCount=0,this.orderByField=void 0,this.orderByReverse=!1,this.pageChanged=function(){var e=t.count*(t.page-1),n=t.count*t.page;t.rows=t.allRows.slice(e,n)},this.$onChanges=function(e){e.columns&&(t.columns=e.columns.currentValue),e.rows&&(t.allRows=e.rows.currentValue),t.rowsCount=t.allRows.length,t.pageChanged()},this.orderBy=function(e){e===t.orderByField?t.orderByReverse=!t.orderByReverse:(t.orderByField=e,t.orderByReverse=!1),t.orderByField&&(t.allRows=(0,i.sortBy)(t.allRows,t.orderByField.name),t.orderByReverse&&(t.allRows=t.allRows.reverse()),t.pageChanged())},this.sanitize=function(t){return e(t)},this.sortIcon=function(e){return e!==t.orderByField?null:t.orderByReverse?"desc":"asc"}}a.$inject=["$sanitize"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("dynamicTable",{template:o.default,controller:a,bindings:{rows:"<",columns:"<",count:"<"}})};var i=n(155),s=n(299),o=r(s);n(300)},function(e,t){e.exports='<div>\n  <table class="table table-condensed table-hover">\n    <thead>\n    <tr>\n      <th ng-repeat="column in $ctrl.columns" ng-click="$ctrl.orderBy(column)" class="sortable-column">\n        {{column.title}} <span ng-if="$ctrl.sortIcon(column)"><i class="fa fa-sort-{{$ctrl.sortIcon(column)}}"></i></span>\n      </th>\n    </tr>\n\n    </thead>\n    <tbody>\n    <tr ng-repeat="row in $ctrl.rows">\n      <td ng-repeat="column in $ctrl.columns" ng-bind-html="$ctrl.sanitize(column.formatFunction(row[column.name]))">\n      </td>\n    </tr>\n    </tbody>\n  </table>\n</div>\n<div class="text-center">\n  <ul uib-pagination total-items="$ctrl.rowsCount"\n      items-per-page="$ctrl.itemsPerPage"\n      ng-model="$ctrl.page"\n      max-size="6"\n      class="pagination"\n      boundary-link-numbers="true"\n      rotate="false"\n      next-text=\'>\'\n      previous-text=\'<\'\n      ng-change="$ctrl.pageChanged()"></ul>\n</div>\n'},1,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){e.component("paginator",{template:'\n<div class="text-center">\n  <ul uib-pagination total-items="$ctrl.paginator.totalCount"\n                     items-per-page="$ctrl.paginator.itemsPerPage"\n                     ng-model="$ctrl.page"\n                     max-size="6"\n                     class="pagination"\n                     boundary-link-numbers="true"\n                     rotate="false"\n                     next-text=\'>\'\n                     previous-text=\'<\'\n                     ng-change="$ctrl.pageChanged()"></ul>\n</div>\n    ',bindings:{paginator:"<"},controller:a})};var a=function(){function e(){n(this,e),this.page=this.paginator.page}return r(e,[{key:"pageChanged",value:function(){this.paginator.setPage(this.page)}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("settingsScreen",["$location",function(e){return{restrict:"E",transclude:!0,template:o.default,controller:["$scope","currentUser",function(t,n){t.usersPage=(0,i.default)(e.path(),"/users"),t.groupsPage=(0,i.default)(e.path(),"/groups"),t.dsPage=(0,i.default)(e.path(),"/data_sources"),t.destinationsPage=(0,i.default)(e.path(),"/destinations"),t.snippetsPage=(0,i.default)(e.path(),"/query_snippets"),t.showGroupsLink=n.hasPermission("list_users"),t.showUsersLink=n.hasPermission("list_users"),t.showDsLink=n.hasPermission("admin"),t.showDestinationsLink=n.hasPermission("admin")}]}}])};var a=n(287),i=r(a),s=n(303),o=r(s)},function(e,t){e.exports='<page-header title="Settings">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li ng-class="{\'active\': dsPage }" ng-if="showDsLink"><a href="data_sources">Data Sources</a></li>\n      <li ng-class="{\'active\': usersPage }" ng-if="showUsersLink"><a href="users">Users</a></li>\n      <li ng-class="{\'active\': groupsPage }" ng-if="showGroupsLink"><a href="groups">Groups</a></li>\n      <li ng-class="{\'active\': destinationsPage }" ng-if="showDestinationsLink"><a href="destinations">Alert Destinations</a></li>\n      <li ng-class="{\'active\': snippetsPage }"><a href="query_snippets">Query Snippets</a></li>\n    </ul>\n\n    <div ng-transclude>\n\n    </div>\n  </div>\n</div>\n'},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("errorMessages",n)};var n={template:'\n  <div class="help-block" ng-messages="$ctrl.input.$error" ng-show="$ctrl.input.$touched || $ctrl.form.$submitted">\n    <span class="error" ng-message="required">This field is required.</span>\n    <span class="error" ng-message="minlength">This field is too short.</span>\n    <span class="error" ng-message="email">This needs to be a valid email.</span>\n  </div>\n  ',replace:!0,bindings:{input:"<",form:"<"},controller:function(){}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",scope:{value:"=",ignoreBlanks:"=",editable:"=",done:"="},template:function(e,t){var n=t.editor||"input",r=t.placeholder||"Click to edit",a="";a="true"===t.markdown?'<span ng-click="editable && edit()" ng-bind-html="value|markdown" ng-class="{editable: editable}"></span>':'<span ng-click="editable && edit()" ng-bind="value" ng-class="{editable: editable}"></span>';var i='<span ng-click="editable && edit()"\n                                     ng-show="editable && !value"\n                                     ng-class="{editable: editable}">'+r+"</span>",s='<{elType} ng-model="value" class="rd-form-control"></{elType}>'.replace("{elType}",n);return a+i+s},link:function(e,t){function n(){e.editing&&(e.ignoreBlanks&&(0,o.isEmpty)(e.value)&&(e.value=e.oldValue),e.editing=!1,t.removeClass("active"),e.value!==e.oldValue&&e.done&&e.done())}var r=(0,s.default)(t.children()[2]);t.addClass("edit-in-place"),e.editing=!1,e.edit=function(){e.oldValue=e.value,e.editing=!0,t.addClass("active"),r[0].focus()},(0,s.default)(r).keydown(function(t){13!==t.which||t.shiftKey?27===t.which&&(e.value=e.oldValue,e.$apply(function(){(0,s.default)(r[0]).blur()})):n()}).blur(function(){n()})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("editInPlace",a)};var i=n(157),s=r(i),o=n(155)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return{restrict:"E",replace:"true",transclude:!0,template:u.default,scope:{target:"=",type:"@type",actions:"="},link:function(r){function a(e){void 0===r.target.type&&(r.target.type=e[0].type),r.type=(0,i.find)(e,function(e){return e.type===r.target.type})}r.inProgressActions={},r.actions&&r.actions.forEach(function(e){var t=e.callback,n=e.name;e.callback=function(){function a(){r.inProgressActions[e.name]=!1,e.name=n}e.name='<i class="zmdi zmdi-spinner zmdi-hc-spin"></i> '+n,r.inProgressActions[e.name]=!0,t(a)}}),r.files={},r.$watchCollection("files",function(){(0,i.each)(r.files,function(e,t){!e&&r.target.options[t]&&r.dataSourceForm.$setPristine(),e&&(r.target.options[t]=e.base64)})});var s=e.get("api/"+r.type+"/types");n.all([s,r.target.$promise]).then(function(e){var t=e[0].data;a(t),r.types=t,t.forEach(function(e){(0,i.each)(e.configuration_schema.properties,function(t,n){"password"!==n&&"passwd"!==n||(t.type="password"),(0,o.default)(n,"File")&&(t.type="file"),"boolean"===t.type&&(t.type="checkbox"),t.required=(0,i.contains)(e.configuration_schema.required,n)})})}),r.$watch("target.type",function(e,t){t!==e&&(void 0!==t&&(r.target.options={}),a(r.types))}),r.saveChanges=function(){r.target.$save(function(){t.success("Saved."),r.dataSourceForm.$setPristine()},function(){t.error("Failed saving.")})}}}}a.$inject=["$http","toastr","$q"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("dynamicForm",a)};var i=n(155),s=n(307),o=r(s),l=n(308),u=r(l)},,function(e,t){e.exports='<form name="dataSourceForm">\n    <div class="form-group">\n        <label for="dataSourceName">Name</label>\n        <input type="string" class="form-control" name="dataSourceName" ng-model="target.name" required>\n    </div>\n    <div class="form-group">\n        <label for="type">Type</label>\n        <select name="type" class="form-control" ng-options="type.type as type.name for type in types" ng-model="target.type"></select>\n    </div>\n    <div class="form-group" ng-class=\'{"has-error": !inner.input.$valid}\' ng-form="inner" ng-repeat="(name, input) in type.configuration_schema.properties">\n        <label ng-if="input.type !== \'checkbox\'">{{input.title || name | capitalize}}</label>\n        <input name="input" type="{{input.type}}" class="form-control" ng-model="target.options[name]" ng-required="input.required"\n                ng-if="input.type !== \'file\' && input.type !== \'checkbox\'" accesskey="tab" placeholder="{{input.default}}">\n\n        <label ng-if="input.type==\'checkbox\'">\n          <input name="input" type="{{input.type}}" ng-model="target.options[name]" ng-required="input.required"\n                  ng-if="input.type !== \'file\'" accesskey="tab" placeholder="{{input.default}}">\n          {{input.title || name | capitalize}}\n        </label>\n\n        <input name="input" type="file" class="form-control" ng-model="files[name]" ng-required="input.required && !target.options[name]"\n               base-sixty-four-input\n               ng-if="input.type === \'file\'">\n    </div>\n    <button class="btn btn-primary" ng-disabled="!dataSourceForm.$valid" ng-click="saveChanges()">Save</button>\n    <span ng-repeat="action in actions">\n        <button class="btn"\n                ng-class="action.class"\n                ng-if="target.id"\n                ng-disabled="(action.disableWhenDirty && dataSourceForm.$dirty) || inProgressActions[action.name]"\n                ng-click="action.callback()" ng-bind-html="action.name"></button>\n    </span>\n\n    <span ng-transclude>\n\n    </span>\n</form>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",scope:{timestamp:"="},template:"{{currentTime}}",controller:["$scope",function(e){e.currentTime="00:00:00";var t=setInterval(function(){e.currentTime=(0,s.default)((0,s.default)()-(0,s.default)(e.timestamp)).utc().format("HH:mm:ss"),e.$digest()},1e3);e.$on("$destroy",function(){t&&(clearInterval(t),t=null)})}]}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("rdTimer",a)};var i=n(42),s=r(i)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("rdTimeAgo",n)};var n={bindings:{value:"="},controller:function(){},template:'<span><span ng-show="$ctrl.value" am-time-ago="$ctrl.value"></span><span ng-hide="$ctrl.value">-</span></span>'}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("overlay",n)};var n={template:'\n  <div>\n    <div class="overlay"></div>\n    <div style="width: 100%; position:absolute; top:50px; z-index:2000">\n      <div class="well well-lg" style="width: 70%; margin: auto;" ng-transclude>\n      </div>\n    </div>\n  </div>\n  ',transclude:!0}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("routeStatus",{template:'<overlay ng-if="$ctrl.permissionDenied">You do not have permission to load this page.',controller:["$rootScope",function(e){var t=this;this.permissionDenied=!1,e.$on("$routeChangeSuccess",function(){t.permissionDenied=!1}),e.$on("$routeChangeError",function(e,n,r,a){403===a.status&&(t.permissionDenied=!0)})}]})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("filters",s)};var a=n(314),i=r(a),s={template:i.default,bindings:{onChange:"&",filters:"<"},controller:function(){"ngInject";var e=this;this.filterChangeListener=function(t,n){e.onChange({filter:t,$modal:n})}}}},function(e,t){e.exports='<div class="container bg-white p-5" ng-show="$ctrl.filters | notEmpty">\n  <div class="row">\n    <div class="col-sm-6 m-t-5" ng-repeat="filter in $ctrl.filters">\n      <ui-select ng-model="filter.current" ng-if="!filter.multiple" on-select="$ctrl.filterChangeListener(filter, $model)" on-remove="$ctrl.filterChangeListener(filter, $model)">\n        <ui-select-match placeholder="Select value for {{filter.friendlyName}}...">{{filter.friendlyName}}: {{$select.selected | filterValue:filter}}</ui-select-match>\n        <ui-select-choices repeat="value in filter.values | filter: $select.search">\n          {{value | filterValue:filter }}\n        </ui-select-choices>\n      </ui-select>\n\n      <ui-select ng-model="filter.current" multiple ng-if="filter.multiple" on-select="$ctrl.filterChangeListener(filter, $model)" on-remove="$ctrl.filterChangeListener(filter, $model)">\n        <ui-select-match placeholder="Select value for {{filter.friendlyName}}...">{{filter.friendlyName}}: {{$item | filterValue:filter}}</ui-select-match>\n        <ui-select-choices repeat="value in filter.values | filter: $select.search">\n          {{value | filterValue:filter }}\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n</div>\n\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t="";if(void 0===e)t="-";else if(e<60){var n=Math.round(e);t=n+"s"}else if(e>86400){var r=Math.round(parseFloat(e)/60/60/24);t=r+"days"}else if(e>=3600){var a=Math.round(parseFloat(e)/60/60);t=a+"h"}else{var i=Math.round(parseFloat(e)/60);t=i+"m"}return t}function i(e){if(null===e)return"Never";if(null!==e.match(/\d\d:\d\d/)){var t=e.split(":"),n=g.default.utc().hour(t[0]).minute(t[1]).local().format("HH:mm");return"Every day at "+n}return"Every "+a(parseInt(e,10))}function s(e){return e.replace(/_/g," ").replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}function o(e){return 0===e?0:1===e?6:2===e?12:e}function l(e){return e?(0,m.default)(e):null}function u(e){return e.replace(b,"$1<a href='$2' target='_blank'>$2</a>")}function c(e,t){if(void 0===e)return e;var n=void 0;n=t instanceof Array?function(e){return t.indexOf(e)===-1}:function(e){return t!==e};for(var r=[],a=0;a<e.length;a+=1)n(e[a])&&r.push(e[a]);return r}function d(e){return!(0,v.isEmpty)(e)}function p(e,t){return e.$touched&&e.$invalid||t.$submitted}Object.defineProperty(t,"__esModule",{value:!0}),t.durationHumanize=a,t.scheduleHumanize=i,t.toHuman=s,t.colWidth=o,t.capitalize=l,t.linkify=u,t.remove=c,t.notEmpty=d,t.showError=p;var f=n(42),g=r(f),h=n(316),m=r(h),v=n(155),b=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(318);Object.defineProperty(t,"Dashboard",{enumerable:!0,get:function(){return r(a).default}});var i=n(319);Object.defineProperty(t,"Widget",{enumerable:!0,get:function(){return r(i).default}});var s=n(321);Object.defineProperty(t,"Query",{enumerable:!0,get:function(){return r(s).default}});var o=n(323);Object.defineProperty(t,"QueryResult",{enumerable:!0,get:function(){return r(o).default}});var l=n(324);Object.defineProperty(t,"Events",{enumerable:!0,get:function(){return r(l).default}});var u=n(325);Object.defineProperty(t,"Alert",{enumerable:!0,get:function(){return r(u).default}});var c=n(326);Object.defineProperty(t,"AlertSubscription",{enumerable:!0,get:function(){return r(c).default}});var d=n(327);Object.defineProperty(t,"Destination",{enumerable:!0,get:function(){return r(d).default}});var p=n(328);Object.defineProperty(t,"User",{enumerable:!0,get:function(){return r(p).default}});var f=n(329);Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return r(f).default}});var g=n(330);Object.defineProperty(t,"DataSource",{enumerable:!0,get:function(){return r(g).default}});var h=n(331);Object.defineProperty(t,"QuerySnippet",{enumerable:!0,get:function(){return r(h).default}});var m=n(332);Object.defineProperty(t,"Notifications",{enumerable:!0,get:function(){return r(m).default}});var v=n(333);Object.defineProperty(t,"KeyboardShortcuts",{enumerable:!0,get:function(){return r(v).default}});var b=n(336);Object.defineProperty(t,"OfflineListener",{enumerable:!0,get:function(){return r(b).default}});var y=n(337);Object.defineProperty(t,"AlertDialog",{enumerable:!0,get:function(){return r(y).default}});var w=n(338);Object.defineProperty(t,"Auth",{enumerable:!0,get:function(){return r(w).default}})},function(e,t,n){"use strict";function r(e,t,n,r){function i(e){e.widgets=(0,a.map)(e.widgets,function(e){return e.map(function(e){return new r(e)})}),e.publicAccessEnabled=void 0!==e.public_url}var s=t.defaults.transformResponse.concat(function(e){return(0,a.isArray)(e)?e.forEach(i):i(e),e}),o=e("api/dashboards/:slug",{slug:"@slug"},{get:{method:"GET",transformResponse:s},save:{method:"POST",transformResponse:s},query:{method:"GET",isArray:!0,transformResponse:s},recent:{method:"get",isArray:!0,url:"api/dashboards/recent",transformResponse:s}});return o.prototype.canEdit=function(){return n.canEdit(this)||this.can_edit},o}r.$inject=["$resource","$http","currentUser","Widget"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Dashboard",r)};var a=n(155)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=e("api/widgets/:id",{id:"@id"});return n.prototype.getQuery=function(){return!this.query&&this.visualization&&(this.query=new t(this.visualization.query)),this.query},n.prototype.getName=function(){return this.visualization?this.visualization.query.name+" ("+this.visualization.name+")":(0,s.default)(this.text,20)},n}a.$inject=["$resource","Query"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Widget",a)};var i=n(320),s=r(i)},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=[];return e.forEach(function(e){"name"===e[0]||"&"===e[0]?t.push(e[1]):"#"===e[0]&&(t=(0,p.union)(t,i(e[4])))}),t}function s(e,t,n,r,a,i){var s=e("api/queries/:id",{id:"@id"},{search:{method:"get",isArray:!0,url:"api/queries/search"},recent:{method:"get",isArray:!0,url:"api/queries/recent"},query:{isArray:!1},myQueries:{method:"get",isArray:!1,url:"api/queries/my"},fork:{method:"post",isArray:!1,url:"api/queries/:id/fork",params:{id:"@id"}}});return s.newQuery=function(){return new s({query:"",name:"New Query",schedule:null,user:a,options:{}})},s.format=function(e,r){if("json"!==e)return"sql"===e?t.post("api/queries/format",{query:r}).then(function(e){return e.data.query}):n.reject("Query formatting is not supported for your data source syntax.");try{var a=JSON.stringify(JSON.parse(r)," ",4);return n.resolve(a)}catch(e){return n.reject(String(e))}},s.prototype.getSourceLink=function(){return"/queries/"+this.id+"/source"},s.prototype.isNew=function(){return void 0===this.id},s.prototype.hasDailySchedule=function(){return this.schedule&&null!==this.schedule.match(/\d\d:\d\d/)},s.prototype.scheduleInLocalTime=function(){var e=this.schedule.split(":");return u.default.utc().hour(e[0]).minute(e[1]).local().format("HH:mm")},s.prototype.hasResult=function(){return!(!this.latest_query_data&&!this.latest_query_data_id)},s.prototype.paramsRequired=function(){return this.getParameters().isRequired()},s.prototype.getQueryResult=function(e){if(!this.query)return new f("Can't execute empty query.");var t=this.query,n=this.getParameters(),r=n.getMissing();if(r.length>0){var a="parameter",s="value";return r.length>1&&(a="parameters",s="values"),new i({job:{error:"missing "+s+" for "+r.join(", ")+" "+a+".",status:4}})}if(n.isRequired()&&(t=d.default.render(t,n.getValues()),this.latest_query_data=null,this.latest_query_data_id=null),this.latest_query_data&&0!==e)this.queryResult||(this.queryResult=new i({query_result:this.latest_query_data}));else if(this.latest_query_data_id&&0!==e)this.queryResult||(this.queryResult=i.getById(this.latest_query_data_id));else{if(!this.data_source_id)return new f("Please select data source to run this query.");this.queryResult=i.get(this.data_source_id,t,e,this.id)}return this.queryResult},s.prototype.getUrl=function(e,t){var n="queries/"+this.id;e&&(n+="/source");var r="";return this.getParameters().isRequired()&&(0,p.each)(this.getParameters().getValues(),function(e,t){null!==e&&(""!==r&&(r+="&"),r+="p_"+encodeURIComponent(t)+"="+encodeURIComponent(e))}),""!==r&&(n+="?"+r),t&&(n+="#"+t),n},s.prototype.getQueryResultPromise=function(){return this.getQueryResult().toPromise()},s.prototype.getParameters=function(){return this.$parameters||(this.$parameters=new h(this,r.search())),this.$parameters},s.prototype.getParametersDefs=function(){return this.getParameters().get()},s}s.$inject=["$resource","$http","$q","$location","currentUser","QueryResult"],Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){e.factory("Query",s)};var l=n(42),u=r(l),c=n(322),d=r(c),p=n(155),f=function(){function e(t){a(this,e),this.errorMessage=t}return o(e,[{key:"getError",value:function(){return this.errorMessage}}],[{key:"getStatus",value:function(){return"failed"}},{key:"getData",value:function(){return null}},{key:"getLog",value:function(){return null}},{key:"getChartData",value:function(){return null}}]),e}(),g=function(){function e(t){a(this,e),this.title=t.title,this.name=t.name,this.type=t.type,this.value=t.value,this.global=t.global}return o(e,[{key:"ngModel",get:function(){return"date"===this.type||"datetime-local"===this.type||"datetime-with-seconds"===this.type?(this.$$value=this.$$value||(0,u.default)(this.value).toDate(),this.$$value):"number"===this.type?(this.$$value=this.$$value||parseInt(this.value,10),this.$$value):this.value},set:function(e){e&&"date"===this.type?(this.value=(0,u.default)(e).format("YYYY-MM-DD"),this.$$value=(0,u.default)(this.value).toDate()):e&&"datetime-local"===this.type?(this.value=(0,u.default)(e).format("YYYY-MM-DD HH:mm"),this.$$value=(0,u.default)(this.value).toDate()):e&&"datetime-with-seconds"===this.type?(this.value=(0,u.default)(e).format("YYYY-MM-DD HH:mm:ss"),this.$$value=(0,u.default)(this.value).toDate()):this.value=this.$$value=e}}]),e}(),h=function(){function e(t,n){a(this,e),this.query=t,this.updateParameters(),this.initFromQueryString(n)}return o(e,[{key:"parseQuery",value:function(){var e=d.default.parse(this.query.query),t=(0,p.uniq)(i(e));return t}},{key:"updateParameters",value:function(){var e=this;if(this.query.query!==this.cachedQueryText){this.cachedQueryText=this.query.query;var t=this.parseQuery();this.query.options.parameters=this.query.options.parameters||[];var n={};this.query.options.parameters.forEach(function(e){n[e.name]=e}),t.forEach(function(t){(0,p.has)(n,t)||e.query.options.parameters.push({title:t,name:t,type:"text",value:null,global:!1})});var r=function(e){return(0,p.contains)(t,e.name)};this.query.options.parameters=this.query.options.parameters.filter(r).map(function(e){return new g(e)})}}},{key:"initFromQueryString",value:function(e){this.get().forEach(function(t){var n="p_"+t.name;(0,p.has)(e,n)&&(t.value=e[n])})}},{key:"get",value:function(){return this.updateParameters(),this.query.options.parameters}},{key:"getMissing",value:function(){return(0,p.pluck)((0,p.filter)(this.get(),function(e){return null===e.value||""===e.value}),"title")}},{key:"isRequired",value:function(){return!(0,p.isEmpty)(this.get())}},{key:"getValues",value:function(){var e=this.get();return(0,p.object)((0,p.pluck)(e,"name"),(0,p.pluck)(e,"value"))}}]),e}()},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=void 0;if(e.indexOf("::")!==-1)t="::";else{if(e.indexOf("__")===-1)return e;t="__"}var n=e.split(t);return""===n[0]&&2===n.length?n[1]:n[0]}function s(e){var t=i(e);return t}function o(e){return i(e).replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}function l(e,t,n){void 0===t[n]&&(t[n]={name:n,type:"column",data:[]}),t[n].data.push(e)}function u(e,t,n){var r=e("api/query_results/:id",{id:"@id"},{post:{method:"POST"}}),i=e("api/jobs/:id",{id:"@id"}),u={1:"waiting",2:"processing",3:"done",4:"failed"},f=function(){function e(t){a(this,e),this.deferred=n.defer(),this.job={},this.query_result={},this.status="waiting",this.filters=void 0,this.filterFreeze=void 0,this.updatedAt=(0,m.default)(),t&&this.update(t)}return p(e,[{key:"update",value:function(e){if(d(this,e),"query_result"in e){this.status="done",this.filters=void 0,this.filterFreeze=void 0;var t={};(0,v.each)(this.query_result.data.rows,function(e){(0,v.each)(e,function(n,r){(0,v.isNumber)(n)?t[r]="float":(0,v.isString)(n)&&n.match(/^\d{4}-\d{2}-\d{2}T/)?(e[r]=m.default.utc(n),t[r]="datetime"):(0,v.isString)(n)&&n.match(/^\d{4}-\d{2}-\d{2}$/)?(e[r]=m.default.utc(n),t[r]="date"):"object"===("undefined"==typeof n?"undefined":c(n))&&null!==n&&(e[r]=JSON.stringify(n))})}),(0,v.each)(this.query_result.data.columns,function(e){t[e.name]&&(null!=e.type&&"string"!==e.type||(e.type=t[e.name]))}),this.deferred.resolve(this)}else 3===this.job.status?this.status="processing":this.status=void 0}},{key:"getId",value:function(){var e=null;return"query_result"in this&&(e=this.query_result.id),e}},{key:"cancelExecution",value:function(){i.delete({id:this.job.id})}},{key:"getStatus",value:function(){return this.status||u[this.job.status]}},{key:"getError",value:function(){if("None"!==this.job.error)return this.job.error}},{key:"getLog",value:function(){return this.query_result.data&&this.query_result.data.log&&0!==this.query_result.data.log.length?this.query_result.data.log:null}},{key:"getUpdatedAt",value:function(){return this.query_result.retrieved_at||1e3*this.job.updated_at||this.updatedAt}},{key:"getRuntime",value:function(){return this.query_result.runtime}},{key:"getRawData",value:function(){if(!this.query_result.data)return null;var e=this.query_result.data.rows;return e}},{key:"getData",value:function(){function e(e){return e?e.reduce(function(e,t){return e+t.current},""):null}if(!this.query_result.data)return null;var t=this.getFilters(),n=e(t);return this.filterFreeze!==n&&(this.filterFreeze=n,t?this.filteredData=this.query_result.data.rows.filter(function(e){return t.reduce(function(t,n){return(0,v.isArray)(n.current)||(n.current=[n.current]),t&&(0,v.some)(n.current,function(t){var r=e[n.name];return m.default.isMoment(r)?r.isSame(t):t===r||String(r)===t})},!0)}):this.filteredData=this.query_result.data.rows),this.filteredData}},{key:"isEmpty",value:function(){return null===this.getData()||0===this.getData().length}},{key:"getChartData",value:function(e){var t={};return this.getData().forEach(function(n){var r={},a=void 0,i=0,s={},o=null,u=null;(0,v.each)(n,function(t,n){var l=n.split("::")[0]||n.split("__")[0],c=t,d=n.split("::")[1]||n.split("__")[1];e&&(d=e[n]),"unused"!==d&&("x"===d&&(i=c,r[d]=c),"y"===d&&(null==c&&(c=0),s[l]=c,r[d]=c),"yError"===d&&(o=c,r[d]=c),"series"===d&&(a=String(c)),"size"===d&&(r[d]=c,u=c),"multiFilter"!==d&&"multi-filter"!==d||(a=String(c)))}),void 0===a?(0,v.each)(s,function(e,n){r={x:i,y:e},null!==o&&(r.yError=o),null!==u&&(r.size=u),l(r,t,n)}):l(r,t,a)}),(0,v.values)(t)}},{key:"getColumns",value:function(){return void 0===this.columns&&this.query_result.data&&(this.columns=this.query_result.data.columns),this.columns}},{key:"getColumnNames",value:function(){return void 0===this.columnNames&&this.query_result.data&&(this.columnNames=this.query_result.data.columns.map(function(e){return e.name})),this.columnNames}},{key:"getColumnCleanNames",value:function(){return this.getColumnNames().map(function(e){return s(e)})}},{key:"getColumnFriendlyNames",value:function(){return this.getColumnNames().map(function(e){return o(e)})}},{key:"getFilters",value:function(){return this.filters||this.prepareFilters(),this.filters}},{key:"prepareFilters",value:function(){if(this.getColumns()){var e=[],t=["filter","multi-filter","multiFilter"];this.getColumns().forEach(function(n){var r=n.name,a=r.split("::")[1]||r.split("__")[1];if((0,v.contains)(t,a)){var i={name:r,friendlyName:o(r),column:n,values:[],multiple:"multiFilter"===a||"multi-filter"===a};e.push(i)}},this),this.getRawData().forEach(function(t){e.forEach(function(e){e.values.push(t[e.name]),1===e.values.length&&(e.multiple?e.current=[t[e.name]]:e.current=t[e.name])})}),e.forEach(function(e){e.values=(0,v.uniq)(e.values,function(e){return m.default.isMoment(e)?e.unix():e})}),this.filters=e}}},{key:"toPromise",value:function(){return this.deferred.promise}},{key:"refreshStatus",value:function(e){var n=this;i.get({id:this.job.id},function(a){n.update(a),"processing"===n.getStatus()&&n.job.query_result_id&&"None"!==n.job.query_result_id?r.get({id:n.job.query_result_id},function(e){n.update(e)}):"failed"!==n.getStatus()&&t(function(){n.refreshStatus(e)},3e3)},function(e){b("Connection error",e),n.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}})})}},{key:"getLink",value:function(e,t,n){var r="/api/queries/"+e+"/results/"+this.getId()+"."+t;return n&&(r=r+"?api_key="+n),r}},{key:"getName",value:function(e,t){return e.replace(" ","_")+(0,m.default)(this.getUpdatedAt()).format("_YYYY_MM_DD")+"."+t}}],[{key:"getById",value:function(t){var n=new e;return r.get({id:t},function(e){n.update(e)}),n}},{key:"get",value:function(t,n,a,i){var s=new e,o={data_source_id:t,query:n,max_age:a};return void 0!==i&&(o.query_id=i),r.post(o,function(e){s.update(e),"job"in e&&s.refreshStatus(n)},function(e){403===e.status?s.update(e.data):400===e.status&&"job"in e.data?s.update(e.data):(b("Unknown error",e),s.update({job:{error:"unknown error occurred. Please try again later.",status:4}}))}),s}}]),e}();return f}u.$inject=["$resource","$timeout","$q"],Object.defineProperty(t,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getColumnCleanName=s,t.default=function(e){e.factory("QueryResult",u)};var f=n(19),g=r(f),h=n(42),m=r(h),v=n(155),b=(0,g.default)("redash:services:QueryResult")},function(e,t,n){"use strict";function r(e){var t=this;this.events=[],this.post=(0,i.debounce)(function(){var n=t.events;t.events=[],e.post("api/events",n);
},1e3),this.record=function(e,t,n,r){var i={action:e,object_type:t,object_id:n,timestamp:Date.now()/1e3};a(i,r),this.events.push(i),this.post()}}r.$inject=["$http"],Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.service("Events",r)};var i=n(155)},function(e,t){"use strict";function n(e,t){var n={save:{method:"POST",transformRequest:[function(e){var t=r({},e);return void 0===t.query_id&&(t.query_id=t.query.id,t.destination_id=t.destinations,delete t.query,delete t.destinations),t}].concat(t.defaults.transformRequest)}},a=e("api/alerts/:id",{id:"@id"},n);return a}n.$inject=["$resource","$http"],Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.factory("Alert",n)}},function(e,t){"use strict";function n(e){var t=e("api/alerts/:alertId/subscriptions/:subscriberId",{alertId:"@alert_id",subscriberId:"@id"});return t}n.$inject=["$resource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("AlertSubscription",n)}},function(e,t){"use strict";function n(e){var t={get:{method:"GET",cache:!1,isArray:!1},query:{method:"GET",cache:!1,isArray:!0}},n=e("api/destinations/:id",{id:"@id"},t);return n}n.$inject=["$resource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Destination",n)}},function(e,t,n){"use strict";function r(e){void 0!==e.groups&&(e.admin=e.groups.indexOf("admin")!==-1)}function a(e){return(0,s.isArray)(e)?e.forEach(r):r(e),e}function i(e,t){var n=t.defaults.transformResponse.concat(a),r={get:{method:"GET",transformResponse:n},save:{method:"POST",transformResponse:n},query:{method:"GET",isArray:!0,transformResponse:n},delete:{method:"DELETE",transformResponse:n}},i=e("api/users/:id",{id:"@id"},r);return i}i.$inject=["$resource","$http"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("User",i)};var s=n(155)},function(e,t){"use strict";function n(e){var t={get:{method:"GET",cache:!1,isArray:!1},query:{method:"GET",cache:!1,isArray:!0},members:{method:"GET",cache:!1,isArray:!0,url:"api/groups/:id/members"},dataSources:{method:"GET",cache:!1,isArray:!0,url:"api/groups/:id/data_sources"}},n=e("api/groups/:id",{id:"@id"},t);return n}n.$inject=["$resource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Group",n)}},function(e,t){"use strict";function n(e){var t={get:{method:"GET",cache:!1,isArray:!1},query:{method:"GET",cache:!1,isArray:!0},test:{method:"POST",cache:!1,isArray:!1,url:"api/data_sources/:id/test"},getSchema:{method:"GET",cache:!1,isArray:!0,url:"api/data_sources/:id/schema"}},n=e("api/data_sources/:id",{id:"@id"},t);return n}n.$inject=["$resource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("DataSource",n)}},function(e,t){"use strict";function n(e){var t=e("api/query_snippets/:id",{id:"@id"});return t.prototype.getSnippet=function(){var e=this.trigger;return""!==this.description&&(e=this.trigger+": "+this.description),{name:e,content:this.snippet,tabTrigger:this.trigger}},t}n.$inject=["$resource"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("QuerySnippet",n)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={pageVisible:!0};return n.monitorVisibility=function(){var e=void 0,t=void 0;"undefined"!=typeof document.hidden?(e="hidden",t="visibilitychange"):"undefined"!=typeof document.msHidden&&(e="msHidden",t="msvisibilitychange");var r=document[e];document.addEventListener(t,function(){r!==document[e]&&(document[e]?n.pageVisible=!1:n.pageVisible=!0,r=document[e])})},n.monitorVisibility(),n.isSupported=function(){return"Notification"in window||(o("HTML5 notifications are not supported."),!1)},n.getPermissions=function(){this.isSupported()&&"default"===Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)})},n.showNotification=function(e,n){if(this.isSupported()&&!this.pageVisible&&"granted"===Notification.permission){var r=new Notification(e,{tag:e+n,body:n,icon:"/images/redash_icon_small.png"});setTimeout(function(){r.close()},3e3),r.onclick=function(){window.focus(),this.close(),t.record("click","notification")}}},n}a.$inject=["currentUser","Events"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Notifications",a)};var i=n(19),s=r(i),o=(0,s.default)("redash:notifications")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){this.bind=function(e){(0,i.each)(e,function(e,t){o.default.bindGlobal(t,function(t){t.preventDefault(),e()})})},this.unbind=function(e){(0,i.each)(e,function(e,t){o.default.unbind(t)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.service("KeyboardShortcuts",a)};var i=n(155),s=n(334),o=r(s);n(335)},,,function(e,t){"use strict";function n(e){function t(t){function n(){e.remove(t.toastId),window.removeEventListener("online",n)}window.addEventListener("online",n)}window.addEventListener("offline",function(){var n=e.warning("<div>Please check your Internet connection.</div>","",{allowHtml:!0,autoDismiss:!1,timeOut:!1,tapToDismiss:!0});t(n)})}n.$inject=["toastr"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.service("OfflineListener",n)}},function(e,t){"use strict";function n(e){var t={open:function(t,n,r){return e.open({component:"alertDialog",resolve:{title:function(){return t},message:function(){return n},confirm:function(){return r}}}).result}};return t}n.$inject=["$uibModal"],Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.component("alertDialog",a),e.factory("AlertDialog",n)};var a={template:'\n<div class="modal-header">\n    <h4 class="modal-title" ng-if="$ctrl.title">{{$ctrl.title}}</h4>\n</div>\n<div class="modal-body">\n  <p ng-bind-html="$ctrl.message"></p>\n</div>\n<div class="modal-footer">\n  <button class="btn btn-default" ng-click="$ctrl.dismiss()">Cancel</button>\n  <button class="btn" ng-class="$ctrl.confirm.class" ng-click="$ctrl.close()" ng-if="$ctrl.confirm.show">{{$ctrl.confirm.title}}</button>\n</div>\n  ',bindings:{close:"&",dismiss:"&",resolve:"<"},controller:function(){this.title=this.resolve.title,this.message=this.resolve.message,this.confirm=r({},{class:"btn-sucess",show:!0,title:"OK"},this.resolve.confirm)}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){f("Updating session to be:",e),c(h,e,{loaded:!0})}function i(){if(h.loaded)return h;var e=window.sessionStorage.getItem(g);return e&&a(JSON.parse(e)),h}function s(e,t,n,r){var s={isAuthenticated:function(){var e=i();return e.loaded&&e.user.id},login:function(){var e=encodeURI(t.url());f("Calling login with next = %s",e),window.location.href="/login?next="+e},logout:function(){f("Logout."),window.sessionStorage.removeItem(g),e.location.href="/logout"},loadSession:function(){f("Loading session");var e=i();return e.loaded&&e.user.id?(f("Resolving with local value."),n.resolve(e)):(this.setApiKey(null),r.get("/api/session").then(function(e){return a(e.data),h}))},loadConfig:function(){return f("Loading config"),r.get("/api/config").then(function(e){return a({client_config:e.data.client_config,user:{permissions:[]}}),e.data})},setApiKey:function(e){f("Set API key to: %s",e),this.apiKey=e},getApiKey:function(){return this.apiKey}};return s}function o(){var e=this,t=i();c(this,t.user),this.canEdit=function(t){var n=t.user_id||t.user&&t.user.id;return e.hasPermission("admin")||n&&n===e.id},this.hasPermission=function(t){return e.permissions.indexOf(t)!==-1},this.isAdmin=this.hasPermission("admin")}function l(){c(this,i().client_config)}function u(e){return{request:function(t){var n=e.get("Auth"),r=n.getApiKey();return r&&(t.headers.Authorization="Key "+r),t}}}s.$inject=["$window","$location","$q","$http"],u.$inject=["$injector"],Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.factory("Auth",s),e.service("currentUser",o),e.service("clientConfig",l),e.factory("apiKeyHttpInterceptor",u),e.config(["$httpProvider",function(e){e.interceptors.push("apiKeyHttpInterceptor")}]),e.run(["$location","$window","$rootScope","$route","Auth",function(e,t,n,r,a){n.$on("$routeChangeStart",function(e,t){t.authenticated&&!a.isAuthenticated()&&(f("Requested authenticated route: ",t),e.preventDefault(),a.loadSession().then(function(){f("Loaded session"),r.reload()}).catch(function(){f("Need to login, redirecting"),a.login()}))})}])};var d=n(19),p=r(d),f=(0,p.default)("redash:auth"),g="session",h={loaded:!1}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,n,r){var a=function(t){r.$setValidity("compareTo",t===e.otherModelValue)};e.$watch("otherModelValue",function(){a(r.$modelValue)}),r.$parsers.push(function(e){return a(e),e})}}}function i(e){return{link:function(t,n){e(function(){n[0].focus()})}}}function s(e){var t={title:"Redash",set:function(t){this.title=t,e.$broadcast("$titleChange")},get:function(){return this.title}};return t}function o(e,t){return{restrict:"E",link:function(n,r){function a(){var e=t.get();c("Updating title to: %s",e),r.text(e)}e.$on("$routeChangeSuccess",function(e,n){n.title&&t.set(n.title)}),e.$on("$titleChange",a)}}}s.$inject=["$rootScope"],o.$inject=["$rootScope","Title"],i.$inject=["$timeout"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Title",s),e.directive("title",o),e.directive("compareTo",a),e.directive("autofocus",i)};var l=n(19),u=r(l),c=(0,u.default)("redash:directives")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){var e=this;this.visualizations={},this.visualizationTypes={};var t={defaultOptions:{},skipTypes:!1,editorTemplate:null};this.registerVisualization=function(n){var r=u({},t,n);(0,p.isEmpty)(e.visualizations)&&(e.defaultVisualization=r),e.visualizations[n.type]=r,n.skipTypes||(e.visualizationTypes[n.name]=n.type)},this.getSwitchTemplate=function(t){var n=/(<[a-zA-Z0-9-]*?)( |>)/,r=(0,p.reduce)(e.visualizations,function(e,r){if(r[t]){var a='$1 ng-switch-when="'+r.type+'" $2',i=r[t].replace(n,a);return e+"\n"+i}return e},"");return r='<div ng-switch on="visualization.type">'+r+"</div>"},this.$get=["$resource",function(t){var n=t("api/visualizations/:id",{id:"@id"});return n.visualizations=e.visualizations,n.visualizationTypes=e.visualizationTypes,n.renderVisualizationsTemplate=e.getSwitchTemplate("renderTemplate"),n.editorTemplate=e.getSwitchTemplate("editorTemplate"),n.defaultVisualization=e.defaultVisualization,n}]}function i(e){return{restrict:"E",scope:{visualization:"="},template:"{{name}}",replace:!1,link:function(t){if(e.visualizations[t.visualization.type]){var n=e.visualizations[t.visualization.type].name;n!==t.visualization.name&&(t.name=t.visualization.name)}}}}function s(e){return{restrict:"E",scope:{visualization:"=",queryResult:"="},template:'<filters filters="filters"></filters>\n'+e.renderVisualizationsTemplate,replace:!1,link:function(e){e.$watch("queryResult && queryResult.getFilters()",function(t){t&&(e.filters=t)})}}}function o(e){return{restrict:"E",template:e.editorTemplate,replace:!1,scope:{visualization:"=",query:"=",queryResult:"="}}}function l(e){return function(t,n){var r=t;if((0,p.isArray)(t)&&(r=t[0]),"date"===n.column.type){if(r&&d.default.isMoment(r))return r.format(e.dateFormat)}else if("datetime"===n.column.type&&r&&d.default.isMoment(r))return r.format(e.dateTimeFormat);return r}}s.$inject=["Visualization"],o.$inject=["Visualization"],i.$inject=["Visualization"],l.$inject=["clientConfig"],Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.provider("Visualization",a),e.directive("visualizationRenderer",s),e.directive("visualizationOptionsEditor",o),e.directive("visualizationName",i),e.filter("filterValue",l),(0,g.default)(e),(0,w.default)(e),(0,m.default)(e),(0,x.default)(e),(0,$.default)(e),(0,k.default)(e),(0,P.default)(e),(0,C.default)(e),(0,M.default)(e),(0,O.default)(e),(0,b.default)(e)};var c=n(42),d=r(c),p=n(155),f=n(341),g=r(f),h=n(343),m=r(h),v=n(346),b=r(v),y=n(348),w=r(y),_=n(592),x=r(_),q=n(595),$=r(q),A=n(598),k=r(A),z=n(602),P=r(z),S=n(605),C=r(S),j=n(609),M=r(j),E=n(622),O=r(E)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("editVisualizationDialog",l)};var a=n(155),i=n(22),s=n(342),o=r(s),l={template:o.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$window","currentUser","Events","Visualization","toastr",function(e,t,n,r,s){"ngInject";var o=this;this.query=this.resolve.query,this.queryResult=this.resolve.queryResult,this.originalVisualization=this.resolve.visualization,this.onNewSuccess=this.resolve.onNewSuccess,this.visualization=(0,i.copy)(this.originalVisualization),this.visTypes=r.visualizationTypes,this.newVisualization=function(){return{type:r.defaultVisualization.type,name:r.defaultVisualization.name,description:"",options:r.defaultVisualization.defaultOptions}},this.visualization||(this.visualization=this.newVisualization()),this.typeChanged=function(e){var t=o.visualization.type;t&&e!==t&&o.visualization&&!o.visForm.name.$dirty&&(o.visualization.name=r.visualizations[o.visualization.type].name),t&&e!==t&&o.visualization&&(o.visualization.options=r.visualizations[o.visualization.type].defaultOptions)},this.submit=function(){o.visualization.id?n.record("update","visualization",o.visualization.id,{type:o.visualization.type}):n.record("create","visualization",null,{type:o.visualization.type}),o.visualization.query_id=o.query.id,r.save(o.visualization,function(e){s.success("Visualization saved");var t=(0,a.pluck)(o.query.visualizations,"id"),n=t.indexOf(e.id);n>-1?o.query.visualizations[n]=e:(o.query.visualizations.push(e),o.onNewSuccess&&o.onNewSuccess(e)),o.close()},function(){s.error("Visualization could not be saved")})},this.closeDialog=function(){o.visForm.$dirty?e.confirm("Are you sure you want to close the editor without saving?")&&o.close():o.close()}}]}},function(e,t){e.exports='<div>\n  <div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.closeDialog()"><span aria-hidden="true">&times;</span>\n    </button>\n    <h4 class="modal-title">Visualization Editor</h4>\n  </div>\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-md-5 p-r-5">\n        <div>\n          <form name="$ctrl.visForm">\n            <div class="form-group">\n              <label class="control-label">Visualization Type</label>\n\n              <select required ng-model="$ctrl.visualization.type"\n                      ng-options="value as key for (key, value) in $ctrl.visTypes" class="form-control"\n                      ng-change="$ctrl.typeChanged(\'{{$ctrl.visualization.type}}\')"></select>\n            </div>\n\n            <div class="form-group">\n              <label class="control-label">Visualization Name</label>\n              <input name="name" type="text" class="form-control" ng-model="$ctrl.visualization.name"\n                     placeholder="{{$ctrl.visualization.type | capitalize}}">\n            </div>\n\n            <visualization-options-editor visualization="$ctrl.visualization"\n                                          query-result="$ctrl.queryResult"\n                                          query="$ctrl.query">\n            </visualization-options-editor>\n          </form>\n        </div>\n      </div>\n      <div class="col-md-7" style="border: 1px solid #eee">\n        <visualization-renderer visualization="$ctrl.visualization" query-result="$ctrl.queryResult"></visualization-renderer>\n      </div>\n    </div>\n  </div>\n  <div class="modal-footer">\n    <button type="button" class="btn btn-default" ng-click="$ctrl.closeDialog()">Close</button>\n    <button type="button" class="btn btn-primary" ng-click="$ctrl.submit()">Save</button>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",template:o.default,link:function(e){var t=function(){var t=e.queryResult.getData();if(t){var n=e.visualization.options.rowNumber-1,r=e.visualization.options.targetRowNumber-1,a=e.visualization.options.counterColName,i=e.visualization.options.targetColName;e.visualization.options.countRow?e.counterValue=t.length:a&&(e.counterValue=t[n][a]),i?(e.targetValue=t[r][i],e.targetValue&&(e.delta=e.counterValue-e.targetValue,e.trendPositive=e.delta>=0)):e.targetValue=null}};e.$watch("visualization.options",t,!0),e.$watch("queryResult && queryResult.getData()",t)}}}function i(){return{restrict:"E",template:u.default}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("counterEditor",i),e.directive("counterRenderer",a),e.config(["VisualizationProvider",function(e){var t='<counter-renderer options="visualization.options" query-result="queryResult"></counter-renderer>',n="<counter-editor></counter-editor>",r={counterColName:"counter",rowNumber:1,targetRowNumber:1};e.registerVisualization({type:"COUNTER",name:"Counter",renderTemplate:t,editorTemplate:n,defaultOptions:r})}])};var s=n(344),o=r(s),l=n(345),u=r(l)},function(e,t){e.exports="<counter ng-class=\"{'positive': targetValue && trendPositive, 'negative': targetValue && !trendPositive}\">\n  <value>{{counterValue|number}}</value>\n  <counter-target ng-if=\"targetValue\">({{targetValue|number}})</counter-target>\n  <counter-name>{{visualization.name}}</counter-name>\n</counter>\n"},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Counter Value Column Name</label>\n    <div class="col-lg-6">\n      <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.counterColName" class="form-control" ng-disabled="visualization.options.countRow"></select>\n    </div>\n  </div>\n  <div class="form-group">\n    <label class="col-lg-6">Counter Value Row Number</label>\n    <div class="col-lg-6">\n      <input type="number" ng-model="visualization.options.rowNumber" min="1" class="form-control" ng-disabled="visualization.options.countRow">\n    </div>\n  </div>\n  <div class="form-group">\n    <label class="col-lg-6">Target Value Column Name</label>\n    <div class="col-lg-6">\n      <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.targetColName" class="form-control">\n        <option value="">No target value</option>\n      </select>\n    </div>\n  </div>\n  <div class="form-group" ng-if="visualization.options.targetColName">\n    <label class="col-lg-6">Target Value Row Number</label>\n    <div class="col-lg-6">\n      <input type="number" ng-model="visualization.options.targetRowNumber" min="1" class="form-control">\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-lg-6">\n      <input type="checkbox" ng-model="visualization.options.countRow">\n      <i class="input-helper"></i> Count Rows\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,r){var a=n;switch(r){case"integer":a=e("number")(n,0);break;case"float":a=e("number")(n,2);break;case"boolean":void 0!==n&&(a=String(n));break;case"date":n&&o.default.isMoment(n)&&(a=n.format(t.dateFormat));break;case"datetime":n&&o.default.isMoment(n)&&(a=n.format(t.dateTimeFormat));break;default:(0,l.isString)(n)&&(a=e("linkify")(n))}return a}function i(e){return{restrict:"E",scope:{queryResult:"=",itemsPerPage:"="},template:d.default,replace:!1,controller:["$scope","$filter",function(t,n){t.gridColumns=[],t.gridRows=[],t.$watch("queryResult && queryResult.getData()",function(r){if(r)if(null==t.queryResult.getData())t.gridColumns=[],t.filters=[];else{t.filters=t.queryResult.getFilters();var i=t.queryResult.getColumns();i.forEach(function(t){t.title=(0,u.getColumnCleanName)(t.name),t.formatFunction=(0,l.partial)(a,n,e,l._,t.type)}),t.gridRows=t.queryResult.getData(),t.gridColumns=i}})}]}}i.$inject=["clientConfig"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.config(["VisualizationProvider",function(e){e.registerVisualization({type:"TABLE",name:"Table",renderTemplate:'<grid-renderer options="visualization.options" query-result="queryResult"></grid-renderer>',skipTypes:!0})}]),e.directive("gridRenderer",i)};var s=n(42),o=r(s),l=n(155),u=n(323),c=n(347),d=r(c)},function(e,t){e.exports='<dynamic-table rows="gridRows" columns="gridColumns"></dynamic-table>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",scope:{queryResult:"=",options:"=?"},template:c.default,replace:!1,controller:["$scope",function(e){function t(t){return e.options.seriesOptions[t.name]?e.options.seriesOptions[t.name].zIndex:0}function n(){if(!(0,s.isUndefined)(e.queryResult)&&e.queryResult.getData()){var n=e.queryResult.getChartData(e.options.columnMapping);e.chartSeries=(0,s.sortBy)(n,t)}}function r(){n(),e.plotlyOptions=e.options}e.chartSeries=[],e.$watch("options",r,!0),e.$watch("queryResult && queryResult.getData()",n)}]}}function i(e,t){return{restrict:"E",template:p.default,scope:{queryResult:"=",options:"=?"},link:function(n){function r(){n.columns=n.queryResult.getColumns(),n.columnNames=(0,s.pluck)(n.columns,"name"),n.columnNames.length>0&&(0,s.each)((0,s.difference)((0,s.keys)(n.options.columnMapping),n.columnNames),function(e){delete n.options.columnMapping[e]})}function a(){r(),n.queryResult.getData()&&0!==n.queryResult.getData().length&&0!==n.columns.length&&(n.form.yAxisColumns=(0,s.intersection)(n.form.yAxisColumns,n.columnNames),(0,s.contains)(n.columnNames,n.form.xAxisColumn)||(n.form.xAxisColumn=void 0),(0,s.contains)(n.columnNames,n.form.groupby)||(n.form.groupby=void 0))}function i(){var e=(0,s.pluck)(n.queryResult.getChartData(n.options.columnMapping),"name"),t=(0,s.keys)(n.options.seriesOptions);(0,s.each)((0,s.difference)(e,t),function(e){n.options.seriesOptions[e]={type:n.options.globalSeriesType,yAxis:0},n.form.seriesList.push(e)}),(0,s.each)((0,s.difference)(t,e),function(e){n.form.seriesList=(0,s.without)(n.form.seriesList,e),delete n.options.seriesOptions[e]})}function o(e,t){n.options.columnMapping[t]=e}function l(e){o("unused",e)}n.currentTab="general",n.colors=(0,s.extend)({Automatic:null},e),n.stackingOptions={Disabled:null,Enabled:"normal",Percent:"percent"},n.changeTab=function(e){n.currentTab=e},n.chartTypes={line:{name:"Line",icon:"line-chart"},column:{name:"Bar",icon:"bar-chart"},area:{name:"Area",icon:"area-chart"},pie:{name:"Pie",icon:"pie-chart"},scatter:{name:"Scatter",icon:"circle-o"},bubble:{name:"Bubble",icon:"circle-o"}},t.allowCustomJSVisualizations&&(n.chartTypes.custom={name:"Custom",icon:"code"}),n.xAxisScales=["datetime","linear","logarithmic","category"],n.yAxisScales=["linear","logarithmic","datetime"],n.chartTypeChanged=function(){(0,s.keys)(n.options.seriesOptions).forEach(function(e){n.options.seriesOptions[e].type=n.options.globalSeriesType})},n.showSizeColumnPicker=function(){return(0,s.some)(n.options.seriesOptions,function(e){return"bubble"===e.type})},n.options.customCode="// Available variables are x, ys, element, and Plotly\n// Type console.log(x, ys); for more info about x and ys\n// To plot your graph call Plotly.plot(element, ...)\n// Plotly examples and docs: https://plot.ly/javascript/",r(),n.$watch("options.columnMapping",function(){"done"===n.queryResult.status&&i()},!0),n.$watch(function(){return[n.queryResult.getId(),n.queryResult.status]},function(e){e[0]&&"done"===e[1]&&(a(),i())},!0),n.form={yAxisColumns:[],seriesList:(0,s.sortBy)((0,s.keys)(n.options.seriesOptions),function(e){return n.options.seriesOptions[e].zIndex})},n.$watchCollection("form.seriesList",function(e){(0,s.each)(e,function(e,t){n.options.seriesOptions[e].zIndex=t,n.options.seriesOptions[e].index=0})}),n.$watchCollection("form.yAxisColumns",function(e,t){(0,s.each)(t,l),(0,s.each)(e,(0,s.partial)(o,"y"))}),n.$watch("form.xAxisColumn",function(e,t){void 0!==t&&l(t),void 0!==e&&o("x",e)}),n.$watch("form.errorColumn",function(e,t){void 0!==t&&l(t),void 0!==e&&o("yError",e)}),n.$watch("form.sizeColumn",function(e,t){void 0!==t&&l(t),void 0!==e&&o("size",e)}),n.$watch("form.groupby",function(e,t){void 0!==t&&l(t),void 0!==e&&o("series",e)}),(0,s.has)(n.options,"legend")||(n.options.legend={enabled:!0}),(0,s.has)(n.options,"bottomMargin")||(n.options.bottomMargin=50),n.columnNames&&(0,s.each)(n.options.columnMapping,function(e,t){n.columnNames.length>0&&!(0,s.contains)(n.columnNames,t)||("x"===e?n.form.xAxisColumn=t:"y"===e?n.form.yAxisColumns.push(t):"series"===e?n.form.groupby=t:"yError"===e?n.form.errorColumn=t:"size"===e&&(n.form.sizeColumn=t))})}}}i.$inject=["ColorPalette","clientConfig"],Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.component("colorBox",f),e.directive("chartRenderer",a),e.directive("chartEditor",i),e.config(["VisualizationProvider",function(e){var t='<chart-renderer options="visualization.options" query-result="queryResult"></chart-renderer>',n='<chart-editor options="visualization.options" query-result="queryResult"></chart-editor>',r={globalSeriesType:"column",sortX:!0,legend:{enabled:!0},yAxis:[{type:"linear"},{type:"linear",opposite:!0}],xAxis:{type:"datetime",labels:{enabled:!0}},error_y:{type:"data",visible:!0},series:{stacking:null,error_y:{type:"data",visible:!0}},seriesOptions:{},columnMapping:{},bottomMargin:50};e.registerVisualization({type:"CHART",name:"Chart",renderTemplate:t,editorTemplate:n,defaultOptions:r})}]),(0,l.default)(e)};var s=n(155),o=n(349),l=r(o),u=n(590),c=r(u),d=n(591),p=r(d),f={bindings:{color:"<"},template:"<span style='width: 12px; height: 12px; background-color: {{$ctrl.color}}; display: inline-block; margin-right: 5px;'></span>"}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function fillXValues(e){var t=(0,_underscore.sortBy)(_underscore.union.apply(void 0,_toConsumableArray((0,_underscore.pluck)(e,"x"))),_underscore.identity);e.forEach(function(e){e.x=(0,_underscore.sortBy)(e.x,_underscore.identity),(0,_underscore.each)(t,function(t,n){e.x[n]!==t&&(e.x.splice(n,0,t),e.y.splice(n,0,null))})})}function storeOriginalHeightForEachSeries(e){e.forEach(function(e){(0,_underscore.has)(e,"visible")||(e.visible=!0,e.original_y=e.y.slice())})}function getEnabledSeries(e){return e.filter(function(e){return e.visible===!0})}function initializeTextAndHover(e){e.forEach(function(e){e.text=[],e.hoverinfo="text+name"})}function normalAreaStacking(e){fillXValues(e),storeOriginalHeightForEachSeries(e),initializeTextAndHover(e);var t=getEnabledSeries(e);(0,_underscore.each)(t,function(e,t,n){(0,_underscore.each)(e.y,function(r,a){var i=t>0?n[t-1].y[a]:0,s=i+e.original_y[a];e.y[a]=s,e.text.push("Value: "+e.original_y[a]+"<br>Sum: "+s)})})}function lastVisibleY(e,t,n){for(var r=t;r>=0;r-=1)if(e[r].visible===!0)return e[r].y[n];return 0}function percentAreaStacking(e){0!==e.length&&(fillXValues(e),storeOriginalHeightForEachSeries(e),initializeTextAndHover(e),(0,_underscore.each)(e[0].y,function(t,n){var r=e.reduce(function(e,t){return e+t.original_y[n]},0);(0,_underscore.each)(e,function(t,a){var i=t.original_y[n]/r*100,s=lastVisibleY(e,a-1,n);t.y[n]=i+s,t.text.push("Value: "+t.original_y[n]+"<br>Relative: "+i.toFixed(2)+"%")})}))}function percentBarStacking(e){if(0!==e.length){fillXValues(e),initializeTextAndHover(e);for(var t=0;t<e[0].y.length;t+=1){for(var n=0,r=0;r<e.length;r+=1)n+=e[r].y[t];for(var a=0;a<e.length;a+=1){var i=e[a].y[t]/n*100;e[a].text.push("Value: "+e[a].y[t]+"<br>Relative: "+i.toFixed(2)+"%"),e[a].y[t]=i}}}}function normalizeValue(e){return _moment2.default.isMoment(e)?e.format("YYYY-MM-DD HH:mm:ss"):e}function seriesMinValue(e){return(0,_underscore.min)(e.map(function(e){return(0,_underscore.min)(e.y)}))}function seriesMaxValue(e){return(0,_underscore.max)(e.map(function(e){return(0,_underscore.max)(e.y)}))}function leftAxisSeries(e){return e.filter(function(e){return"y2"!==e.yaxis})}function rightAxisSeries(e){return e.filter(function(e){return"y2"===e.yaxis})}function getScaleType(e){return"datetime"===e?"date":"logarithmic"===e?"log":e}function getColor(e){return ColorPaletteArray[e%ColorPaletteArray.length]}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};exports.default=function(e){e.constant("ColorPalette",ColorPalette),e.directive("plotlyChart",PlotlyChart),e.directive("customPlotlyChart",CustomPlotlyChart)};var _underscore=__webpack_require__(155),_d=__webpack_require__(350),_d2=_interopRequireDefault(_d),_core=__webpack_require__(351),_core2=_interopRequireDefault(_core),_bar=__webpack_require__(555),_bar2=_interopRequireDefault(_bar),_pie=__webpack_require__(569),_pie2=_interopRequireDefault(_pie),_histogram=__webpack_require__(580),_histogram2=_interopRequireDefault(_histogram),_moment=__webpack_require__(42),_moment2=_interopRequireDefault(_moment);_core2.default.register([_bar2.default,_pie2.default,_histogram2.default]),_core2.default.setPlotConfig({modeBarButtonsToRemove:["sendDataToCloud"]});var BaseColors={Blue:"#4572A7",Red:"#AA4643",Green:"#89A54E",Purple:"#80699B",Cyan:"#3D96AE",Orange:"#DB843D","Light Blue":"#92A8CD",Lilac:"#A47D7C","Light Green":"#B5CA92",Brown:"#A52A2A",Black:"#000000",Gray:"#808080",Pink:"#FFC0CB","Dark Blue":"#00008b"},ColorPalette=_extends({},BaseColors,{"Indian Red":"#F8766D","Green 2":"#53B400","Green 3":"#00C094",DarkTurquoise:"#00B6EB","Dark Violet":"#A58AFF","Pink 2":"#FB61D7"}),ColorPaletteArray=(0,_underscore.values)(BaseColors),PlotlyChart=function(){var e=50;return{restrict:"E",template:"<div></div>",scope:{options:"=",series:"=",height:"="},link:function(t,n){function r(){var n=Math.max(t.height,t.height-50+e);return n}function a(e,n){"column"===n?e.type="bar":"line"===n?e.mode="lines":"area"===n?(e.fill=null===t.options.series.stacking?"tozeroy":"tonexty",e.mode="lines"):"scatter"===n?(e.type="scatter",e.mode="markers"):"bubble"===n&&(e.mode="markers")}function i(e){return(0,_underscore.isUndefined)(e)||(0,_underscore.isUndefined)(e.title)?null:e.title.text}function s(){if(t.data.length=0,t.layout.showlegend=!(0,_underscore.has)(t.options,"legend")||t.options.legend.enabled,(0,_underscore.has)(t.options,"bottomMargin")&&(e=parseInt(t.options.bottomMargin,10),t.layout.margin.b=e),delete t.layout.barmode,delete t.layout.xaxis,delete t.layout.yaxis,delete t.layout.yaxis2,"pie"===t.options.globalSeriesType){var n=(0,_underscore.contains)((0,
_underscore.values)(t.options.columnMapping),"x"),s=t.series.length>2?2:1,o=Math.ceil(t.series.length/s),l=1/o,u=1/s,c=.02,d=.05;return void(0,_underscore.each)(t.series,function(e,r){var a=r%o*l,i=Math.floor(r/o)*u,s={values:[],labels:[],type:"pie",hole:.4,marker:{colors:ColorPaletteArray},text:e.name,textposition:"inside",name:e.name,domain:{x:[a,a+l-c],y:[i,i+u-d]}};e.data.forEach(function(e){s.values.push(e.y),s.labels.push(n?e.x:"Slice "+r)}),t.data.push(s)})}var p=!1,f=t.options.sortX===!0||void 0===t.options.sortX,g=f&&"category"===t.options.xAxis.type,h=null;if(g&&(h=(0,_underscore.sortBy)(_underscore.union.apply(void 0,_toConsumableArray(t.series.map(function(e){return(0,_underscore.pluck)(e.data,"x")}))),_underscore.identity)),(0,_underscore.each)(t.series,function(e,n){var r=t.options.seriesOptions[e.name]||{type:t.options.globalSeriesType},i={x:[],y:[],error_y:{array:[]},name:r.name||e.name,marker:{color:r.color?r.color:getColor(n)}};1!==r.yAxis||null!==t.options.series.stacking&&"line"!==r.type||(p=!0,i.yaxis="y2"),a(i,r.type);var s=e.data;if(f&&(s=(0,_underscore.sortBy)(s,"x")),g&&0===n){var o={},l={};s.forEach(function(e){o[e.x]=e.y,e.yError&&(l[e.x]=e.yError)}),h.forEach(function(e){i.x.push(normalizeValue(e)),i.y.push(normalizeValue(o[e]||null)),(0,_underscore.isUndefined)(l[e])||i.error_y.array.push(normalizeValue(l[e]||null))})}else s.forEach(function(e){i.x.push(normalizeValue(e.x)),i.y.push(normalizeValue(e.y)),e.yError&&i.error_y.array.push(normalizeValue(e.yError))});i.error_y.length||delete i.error_y.length,"bubble"===r.type&&(i.marker={size:(0,_underscore.pluck)(s,"size")}),t.data.push(i)}),t.layout.xaxis={title:i(t.options.xAxis),type:getScaleType(t.options.xAxis.type)},(0,_underscore.isUndefined)(t.options.xAxis.labels)||(t.layout.xaxis.showticklabels=t.options.xAxis.labels.enabled),(0,_underscore.isArray)(t.options.yAxis)&&(t.layout.yaxis={title:i(t.options.yAxis[0]),type:getScaleType(t.options.yAxis[0].type)},(0,_underscore.isNumber)(t.options.yAxis[0].rangeMin)||(0,_underscore.isNumber)(t.options.yAxis[0].rangeMax))){var m=t.options.yAxis[0].rangeMin||Math.min(0,seriesMinValue(leftAxisSeries(t.data))),v=t.options.yAxis[0].rangeMax||seriesMaxValue(leftAxisSeries(t.data));t.layout.yaxis.range=[m,v]}if(p&&!(0,_underscore.isUndefined)(t.options.yAxis)){if(t.layout.yaxis2={title:i(t.options.yAxis[1]),type:getScaleType(t.options.yAxis[1].type),overlaying:"y",side:"right"},(0,_underscore.isNumber)(t.options.yAxis[1].rangeMin)||(0,_underscore.isNumber)(t.options.yAxis[1].rangeMax)){var b=t.options.yAxis[1].rangeMin||Math.min(0,seriesMinValue(rightAxisSeries(t.data))),y=t.options.yAxis[1].rangeMax||seriesMaxValue(rightAxisSeries(t.data));t.layout.yaxis2.range=[b,y]}}else delete t.layout.yaxis2;"normal"===t.options.series.stacking?(t.layout.barmode="stack","area"===t.options.globalSeriesType&&normalAreaStacking(t.data)):"percent"===t.options.series.stacking&&(t.layout.barmode="stack","area"===t.options.globalSeriesType?percentAreaStacking(t.data):"column"===t.options.globalSeriesType&&percentBarStacking(t.data)),t.layout.margin.b=e,t.layout.height=r()}t.$watch("series",s),t.$watch("options",s,!0),t.layout={margin:{l:50,r:50,b:e,t:20,pad:4},height:r(),autosize:!0},t.plotlyOptions={showLink:!1,displaylogo:!1},t.data=[];var o=n[0].children[0];_core2.default.newPlot(o,t.data,t.layout,t.plotlyOptions),o.on("plotly_afterplot",function(){"area"!==t.options.globalSeriesType||"normal"!==t.options.series.stacking&&"percent"!==t.options.series.stacking||document.querySelectorAll(".legendtoggle").forEach(function(e,n){_d2.default.select(e).on("click",function(){var e=t.data.length-1,r=t.data[e-n];r.visible=r.visible!==!0||"legendonly","normal"===t.options.series.stacking?normalAreaStacking(t.data):"percent"===t.options.series.stacking&&percentAreaStacking(t.data),_core2.default.redraw(o)})})}),t.$watch("layout",function(e,t){(0,_underscore.isEqual)(e,t)||_core2.default.relayout(o,e)},!0),t.$watch("data",function(e){(0,_underscore.isEmpty)(e)||_core2.default.redraw(o)},!0)}}},CustomPlotlyChart=function CustomPlotlyChart(clientConfig){var customChart={restrict:"E",template:"<div></div>",scope:{series:"=",options:"=",height:"="},link:function link(scope,element){if(clientConfig.allowCustomJSVisualizations){var refresh=function refresh(){var codeCall=eval("codeCall = function(x, ys, element, Plotly){ "+scope.options.customCode+" }");codeCall(scope.x,scope.ys,element[0].children[0],_core2.default)},timeSeriesToPlotlySeries=function(){scope.x=[],scope.ys={},(0,_underscore.each)(scope.series,function(e){scope.ys[e.name]=[],(0,_underscore.each)(e.data,function(t){scope.x.push(normalizeValue(t.x)),scope.ys[e.name].push(normalizeValue(t.y))})})};scope.$watch("options.customCode",function(){try{refresh()}catch(e){scope.options.enableConsoleLogs&&console.log("Error while executing custom graph: "+e)}},!0),scope.$watch("series",function(){timeSeriesToPlotlySeries(),refresh()},!0)}}};return customChart};CustomPlotlyChart.$inject=["clientConfig"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports="<div ng-if=\"plotlyOptions.globalSeriesType != 'custom'\">\n  <plotly-chart options='plotlyOptions' series='chartSeries' height=\"300\"></plotly-chart>\n</div>\n<div ng-if=\"plotlyOptions.globalSeriesType == 'custom'\">\n  <custom-plotly-chart series='chartSeries' options='plotlyOptions' height=\"300\"></custom-plotly-chart>\n</div>\n"},function(e,t){e.exports='<div>\n  <ul class="tab-nav">\n    <li ng-class="{active: currentTab == \'general\'}">\n      <a ng-click="changeTab(\'general\')">General</a>\n    </li>\n    <li ng-class="{active: currentTab == \'xAxis\'}" ng-if="options.globalSeriesType != \'custom\'">\n      <a ng-click="changeTab(\'xAxis\')">X Axis</a>\n    </li>\n    <li ng-class="{active: currentTab == \'yAxis\'}" ng-if="options.globalSeriesType != \'custom\'">\n      <a ng-click="changeTab(\'yAxis\')">Y Axis</a>\n    </li>\n    <li ng-class="{active: currentTab == \'series\'}" ng-if="options.globalSeriesType != \'custom\'">\n      <a ng-click="changeTab(\'series\')">Series</a>\n    </li>\n  </ul>\n  <div ng-show="currentTab == \'general\'">\n    <div class="form-group">\n      <label class="control-label">Chart Type</label>\n      <div ng-if="chartTypes"><!--the if is a weird workaround-->\n        <ui-select ng-model="options.globalSeriesType" on-select="chartTypeChanged()">\n          <ui-select-match placeholder="Choose chart type...">\n            <div>\n              <i class="fa fa-{{$select.selected.value.icon}}"></i>\n              {{$select.selected.value.name}}\n            </div>\n          </ui-select-match>\n          <ui-select-choices repeat="info.chartType as (chartType, info) in chartTypes">\n            <div><i class="fa fa-{{info.value.icon}}"></i><span> </span><span\n              ng-bind-html="info.value.name | highlight: $select.search"></span></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n    </div>\n\n\n    <div class="form-group" ng-class="{\'has-error\': chartEditor.xAxisColumn.$invalid}">\n      <label class="control-label">X Column</label>\n\n      <ui-select name="xAxisColumn" required ng-model="form.xAxisColumn">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.groupby">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <!-- not using regular validation (chartEditor.yAxisColumns.$invalid) due to a bug in ui-select with multiple choices-->\n    <div class="form-group" ng-class="{\'has-error\': !form.yAxisColumns || form.yAxisColumns.length == 0}">\n      <label class="control-label">Y Columns</label>\n\n      <ui-select multiple name="yAxisColumns" required ng-model="form.yAxisColumns">\n        <ui-select-match placeholder="Choose columns...">{{$item}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.groupby | remove:form.xAxisColumn">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType != \'custom\'">\n      <label class="control-label">Group by</label>\n      <ui-select name="groupby" ng-model="form.groupby" class="clearable">\n        <ui-select-match allow-clear="true" placeholder="Choose column...">\n          {{$select.selected}}\n        </ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.xAxisColumn">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group" ng-if="showSizeColumnPicker()">\n      <label class="control-label">Bubble size column</label>\n\n      <ui-select name="sizeColumn" ng-model="form.sizeColumn">\n        <ui-select-match allow-clear="true" placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.groupby">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType != \'custom\'">\n      <label class="control-label">Errors column</label>\n\n      <ui-select name="errorColumn" ng-model="form.errorColumn">\n        <ui-select-match allow-clear="true" placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.groupby">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="checkbox" ng-if="options.globalSeriesType != \'custom\'">\n      <label>\n        <input type="checkbox" ng-model="options.legend.enabled">\n        <i class="input-helper"></i> Show Legend\n      </label>\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType != \'custom\'">\n      <label class="control-label">Stacking</label>\n\n      <div ng-if="stackingOptions"><!--the if is a weird workaround-->\n        <ui-select ng-model="options.series.stacking"\n                   ng-disabled="[\'line\', \'area\', \'column\'].indexOf(options.globalSeriesType) == -1">\n          <ui-select-match placeholder="Choose Stacking...">{{$select.selected.key | capitalize}}</ui-select-match>\n          <ui-select-choices repeat="value.value as (key, value) in stackingOptions">\n            <div ng-bind-html="value.key | highlight: $select.search"></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n    </div>\n  </div>\n\n  <div class="form-group" ng-if="options.globalSeriesType == \'custom\'">\n    <label class="control-label">Custom code</label>\n    <textarea ng-model="options.customCode" class="form-control" rows="10">\n    </textarea>\n  </div>\n\n  <div class="checkbox" ng-if="options.globalSeriesType == \'custom\'">\n      <label>\n        <input type="checkbox" ng-model="options.enableConsoleLogs">\n        <i class="input-helper"></i> Show errors in the console\n      </label>\n    </div>\n\n\n  <div ng-show="currentTab == \'xAxis\'">\n    <div class="form-group">\n      <label class="control-label">Scale</label>\n      <ui-select ng-model="options.xAxis.type">\n        <ui-select-match placeholder="Choose Scale...">{{$select.selected | capitalize}}</ui-select-match>\n        <ui-select-choices repeat="scaleType in xAxisScales">\n          <div ng-bind-html="scaleType | capitalize | highlight: $select.search"></div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Name</label>\n      <input ng-model="options.xAxis.title.text" type="text" class="form-control"></input>\n    </div>\n\n    <div class="checkbox">\n      <label>\n        <input type="checkbox" ng-model="options.sortX">\n        <i class="input-helper"></i> Sort Values\n      </label>\n    </div>\n\n    <div class="checkbox">\n      <label>\n        <input type="checkbox" ng-model="options.xAxis.labels.enabled">\n        <i class="input-helper"></i> Show Labels\n      </label>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Height</label>\n      <input name="x-axis-height" type="number" class="form-control" ng-model="options.bottomMargin">\n    </div>\n  </div>\n\n  <div ng-show="currentTab == \'yAxis\'">\n    <div ng-repeat="yAxis in options.yAxis">\n      <h4>{{$index == 0 ? \'Left\' : \'Right\'}} Y Axis</h4>\n\n      <div class="form-group">\n        <label class="control-label">Scale</label>\n        <ui-select ng-model="yAxis.type">\n          <ui-select-match placeholder="Choose Scale...">{{$select.selected | capitalize}}</ui-select-match>\n          <ui-select-choices repeat="scaleType in yAxisScales">\n            <div ng-bind-html="scaleType | capitalize | highlight: $select.search"></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n      <div class="form-group">\n        <label class="control-label">Name</label>\n        <input ng-model="yAxis.title.text" type="text" class="form-control"></input>\n      </div>\n      <div class="form-group">\n        <label class="control-label">Min Value</label>\n        <input ng-model="yAxis.rangeMin" type="number" step="any" placeholder="Auto" class="form-control"></input>\n      </div>\n      <div class="form-group">\n        <label class="control-label">Max Value</label>\n        <input ng-model="yAxis.rangeMax" type="number" step="any" placeholder="Auto" class="form-control"></input>\n      </div>\n    </div>\n  </div>\n\n  <div ng-show="currentTab==\'series\'">\n    <table class="table table-condensed col-table">\n      <thead>\n      <th>zIndex</th>\n      <th>Left Y Axis</th>\n      <th>Right Y Axis</th>\n      <th>Label</th>\n      <th>Color</th>\n      <th>Type</th>\n      </thead>\n      <tbody ui-sortable ng-model="form.seriesList">\n      <tr ng-repeat="name in form.seriesList">\n        <td style="cursor: move;"><i class="fa fa-arrows-v"></i> <span\n          ng-bind="options.seriesOptions[name].zIndex + 1"></span></td>\n        <td>\n          <input type="radio" ng-value="0" ng-model="options.seriesOptions[name].yAxis">\n        </td>\n        <td>\n          <input type="radio" ng-value="1" ng-model="options.seriesOptions[name].yAxis">\n        </td>\n        <td style="padding: 3px; width: 140px;">\n          <input placeholder="{{name}}" class="form-control input-sm super-small-input" type="text"\n                 ng-model="options.seriesOptions[name].name">\n        </td>\n        <td style="padding: 3px; width: 35px;">\n          <ui-select ng-model="options.seriesOptions[name].color">\n            <ui-select-match>\n              <color-box color="$select.selected.value"></color-box>\n            </ui-select-match>\n            <ui-select-choices repeat="color.value as (key, color) in colors">\n              <color-box color="color.value"></color-box>\n              <span ng-bind-html="color.key | capitalize | highlight: $select.search"></span>\n            </ui-select-choices>\n          </ui-select>\n        </td>\n        <td style="padding: 3px; width: 105px;">\n          <ui-select ng-model="options.seriesOptions[name].type">\n            <ui-select-match placeholder="Chart Type">\n              <div>\n                <i class="fa fa-{{$select.selected.value.icon}}"></i>\n                {{$select.selected.value.name}}\n              </div>\n            </ui-select-match>\n            <ui-select-choices repeat="info.chartType as (chartType, info) in chartTypes">\n              <div><i class="fa fa-{{info.value.icon}}"></i><span> </span><span\n                ng-bind-html="info.value.name | highlight: $select.search"></span></div>\n            </ui-select-choices>\n          </ui-select>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",link:function(e,t){function n(){r.remove(),r=new u.default(e,t)}var r=new u.default(e,t);(0,o.default)(window).on("resize",n),e.$watch("visualization.options.height",function(e,t){e!==t&&n()})}}}function i(){return{restrict:"E",template:d.default}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("sunburstSequenceRenderer",a),e.directive("sunburstSequenceEditor",i),e.config(["VisualizationProvider",function(e){var t='<sunburst-sequence-renderer options="visualization.options" query-result="queryResult"></sunburst-sequence-renderer>',n="<sunburst-sequence-editor></sunburst-sequence-editor>",r={height:300};e.registerVisualization({type:"SUNBURST_SEQUENCE",name:"Sunburst Sequence",renderTemplate:t,editorTemplate:n,defaultOptions:r})}])};var s=n(157),o=r(s),l=n(593),u=r(l),c=n(594),d=r(c)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return g(e.name)}function i(e){for(var t=[],n=e;n.parent;)t.unshift(n),n=n.parent;return t}function s(e,t){function n(e,t){var n=[];return n.push("0,0"),n.push(x.w+",0"),n.push(x.w+x.t+","+x.h/2),n.push(x.w+","+x.h),n.push("0,"+x.h),t>0&&n.push(x.t+","+x.h/2),n.join(" ")}function r(e,t){var r=P.selectAll("g").data(e,function(e){return e.name+e.depth}),i=r.enter().append("g");i.append("polygon").classed("breadcrumbs-shape",!0).attr("points",n).attr("fill",a),i.append("text").classed("breadcrumbs-text",!0).attr("x",(x.w+x.t)/2).attr("y",x.h/2).attr("dy","0.35em").attr("font-size","10px").attr("text-anchor","middle").text(function(e){return e.name}),r.attr("transform",function(e,t){return"translate("+t*(x.w+x.s)+", 0)"}),r.exit().remove(),j.attr("x",(e.length+.5)*(x.w+x.s)).attr("y",x.h/2).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","black").attr("font-weight",600).text(t)}function s(e){var t=(100*e.value/$).toPrecision(3),n=t+"%";t<1&&(n="< 1.0%");var a=i(e);r(a,n),C.selectAll("path").attr("opacity",.3),C.selectAll("path").filter(function(e){return a.indexOf(e)>=0}).attr("opacity",1),M.html("Stage: "+e.depth+"<br />"+("<span class='percentage' style='font-size: 2em;'>"+n+"</span><br />"+e.value+" of "+$+"<br />")),M.style("visibility",""),P.style("visibility","")}function o(){C.selectAll("path").on("mouseover",null),C.selectAll("path").transition().duration(1e3).attr("opacity",1).each("end",function(){l.default.select(this).on("mouseover",s)}),P.style("visibility","hidden"),M.style("visibility","hidden")}function u(e){var t=A.nodes(e).filter(function(e){return e.dx>.005&&e.name!==f}),n=function(e){var t=[];return e.forEach(function(e){t.indexOf(e.name)===-1&&t.push(e.name)}),t}(t);g.domain(n);var r=C.data([e]).selectAll("path").data(t).enter().append("path").classed("nodePath",!0).attr("display",function(e){return e.depth?null:"none"}).attr("d",k).attr("fill",a).attr("opacity",1).attr("stroke","white").on("mouseover",s);z.on("click",o),$=r.node().__data__.value}function d(e){u(e)}function p(){C.selectAll(".nodePath").remove()}function h(e){var t=void 0;if(c.default.has(e[0],"sequence")&&c.default.has(e[0],"stage")&&c.default.has(e[0],"node")&&c.default.has(e[0],"value")){var n=c.default.groupBy(e,"sequence");t=c.default.map(n,function(e){var t=c.default.sortBy(e,"stage");return{size:e[0].value,sequence:e[0].sequence,nodes:c.default.pluck(t,"node")}})}else{var r=function(e){return"value"!==e&&0!==e.indexOf("$$")},a=c.default.sortBy(c.default.filter(c.default.keys(e[0]),r),c.default.identity);t=c.default.map(e,function(e,t){return{size:e.value,sequence:t,nodes:c.default.compact(c.default.map(a,function(t){return e[t]}))}})}return t}function m(e){var t=h(e),n={name:"root",children:[]};return t.forEach(function(e){for(var t=e.nodes,r=parseInt(e.size,10),a=n,i=function(e){var n=a.children,i=t[e],s=e+1===t.length;n||(a.children=n=[],n.push({name:f,size:a.size}));var o=c.default.find(n,function(e){return e.name===i});s&&o?o.children.push({name:f,size:r}):s?n.push({name:i,size:r}):(o||(o={name:i,children:[]},n.push(o)),a=o)},s=0;s<t.length;s+=1)i(s)}),n}function v(e){var t=m(e);p(),d(t)}function b(){var t=e.queryResult.getData();t&&v(t)}this.element=t,this.watches=[];var y=t[0].parentElement.clientWidth,w=e.visualization.options.height,_=Math.min(y,w)/2,x={w:y/6,h:30,s:3,t:10},q={top:_,bottom:50,left:_,right:0},$=0,A=l.default.layout.partition().size([2*Math.PI,_*_]).value(function(e){return e.size}),k=l.default.svg.arc().startAngle(function(e){return e.x}).endAngle(function(e){return e.x+e.dx}).innerRadius(function(e){return Math.sqrt(e.y)}).outerRadius(function(e){return Math.sqrt(e.y+e.dy)}),z=l.default.select(t[0]).append("div").classed("vis-container",!0).style("position","relative").style("margin-top","5px").style("height",w+2*x.h+"px"),P=z.append("div").classed("breadcrumbs-container",!0).append("svg").attr("width",y).attr("height",x.h).attr("fill","white").attr("font-weight",600),S=(y-2*_)/2,C=z.append("div").classed("sunburst-container",!0).style("z-index","2").style("left",S+"px").style("position","absolute").append("svg").attr("width",y).attr("height",w).append("g").attr("transform","translate("+q.left+","+q.top+")"),j=P.append("text").classed("lastCrumb",!0),M=z.append("div").classed("summary-container",!0).style("position","absolute").style("top",x.h+.8*_+"px").style("left",S+_/2+"px").style("width",_+"px").style("height",_+"px").style("text-align","center").style("font-size","11px").style("color","#666").style("z-index","1");b(),this.watches.push(e.$watch("visualization.options",b,!0)),this.watches.push(e.$watch("queryResult && queryResult.getData()",b))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(350),l=r(o),u=n(155),c=r(u),d=n(22),p=r(d),f="<<<Exit>>>",g=l.default.scale.category10();s.prototype.remove=function(){this.watches.forEach(function(e){e()}),p.default.element(this.element[0]).empty(".vis-container")}},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Height</label>\n    <div class="col-lg-6">\n      <input type="number" ng-model="visualization.options.height" min="1" class="form-control">\n    </div>\n  </div>\n  <div>\n    <hr>\n    This visualization expects the query result to have rows in one of the following formats:\n\n    <strong>Option 1:</strong>\n    <ul>\n      <li><strong>sequence</strong> - sequence id</li>\n      <li><strong>stage</strong> - what stage in sequence this is (1, 2, ...)</li>\n      <li><strong>node</strong> - stage name</li>\n      <li><strong>value</strong> - number of times this sequence occurred</li>\n    </ul>\n\n    <strong>Option 2:</strong>\n    <ul>\n      <li><strong>stage1</strong> - stage 1 value</li>\n      <li><strong>stage1</strong> - stage 2 value (or null)</li>\n      <li><strong>stage3</strong> - stage 3 value (or null)</li>\n      <li><strong>stage4</strong> - stage 4 value (or null)</li>\n      <li><strong>stage5</strong> - stage 5 value (or null)</li>\n      <li><strong>value</strong> - number of times this sequence occurred</li>\n    </ul>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=[];return e.sourceLinks.forEach(function(e){t.push(e.target)}),e.targetLinks.forEach(function(e){t.push(e.source)}),t}function i(e){function t(e){return e?e:"Exit"}function n(e,n){e=t(e);var r=e+":"+String(n),a=i[r];if(!a){a={name:e};var s=o.push(a)-1;a.id=s,i[r]=a}return a}function r(e,t){var n=s[[e,t]];return n||(n={target:t,source:e,value:0},s[[e,t]]=n),n}function a(e,t,a,i){if(""!==e&&e||!(i>1)){var s=n(e,i),o=n(t,i+1),l=r(s.id,o.id);l.value+=parseInt(a,10)}}var i={},s={},o=[],l=function(e){return"value"!==e&&0!==e.indexOf("$$")},u=f.default.sortBy(f.default.filter(f.default.keys(e[0]),l),f.default.identity);return e.forEach(function(e){a(e[u[0]],e[u[1]],e.value,1),a(e[u[1]],e[u[2]],e.value,2),a(e[u[2]],e[u[3]],e.value,3),a(e[u[3]],e[u[4]],e.value,4)}),{nodes:o,links:f.default.values(s)}}function s(e,t){var n=v.default.nest().key(function(e){return e.x}).entries(t.nodes).map(function(e){return e.values});n.forEach(function(t){t=f.default.filter(f.default.sortBy(t,function(e){return-e.value}),function(e){return"Exit"!==e.name});var n=v.default.sum(t,function(e){return e.dy}),r=(e-n)/t.length;f.default.reduce(t,function(e,t){return t.y=e,e+t.dy+r},0)})}function o(e,t,n){function r(e){var t=a(e);t=f.default.pluck(t,"id"),_.filter(function(n){return n!==e&&!f.default.contains(t,n.id)}).style("opacity",.2),w.filter(function(t){return!(f.default.include(e.sourceLinks,t)||f.default.include(e.targetLinks,t))}).style("opacity",.2)}function o(){_.style("opacity",1),w.style("opacity",1)}var l={top:10,right:10,bottom:10,left:10},u=(0,h.default)(e).parent().width()-l.left-l.right,c=t-l.top-l.bottom;n=i(n);var d=function(e){return v.default.format(",.0f")(e)},p=v.default.scale.category20(),g=v.default.select(e).append("svg").attr("class","sankey").attr("width",u+l.left+l.right).attr("height",c+l.top+l.bottom).append("g").attr("transform","translate("+l.left+","+l.top+")"),m=(0,y.default)().nodeWidth(15).nodePadding(10).size([u,c]),b=m.link();m.nodes(n.nodes).links(n.links).layout(0),s(c,n),m.relayout();var w=g.append("g").selectAll(".link").data(n.links).enter().append("path").filter(function(e){return"Exit"!==e.target.name}).attr("class","link").attr("d",b).style("stroke-width",function(e){return Math.max(1,e.dy)}).sort(function(e,t){return t.dy-e.dy});w.append("title").text(function(e){return e.source.name+"  "+e.target.name+"\n"+d(e.value)});var _=g.append("g").selectAll(".node").data(n.nodes).enter().append("g").filter(function(e){return"Exit"!==e.name}).attr("class","node").attr("transform",function(e){return"translate("+e.x+","+e.y+")"});_.on("mouseover",r).on("mouseout",o),_.append("rect").attr("height",function(e){return e.dy}).attr("width",m.nodeWidth()).style("fill",function(e){return e.color=p(e.name.replace(/ .*/,""))}).style("stroke",function(e){return v.default.rgb(e.color).darker(2)}).append("title").text(function(e){return e.name+"\n"+d(e.value)}),_.append("text").attr("x",-6).attr("y",function(e){return e.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(e){return e.name}).filter(function(e){return e.x<u/2}).attr("x",6+m.nodeWidth()).attr("text-anchor","start")}function l(){return{restrict:"E",link:function(e,t){function n(){var n=e.queryResult.getData();n&&(d.default.element(t[0]).empty(),o(t[0],e.visualization.options.height,n))}d.default.element(window).on("resize",n),e.$watch("queryResult && queryResult.getData()",n),e.$watch("visualization.options.height",function(e,t){e!==t&&n()})}}}function u(){return{restrict:"E",template:_.default}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("sankeyRenderer",l),e.directive("sankeyEditor",u),e.config(["VisualizationProvider",function(e){var t='<sankey-renderer options="visualization.options" query-result="queryResult"></sankey-renderer>',n="<sankey-editor></sankey-editor>",r={height:300};e.registerVisualization({type:"SANKEY",name:"Sankey",renderTemplate:t,editorTemplate:n,defaultOptions:r})}])};var c=n(22),d=r(c),p=n(155),f=r(p),g=n(157),h=r(g),m=n(350),v=r(m),b=n(596),y=r(b),w=n(597),_=r(w)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return e.y+e.dy/2}function i(e){return e.value}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(){g.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),h.forEach(function(e){var t=e.source,n=e.target;"number"==typeof t&&(t=e.source=g[e.source]),"number"==typeof n&&(n=e.target=g[e.target]),t.sourceLinks.push(e),n.targetLinks.push(e)})}function t(){g.forEach(function(e){e.value=Math.max(o.default.sum(e.sourceLinks,i),o.default.sum(e.targetLinks,i))})}function n(e){g.forEach(function(t){t.sourceLinks.length||(t.x=e-1)})}function r(e){g.forEach(function(t){t.x*=e})}function s(){function e(e){e.x=i,e.dx=d,e.sourceLinks.forEach(function(e){a.indexOf(e.target)<0&&a.push(e.target)})}for(var t=g,a=void 0,i=0;t.length;)a=[],t.forEach(e),t=a,i+=1;n(i),r((f[0]-d)/(i-1))}function l(e){function t(){var e=o.default.min(u,function(e){return(f[1]-(e.length-1)*p)/o.default.sum(e,i)});u.forEach(function(t){t.forEach(function(t,n){t.y=n,t.dy=t.value*e})}),h.forEach(function(t){t.dy=t.value*e})}function n(e){function t(e){return a(e.source)*e.value}u.forEach(function(n){n.forEach(function(n){if(n.targetLinks.length){var r=o.default.sum(n.targetLinks,t)/o.default.sum(n.targetLinks,i);n.y+=(r-a(n))*e}})})}function r(){u.forEach(function(e){var t=e.length,n=void 0,r=void 0,a=0,i=void 0;for(e.sort(l),i=0;i<t;++i)n=e[i],r=a-n.y,r>0&&(n.y+=r),a=n.y+n.dy+p;if(r=a-p-f[1],r>0)for(a=n.y-=r,i=t-2;i>=0;--i)n=e[i],r=n.y+n.dy+p-a,r>0&&(n.y-=r),a=n.y})}function r(){u.forEach(function(e){var t=void 0,n=void 0,r=0,a=e.length,i=void 0;for(e.sort(l),i=0;i<a;++i)t=e[i],n=r-t.y,n>0&&(t.y+=n),r=t.y+t.dy+p;if(n=r-p-f[1],n>0)for(r=t.y-=n,i=a-2;i>=0;--i)t=e[i],n=t.y+t.dy+p-r,n>0&&(t.y-=n),r=t.y})}function s(e){function t(e){return a(e.target)*e.value}u.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var r=o.default.sum(n.sourceLinks,t)/o.default.sum(n.sourceLinks,i);n.y+=(r-a(n))*e}})})}function l(e,t){return e.y-t.y}var u=o.default.nest().key(function(e){return e.x}).sortKeys(o.default.ascending).entries(g).map(function(e){return e.values});t(),r();for(var c=1;e>0;e-=1)s(c*=.99),r(),n(c),r()}function u(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}g.forEach(function(n){n.sourceLinks.sort(t),n.targetLinks.sort(e)}),g.forEach(function(e){var t=0,n=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=n,n+=e.dy})})}var c={},d=24,p=8,f=[1,1],g=[],h=[];return c.nodeWidth=function(e){return arguments.length?(d=+e,c):d},c.nodePadding=function(e){return arguments.length?(p=+e,c):p},c.nodes=function(e){return arguments.length?(g=e,c):g},c.links=function(e){return arguments.length?(h=e,c):h},c.size=function(e){return arguments.length?(f=e,c):f},c.layout=function(n){return e(),t(),s(),l(n),u(),c},c.relayout=function(){return u(),c},c.link=function(){function e(e){var t=e.source.x+e.source.dx,r=e.target.x,a=o.default.interpolateNumber(t,r),i=a(n),s=a(1-n),l=e.source.y+e.sy+e.dy/2,u=e.target.y+e.ty+e.dy/2;return"M"+t+","+l+"C"+i+","+l+" "+s+","+u+" "+r+","+u}var t=arguments,n=.5;return e.curvature=function(r){return t.length?(n=+r,e):n},e},c};var s=n(350),o=r(s)},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Height</label>\n    <div class="col-lg-6">\n      <input type="number" ng-model="visualization.options.height" min="1" class="form-control">\n    </div>\n  </div>\n  <div>\n    <hr>\n    This visualization expects the query result to have rows in the following format:\n\n    <ul>\n      <li><strong>stage1</strong> - stage 1 value</li>\n      <li><strong>stage1</strong> - stage 2 value (or null)</li>\n      <li><strong>stage3</strong> - stage 3 value (or null)</li>\n      <li><strong>stage4</strong> - stage 4 value (or null)</li>\n      <li><strong>stage5</strong> - stage 5 value (or null)</li>\n      <li><strong>value</strong> - number of times this sequence occurred</li>\n    </ul>\n  </div>\n</div>\n';
},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};return e.forEach(function(e){var r=e[t].toString().split(" ");r.forEach(function(e){e in n?n[e]+=1:n[e]=1})}),n}function i(){return{restrict:"E",link:function(e,t){function n(){function n(e){l.default.select(t[0].parentNode).select("svg").remove(),l.default.select(t[0].parentNode).append("svg").attr("width",u.size()[0]).attr("height",u.size()[1]).append("g").attr("transform","translate("+u.size()[0]/2+","+u.size()[1]/2+")").selectAll("text").data(e).enter().append("text").style("font-size",function(e){return e.size+"px"}).style("font-family","Impact").style("fill",function(e,t){return o(t)}).attr("text-anchor","middle").attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}).text(function(e){return e.text})}if(c.default.isDefined(e.queryResult)){var r=e.queryResult.getData(),i={};e.visualization.options.column&&(i=a(r,e.visualization.options.column));var s=[];(0,f.each)(i,function(e,t){s.push({text:t,size:10+Math.pow(e,2)})});var o=l.default.scale.category20(),u=(0,p.default)().size([500,500]).words(s).padding(5).rotate(function(){return 90*Math.floor(2*Math.random())}).font("Impact").fontSize(function(e){return e.size});u.on("end",n),u.start()}}e.$watch("queryResult && queryResult.getData()",n),e.$watch("visualization.options.column",n)}}}function s(){return{restrict:"E",template:h.default}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("wordCloudEditor",s),e.directive("wordCloudRenderer",i),e.config(["VisualizationProvider",function(e){e.registerVisualization({type:"WORD_CLOUD",name:"Word Cloud",renderTemplate:'<word-cloud-renderer options="visualization.options" query-result="queryResult"></word-cloud-renderer>',editorTemplate:"<word-cloud-editor></word-cloud-editor>"})}])};var o=n(350),l=r(o),u=n(22),c=r(u),d=n(599),p=r(d),f=n(155),g=n(601),h=r(g)},,,function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Word Cloud Column Name</label>\n    <div class="col-lg-6">\n      <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.column" class="form-control"></select>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",template:"<div></div>",link:function(e,t){function n(e){return function(t){for(var n=t.quartiles[0],r=t.quartiles[2],a=(r-n)*e,i=-1,s=t.length;t[++i]<n-a;);for(;t[--s]>r+a;);return[i,s]}}e.$watch("[queryResult && queryResult.getData(), visualization.options]",function(){function r(e){return y(b[e])+(y(b[1])-s.inner)/2}if(null!==e.queryResult.getData()){var a=e.queryResult.getData(),i=o.default.select(t[0].parentNode).node().getBoundingClientRect().width,s={top:10,right:50,bottom:40,left:50,inner:25},l=i-s.right-s.left,c=500-s.top-s.bottom,d=1/0,p=-(1/0),f=[],g=0,h=[],m=e.visualization.options.xAxisLabel,v=e.visualization.options.yAxisLabel,b=e.queryResult.getColumnNames(),y=o.default.scale.ordinal().domain(b).rangeBands([0,i-s.left-s.right]),w=void 0;w=b.length>1?Math.min(y(b[1]),120):120,s.inner=w/3,b.forEach(function(e,t){h=f[t]=[],a.forEach(function(t){g=t[e],h.push(g),g>p&&(p=Math.ceil(g)),g<d&&(d=Math.floor(g))})});var _=o.default.scale.linear().domain([.99*d,1.01*p]).range([c,0]),x=(0,u.default)().whiskers(n(1.5)).width(w-2*s.inner).height(c).domain([.99*d,1.01*p]),q=o.default.svg.axis().scale(y).orient("bottom"),$=o.default.svg.axis().scale(_).orient("left"),A=o.default.svg.axis().scale(y).tickSize(c).orient("bottom"),k=o.default.svg.axis().scale(_).tickSize(l).orient("right");o.default.select(t[0]).selectAll("svg").remove();var z=o.default.select(t[0]).append("svg").attr("width",i).attr("height",c+s.bottom+s.top).append("g").attr("width",i-s.left-s.right).attr("transform","translate("+s.left+","+s.top+")");o.default.select("svg").append("text").attr("class","box").attr("x",i/2).attr("text-anchor","middle").attr("y",c+s.bottom).text(m),o.default.select("svg").append("text").attr("class","box").attr("transform","translate(10,"+(c+s.top+s.bottom)/2+")rotate(-90)").attr("text-anchor","middle").text(v),z.append("rect").attr("class","grid-background").attr("width",l).attr("height",c),z.append("g").attr("class","grid").call(k),z.append("g").attr("class","grid").call(A),z.append("g").attr("class","x axis").attr("transform","translate(0,"+c+")").call(q),z.append("g").attr("class","y axis").call($),z.selectAll(".box").data(f).enter().append("g").attr("class","box").attr("width",w).attr("height",c).attr("transform",function(e,t){return"translate("+r(t)+",0)"}).call(x)}},!0)}}}function i(){return{restrict:"E",template:d.default}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("boxplotRenderer",a),e.directive("boxplotEditor",i),e.config(["VisualizationProvider",function(e){var t='<boxplot-renderer options="visualization.options" query-result="queryResult"></boxplot-renderer>',n="<boxplot-editor></boxplot-editor>";e.registerVisualization({type:"BOXPLOT",name:"Boxplot",renderTemplate:t,editorTemplate:n})}])};var s=n(350),o=r(s),l=n(603),u=r(l),c=n(604),d=r(c)},function(e,t){"use strict";function n(){function e(e){e.each(function(e,r){e=e.map(o).sort(d3.ascending);var a=d3.select(this),d=e.length,p=e[0],f=e[d-1],g=e.quartiles=u(e),h=l&&l.call(this,e,r),m=h&&h.map(function(t){return e[t]}),v=h?d3.range(0,h[0]).concat(d3.range(h[1]+1,d)):d3.range(d),b=d3.scale.linear().domain(s&&s.call(this,e,r)||[p,f]).range([n,0]),y=this.__chart__||d3.scale.linear().domain([0,1/0]).range(b.range());this.__chart__=b;var w=a.selectAll("line.center").data(m?[m]:[]);w.enter().insert("line","rect").attr("class","center").attr("x1",t/2).attr("y1",function(e){return y(e[0])}).attr("x2",t/2).attr("y2",function(e){return y(e[1])}).style("opacity",1e-6).transition().duration(i).style("opacity",1).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}),w.transition().duration(i).style("opacity",1).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}),w.exit().transition().duration(i).style("opacity",1e-6).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}).remove();var _=a.selectAll("rect.box").data([g]);_.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(e){return y(e[2])}).attr("width",t).attr("height",function(e){return y(e[0])-y(e[2])}).transition().duration(i).attr("y",function(e){return b(e[2])}).attr("height",function(e){return b(e[0])-b(e[2])}),_.transition().duration(i).attr("y",function(e){return b(e[2])}).attr("height",function(e){return b(e[0])-b(e[2])}),_.exit().remove();var x=a.selectAll("line.median").data([g[1]]);x.enter().append("line").attr("class","median").attr("x1",0).attr("y1",y).attr("x2",t).attr("y2",y).transition().duration(i).attr("y1",b).attr("y2",b),x.transition().duration(i).attr("y1",b).attr("y2",b),x.exit().remove();var q=a.selectAll("line.whisker").data(m||[]);q.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",y).attr("x2",t).attr("y2",y).style("opacity",1e-6).transition().duration(i).attr("y1",b).attr("y2",b).style("opacity",1),q.transition().duration(i).attr("y1",b).attr("y2",b).style("opacity",1),q.exit().transition().duration(i).attr("y1",b).attr("y2",b).style("opacity",1e-6).remove();var $=a.selectAll("circle.outlier").data(v,Number);$.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",t/2).attr("cy",function(t){return y(e[t])}).style("opacity",1e-6).transition().duration(i).attr("cy",function(t){return b(e[t])}).style("opacity",1),$.transition().duration(i).attr("cy",function(t){return b(e[t])}).style("opacity",1),$.exit().transition().duration(i).attr("cy",function(t){return b(e[t])}).style("opacity",1e-6).remove();var A=c||b.tickFormat(8),k=a.selectAll("text.box").data(g);k.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(e,t){return 1&t?6:-6}).attr("x",function(e,n){return 1&n?t:0}).attr("y",y).attr("text-anchor",function(e,t){return 1&t?"start":"end"}).text(A).transition().duration(i).attr("y",b),k.transition().duration(i).text(A).attr("y",b),k.exit().remove();var z=a.selectAll("text.whisker").data(m||[]);z.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",t).attr("y",y).text(A).style("opacity",1e-6).transition().duration(i).attr("y",b).style("opacity",1),z.transition().duration(i).text(A).attr("y",b).style("opacity",1),z.exit().transition().duration(i).attr("y",b).style("opacity",1e-6).remove()}),d3.timer.flush()}var t=1,n=1,i=0,s=null,o=Number,l=r,u=a,c=null;return e.width=function(n){return arguments.length?(t=n,e):t},e.height=function(t){return arguments.length?(n=t,e):n},e.tickFormat=function(t){return arguments.length?(c=t,e):c},e.duration=function(t){return arguments.length?(i=t,e):i},e.domain=function(t){return arguments.length?(s=null==t?t:d3.functor(t),e):s},e.value=function(t){return arguments.length?(o=t,e):o},e.whiskers=function(t){return arguments.length?(l=t,e):l},e.quartiles=function(t){return arguments.length?(u=t,e):u},e}function r(e){return[0,e.length-1]}function a(e){return[d3.quantile(e,.25),d3.quantile(e,.5),d3.quantile(e,.75)]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">X Axis Label</label>\n    <div class="col-lg-6">\n      <input type="text" ng-model="visualization.options.xAxisLabel" class="form-control"></input>\n    </div>\n  </div>\n\n  <div class="form-group">\n    <label class="col-lg-6">Y Axis Label</label>\n    <div class="col-lg-6">\n      <input type="text" ng-model="visualization.options.yAxisLabel" class="form-control"></input>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",scope:{queryResult:"=",options:"="},template:"",replace:!1,link:function(e,t){function n(){if(null!==e.queryResult.getData()){var n=o.default.sortBy(e.queryResult.getData(),function(e){return e.date+e.day_number}),r=o.default.groupBy(n,"date"),a=o.default.reduce(r,function(e,t){return t.length>e?t.length:e},0),i=o.default.map(r,function(e){var t=[e[0].total];return o.default.each(e,function(e){t.push(e.value)}),o.default.each(o.default.range(e.length,a),function(){t.push(null)}),t}),s=(0,u.default)(n[0].date).toDate(),l=d.default.element(t)[0];Cornelius.draw({initialDate:s,container:l,cohort:i,title:null,timeInterval:e.options.timeInterval,labels:{time:"Time",people:"Users",weekOf:"Week of"}})}}e.options.timeInterval=e.options.timeInterval||"daily",e.$watch("queryResult && queryResult.getData()",n),e.$watch("options.timeInterval",n)}}}function i(){return{restrict:"E",template:f.default}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("cohortRenderer",a),e.directive("cohortEditor",i),e.config(["VisualizationProvider",function(e){var t="<cohort-editor></cohort-editor>",n={timeInterval:"daily"};e.registerVisualization({type:"COHORT",name:"Cohort",renderTemplate:'<cohort-renderer options="visualization.options" query-result="queryResult"></cohort-renderer>',editorTemplate:t,defaultOptions:n})}])};var s=n(155),o=r(s),l=n(42),u=r(l),c=n(22),d=r(c);n(606),n(607);var p=n(608),f=r(p)},,1,function(e,t){e.exports='<div class="form-group">\n    <label class="control-label">Time Interval</label>\n    <select class="form-control" ng-model="visualization.options.timeInterval">\n      <option value="daily">Daily</option>\n      <option value="weekly">Weekly</option>\n      <option value="monthly">Monthly</option>\n    </select>\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",template:_.default,link:function(e,t){function n(){e.visualization.options.bounds=g.getBounds()}function r(){var t=e.visualization.options.bounds;if(t)g.fitBounds([[t._southWest.lat,t._southWest.lng],[t._northEast.lat,t._northEast.lng]]);else if(m){var n=o.default.flatten(o.default.map(o.default.values(m),function(e){return e.getLayers()})),r=new f.default.featureGroup(n);g.fitBounds(r.getBounds())}}function a(){g&&(g.invalidateSize(!1),r())}function i(e,t,n){var r=n[e],a=n[t],i='<ul style="list-style-type: none;padding-left: 0">';return i+="<li><strong>"+r+", "+a+"</strong>",o.default.each(n,function(n,r){r!==e&&r!==t&&(i+="<li>"+r+": "+n+"</li>")}),i}function s(e){e&&(h.removeLayer(e),g.removeLayer(e))}function l(t,n){var r=e.visualization.options.latColName||"lat",a=e.visualization.options.lonColName||"lon",s=e.visualization.options.classify,l=void 0;if(e.visualization.options.clusterMarkers){var u=e.visualization.options.groups[t].color,c={};s&&(c.iconCreateFunction=function(e){var t=e.getChildCount(),n=" marker-cluster-";n+=t<10?"small":t<100?"medium":"large",n="";var r="color: white; background-color: "+u+";";return f.default.divIcon({html:'<div style="'+r+'"><span>'+t+"</span></div>",className:"marker-cluster"+n,iconSize:new f.default.Point(40,40)})}),l=f.default.markerClusterGroup(c)}else l=f.default.layerGroup();o.default.each(n,function(n){var o=void 0,u=n[r],c=n[a];if(null!==u&&null!==c){if(s&&"none"!==s){var d=e.visualization.options.groups[t].color;o=y(u,c,d)}else o=b(u,c);o.bindPopup(i(r,a,n)),l.addLayer(o)}}),l.addTo(g),m[t]=l,h.addOverlay(l,t)}function c(){var t=e.queryResult.getData(),n=e.visualization.options.classify;if(e.visualization.options.mapTileUrl=e.visualization.options.mapTileUrl||"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",v.setUrl(e.visualization.options.mapTileUrl),void 0===e.visualization.options.clusterMarkers&&(e.visualization.options.clusterMarkers=!0),t){var a=void 0;a=n&&"none"!==n?o.default.groupBy(t,n):{All:t};var i=o.default.keys(a),u=o.default.map(i,function(t){return e.visualization.options.groups&&e.visualization.options.groups[t]?e.visualization.options.groups[t]:{color:p(t)}});e.visualization.options.groups=o.default.object(i,u),o.default.each(m,function(e){s(e)}),o.default.each(a,function(e,t){l(t,e)}),r()}}var p=u.default.scale.category10(),g=f.default.map(t[0].children[0].children[0],{scrollWheelZoom:!1}),h=f.default.control.layers().addTo(g),m={},v=f.default.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(g);g.on("focus",function(){g.on("moveend",n)}),g.on("blur",function(){g.off("moveend",n)});var b=function(e,t){return f.default.marker([e,t])},y=function(e,t,n){var r={fillColor:n,fillOpacity:.9,stroke:!1};return f.default.circleMarker([e,t],r)};e.$watch("queryResult && queryResult.getData()",c),e.$watch("visualization.options",c,!0),d.default.element(window).on("resize",a),e.$watch("visualization.options.height",a)}}}function i(){return{restrict:"E",template:q.default,link:function(e){e.currentTab="general",e.columns=e.queryResult.getColumns(),e.columnNames=o.default.pluck(e.columns,"name"),e.classify_columns=e.columnNames.concat("none"),e.mapTiles=[{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"OpenStreetMap BW",url:"//{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png"},{name:"OpenStreetMap DE",url:"//{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png"},{name:"OpenStreetMap FR",url:"//{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png"},{name:"OpenStreetMap Hot",url:"//{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"},{name:"Thunderforest",url:"//{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png"},{name:"Thunderforest Spinal",url:"//{s}.tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png"},{name:"OpenMapSurfer",url:"//korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}"},{name:"Stamen Toner",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"},{name:"Stamen Toner Background",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png"},{name:"Stamen Toner Lite",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png"},{name:"OpenTopoMap",url:"//{s}.tile.opentopomap.org/{z}/{x}/{y}.png"}]}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.directive("mapRenderer",a),e.directive("mapEditor",i),e.config(["VisualizationProvider",function(e){var t='<map-renderer options="visualization.options" query-result="queryResult"></map-renderer>',n="<map-editor></map-editor>",r={height:500,classify:"none",clusterMarkers:!0};e.registerVisualization({type:"MAP",name:"Map",renderTemplate:t,editorTemplate:n,defaultOptions:r})}])};var s=n(155),o=r(s),l=n(350),u=r(l),c=n(22),d=r(c),p=n(610),f=r(p);n(611),n(612),n(616),n(617);var g=n(615),h=r(g),m=n(618),v=r(m),b=n(619),y=r(b),w=n(620),_=r(w),x=n(621),q=r(x);f.default.Icon.Default.mergeOptions({iconUrl:h.default,iconRetinaUrl:v.default,shadowUrl:y.default}),delete f.default.Icon.Default.prototype._getIconUrl},,,1,,,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII="},1,1,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7c3grY3grg8hJo3grY4g7c4g7c3grU0gLI4grY9hrpBi79HkMM2frE0daA0fq82gbROlslbo9Vgp9dcpNZQmcxFjsIwd6QzeKk3gbRfptdepdZcpdY2gLMtd5s3gLNZotVSntNPnNJLmtFImdBZodU1f7A2f7A1frA2f7I2f7FHmNBUnM9Wn9VGmNAydaNYoNJOm9M9hLc0e6w3fa46f7BKmdFFltBVndE1fK1Els82fq41fK1Dlc89g7RClc9XoNVUndQ0eqxClM9Jl9FRms81eqo0eqpHltFBk89Fi75Qm9M/k89KkcYzealSjbadvdPH2ufz9/r4+vzP3+qlxNljmL08gLNSnNQzeKgydqUzeKg/ks6NtM/////+/v8+kc/f6fFAgK1CiLwydKIzd6c8kM6Tt9C1zd5OmdNBh7pTjLRzn78xdKIydqU7j86jwdbM3egxdKIydaQydaMydKNGlNE6js5OiLAxc6FKkshDk9E5jc09e6Zekrcxc6I4jc03eagyc6FIldI3jM0wcaBMl9J+psNKltIwcZ82i83k7fMubJhLlc81is1Lg6pklbZNl9I/j9AvbJlEjcVdkLPt8/cwcZ4ubZkwcJ00icy0y9swcJwvb5wzicxHkcpTh60ubZhCkNAyiMwvbpoxh8xAicBHj8hGk9FHks0+jdAubJcubJdEkdEwhsw6i88ubJgta5cvhswxapgubJcuhcstbJcubZcuhMsubJcvbJZBjMgthMsubJcvbZkubJcrg8stbJctbZcubJgrgssua5gubJc6is8qgcs8i9A9iMYtg8spgcoogMo7hcMrbZcubJcngMonf8olfsoubJc4gr8kfckua5g5iM8jfMk4iM8he8k1froua5g7itAgeskubJc2hs8eecgzfLcofssdeMg0hc4ubJccd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqjbZ8obAAAA7HRSTlMAHDdTb4yPA+L/7ZxE/////yYLgvb///////8SYf/////qB/////////+1wNHd//////8s////r/////////+O/P///////////8f///////////////////////+P2P///////////3f//////////5j/////tczn//////L///////////////////////8+////////R/////Ww////tf////9q////////////4P/////Yd/8W+P/xov+UNv///STN/7hc1P/AUv//////////MMT///+m//+e//////+M//+C////////6cqo94AAAAXmSURBVHgBrNKDoipBGADgbHMRpjuKi2xOdu//MHe2Y6tvOdZvuhGzxWqzO2xWi9lp+g6L3eV+5PH6vmpltrv8nDsQDIWCAbef83jDpo9FojFeJxhPJO8JosQzYnb5oxYpVzodiCcyhiwA2esPEAPpdM727vT+eSH0x7McwoTmOUpxIcvF/RAWI29byCUIpUQ2m8A0/xwx8kIQls2vW4QrihIHQMDqGyQBgAiVnOXVTuWUtAaAnq++I48B0PxKrPZiq8qKvy4IpPqBhiDUm0rl+ca12h1NQN3eh7pI6MN26WnfooNBPIHU4SdUlBAHg9Hj0seDEEJ08pxKqfoio4tQaDAOP0xrMEWIzB4NCWaIK8xJ7ymXItQcFO/jcLGIF+bLRytW4LS18Wbd5SNcEBcLn8mw2TYZ2+3vLRuMaYdme7sdTA8iY8flQ0mPscC2fB1ku12z4+necs7YebDlri9JZ3rvoazB1tutxdiuy1TXl4/Zer95ufzneq7524qBAIBr61TmtxXX/MK4FC6cKIwvViozXMDMzLbCTF+1JBn/4/EtLi2vrK6tbywsbE506vVxnZ3fF7YIIQamdX7dVqb/RtnCr1X+n3F9gA2MdA7Vsl87nzEDId2MTUCHSdr+As/Y1DKvM1uYFWBGpTtggrFuYrMPApgc0jhMTNmdvInLbn8NqNImgEG7jWzZnwB1KAg79t1V3mzPvgm6Q+n9m98n/e5ZQI+iw6Dby1v43AzApPIIs24/Cbg1GFcRE+h29xpvseJ2v4cxjzQOmjtAgqF5PRyRZvTXIfcqbxUNPdOnI1JYnw8FSSwUp4mklKDzoRRvkw7N0vF6QTwUI4aMRsNZyUQnMhkzb2HMZeJ0RhUMUy1jIP68lRaKUpLSXN7FW5jz+QnqKEoFas37yX6pD8tFpYybpQpv4S3lEGv5KvaV9olNDPwNHUhh1ETex5scpsQOVg8UxAFhI0dCHKPjRIogDorT1aZPzkTuHC9U2oPnQlySRzFxhYkTJYHHIXFt5srNnhBxLDSyV+L2IyF395vnhQflpHCuifv80g3/a+UPIXWNEDEAQEE0HR23weEk6XGnwR1iH3eJu7udbt26fe30I17x/PYH+9iv+CB5qT1v+YhlL5WeS5ZV72RZftvlNF6Wj75Zdn2kHcl6e5Sy/A3D7DsBMP0gd/DkC/Bp9l3gW5Y7a5asWVCm3WcaAFSHnFtxAXivwwAsWf9E25dl+TiwhwIKPVRgD33Ct6wvom0ijKapOBllpkEcf6ZCMsqjyCgjuvKIoajXYgya8vhIJ7rKKnKOP+sxjOPJZmV0DRRHGIZx/KW6npaOvor3M/G+pqalS00TT5q4G7qzPGe4O+wu7mxw59wt8p3LCre//pn/J+iupIwe1HKcpVdXI8c9QB9l9QMDnHVQF8+9xdAw5YzgBmfuHdVh4bj7GKO8cZYxW/UmvHkAeEl5pgncMJt7JzVZzOYaTFGh6WRGEDVJ5pniCDOCWw0Ns3MaLA0NdRijYm+AmQZhXoO1YQFYpBJLqGloGF1W1ZuMfKRSL1OZFVXJyNBlUhhD7evXk6sqZl+/rscaKfUDC68FtYn19Xr64xU+oo7nxQ2FWZ6vxyapuTyEdV5WTgR+HZ3DpGoN9Szzu8Qkzz9CH6kbZhlpa7uELO2gs4I0bOKRJInFC1GyPsMuaanoxPre1n6hbXlvB90dpKkPj4Q9sXAi7gnfcEDaOjqxIxwe5e1vCcforiIdu/gkyyenOSeyrBthqrpxvHV2lF0cHW4d47ySdB3g29bWiSPjZMvZBDvpqzxPZk7Ti9PDLZcyomBHk/PwxJ1ycsgiv4guzrgOz9wexn126EVbNV3oVzLj8zBaEYXqNnjP/G4W8Z8F0GYiKisTPGMZ31kQGKdymGwIhMIeTzgUgM1EZRkHgmGfL8wi01Qe0wQCYSaAESrXNBCJRiN6EYURxKLRmF5E4Q0QjwNvyIAlJBKYIiNegnlJhowBY2RMP9BPBn38SEYtLpKG/+tgQe8M5cY7AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"},function(e,t){e.exports="<div style='margin:1%;width:98%;height:{{visualization.options.height}}px'>\n    <div style=\"width:100%; height:100%;\"></div>\n</div>\n"},function(e,t){e.exports='<div>\n  <ul class="tab-nav">\n    <li ng-class="{active: currentTab == \'general\'}"><a ng-click="currentTab=\'general\'">General</a></li>\n    <li ng-class="{active: currentTab == \'groups\'}"><a ng-click="currentTab=\'groups\'">Groups</a></li>\n    <li ng-class="{active: currentTab == \'map\'}"><a ng-click="currentTab=\'map\'">Map Settings</a></li>\n  </ul>\n\n  <div ng-show="currentTab == \'general\'">\n    <div class="form-group">\n      <label class="control-label">Latitude Column Name</label>\n      <ui-select name="form-control" required ng-model="visualization.options.latColName">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:visualization.options.classify | remove:visualization.options.lonColName">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Longitude Column Name</label>\n      <ui-select name="form-control" required ng-model="visualization.options.lonColName">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:visualization.options.classify | remove:visualization.options.latColName">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Group By</label>\n      <ui-select name="form-control" required ng-model="visualization.options.classify">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in classify_columns | remove:visualization.options.lonColName | remove:visualization.options.latColName">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n\n  <div ng-show="currentTab == \'groups\'">\n    <table class="table table-condensed col-table">\n      <thead>\n      <th>Name</th>\n      <th>Color</th>\n      </thead>\n      <tbody>\n      <tr ng-repeat="(name, options) in visualization.options.groups">\n        <td>{{name}}</td>\n        <td>\n            <input class="form-control" type="color" ng-model="options.color"/>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <div ng-show="currentTab == \'map\'">\n    <div class="checkbox">\n      <label>\n        <input type="checkbox" ng-model="visualization.options.clusterMarkers">\n        <i class="input-helper"></i> Cluster Markers\n      </label>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Map Height (px)</label>\n      <input class="form-control" type="number" ng-model="visualization.options.height"/>\n    </div>\n    <div class="form-group">\n      <label class="control-label">Map Tiles</label>\n      <select ng-options="tile.url as tile.name for tile in mapTiles" ng-model="visualization.options.mapTileUrl"\n              class="form-control"></select>\n    </div>\n  </div>\n\n</div>\n'},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return{restrict:"E",scope:{queryResult:"=",visualization:"="},template:"",replace:!1,link:function(e,t){e.$watch("queryResult && queryResult.getData()",function(n){if(n&&null!==e.queryResult.getData()){n=o.default.copy(e.queryResult.getData());var r={renderers:u.default.pivotUtilities.renderers,onRefresh:function(t){var n=i({},t);delete n.aggregators,delete n.renderers,delete n.onRefresh,delete n.rendererOptions,delete n.localeStrings,e.visualization&&(e.visualization.options=n)}};e.visualization&&i(r,e.visualization.options),(0,u.default)(t).pivotUI(n,r,!0)}})}}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){e.directive("pivotTableRenderer",a),e.config(["VisualizationProvider",function(e){var t="<div/>",n={};e.registerVisualization({type:"PIVOT",name:"Pivot Table",renderTemplate:'<pivot-table-renderer visualization="visualization" query-result="queryResult"></pivot-table-renderer>',editorTemplate:t,defaultOptions:n})}])};var s=n(22),o=r(s),l=n(157),u=r(l);n(623),n(624)},,1,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.filter("markdown",["$sce","clientConfig",function(e,t){return function(n){if(!n)return"";var r=(0,i.default)(String(n));return t.allowScriptsInUserInput&&(r=e.trustAsHtml(r)),r}}])};var a=n(626),i=r(a)},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.filter("toMilliseconds",function(){return function(e){return 1e3*e}}),e.filter("dateTime",["clientConfig",function(e){return function(t){return t?(0,i.default)(t).format(e.dateTimeFormat):"-"}}])};var a=n(42),i=r(a)},function(e,t,n,r,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){return s({},(0,l.default)(e),(0,c.default)(e))};var o=n(r),l=i(o),u=n(a),c=i(u)}]);
//# sourceMappingURL=app.15512cfcb29455603e73.js.map